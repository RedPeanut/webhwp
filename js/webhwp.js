!function(n){var i={};function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=52)}([function(t,gr,_r){"use strict";!function(t){function i(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){p(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(n);return t=i?(t=o(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!=typeof t&&"function"!=typeof t?s(e):t}}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}_r.d(gr,"a",function(){return f}),_r.d(gr,"b",function(){return Kn}),_r.d(gr,"c",function(){return Yn}),_r.d(gr,"d",function(){return $n}),_r.d(gr,"e",function(){return fr}),_r.d(gr,"f",function(){return pr});var f,g=function t(e,n,i){d(this,t),p(this,"header",void 0),p(this,"info",void 0),p(this,"sections",void 0),this.header=e,this.info=n,this.sections=i},_=function t(){d(this,t),p(this,"page",0),p(this,"footnote",0),p(this,"endnote",0),p(this,"picture",0),p(this,"table",0),p(this,"equation",0)},m=function t(){d(this,t),p(this,"listId",0),p(this,"paragraphId",0),p(this,"charIndex",0)},S=function t(){d(this,t),p(this,"char",0),p(this,"paragraph",0),p(this,"section",0),p(this,"object",0),p(this,"field",0)},E=function(){function t(){d(this,t),p(this,"sectionSize",0),p(this,"charShapes",[]),p(this,"fontFaces",[]),p(this,"binData",[]),p(this,"borderFills",[]),p(this,"paragraphShapes",[]),p(this,"startingIndex",new _),p(this,"caratLocation",new m),p(this,"compatibleDocument",0),p(this,"layoutCompatiblity",new S)}return n(t,[{key:"getCharShpe",value:function(t){return this.charShapes[t]}}]),t}(),w=function t(e,n,i){d(this,t),p(this,"signature",void 0),p(this,"version",void 0),p(this,"properties",void 0),this.signature=e,this.version=n,this.properties=i},b=function(){function r(t,e,n,i){d(this,r),p(this,"major",void 0),p(this,"minor",void 0),p(this,"build",void 0),p(this,"revision",void 0),this.major=t,this.minor=e,this.build=n,this.revision=i}return n(r,[{key:"isCompatible",value:function(t){return this.major===t.major&&this.minor<=t.minor}},{key:"gte",value:function(t){return this.major>t.major||!(this.major<t.major)&&(this.minor>t.minor||!(this.minor<t.minor)&&(this.build>t.build||!(this.build<t.build)&&this.revision>=t.revision))}},{key:"toString",value:function(){return"".concat(this.major,".").concat(this.minor,".").concat(this.build,".").concat(this.revision)}},{key:"toJSON",value:function(){return this.toString()}}]),r}(),T=function t(){d(this,t),p(this,"width",0),p(this,"height",0),p(this,"paddingLeft",0),p(this,"paddingRight",0),p(this,"paddingTop",0),p(this,"paddingBottom",0),p(this,"headerPadding",0),p(this,"footerPadding",0),p(this,"content",[]),p(this,"orientation",0),p(this,"bookBindingMethod",0)};(an=f=f||{})[an.Char=0]="Char",an[an.Inline=1]="Inline",an[an.Extened=2]="Extened";function A(t,e){d(this,A),p(this,"type",void 0),p(this,"value",void 0),this.type=t,this.value=e}var O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function C(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}function I(n){if(n.__esModule)return n;var i=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(n).forEach(function(t){var e=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(i,t,e.get?e:{enumerable:!0,get:function(){return n[t]}})}),i}var D=C(function(t,e){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;e.assign=function(t){for(var e,n,i=Array.prototype.slice.call(arguments,1);i.length;){var r=i.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var o in r)e=r,n=o,Object.prototype.hasOwnProperty.call(e,n)&&(t[o]=r[o])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),r);else for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){for(var e,n,i,r=0,o=0,a=t.length;o<a;o++)r+=t[o].length;for(i=new Uint8Array(r),o=e=0,a=t.length;o<a;o++)n=t[o],i.set(n,e),e+=n.length;return i}},r={arraySet:function(t,e,n,i,r){for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,r))},e.setTyped(n)}),R=0,N=1;function P(t){for(var e=t.length;0<=--e;)t[e]=0}var L=0,M=29,F=256,x=F+1+M,k=30,B=19,H=2*x+1,G=15,U=16,j=7,V=256,W=16,z=17,$=18,Y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(x+2));P(X);var J=new Array(2*k);P(J);var Q=new Array(512);P(Q);var tt=new Array(256);P(tt);var et=new Array(M);P(et);var nt,it,rt,ot=new Array(k);function at(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function st(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function ht(t){return t<256?Q[t]:Q[256+(t>>>7)]}function lt(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function ut(t,e,n){t.bi_valid>U-n?(t.bi_buf|=e<<t.bi_valid&65535,lt(t,t.bi_buf),t.bi_buf=e>>U-t.bi_valid,t.bi_valid+=n-U):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function ct(t,e,n){ut(t,n[2*e],n[2*e+1])}function ft(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function dt(t,e,n){for(var i,r=new Array(G+1),o=0,a=1;a<=G;a++)r[a]=o=o+n[a-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=ft(r[s]++,s))}}function pt(t){for(var e=0;e<x;e++)t.dyn_ltree[2*e]=0;for(e=0;e<k;e++)t.dyn_dtree[2*e]=0;for(e=0;e<B;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*V]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function gt(t){8<t.bi_valid?lt(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function _t(t,e,n,i){var r=2*e,o=2*n;return t[r]<t[o]||t[r]===t[o]&&i[e]<=i[n]}function yt(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&_t(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!_t(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function vt(t,e,n){var i,r,o,a,s=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],r=t.pending_buf[t.l_buf+s],s++,0==i?ct(t,r,e):(ct(t,(o=tt[r])+F+1,e),0!==(a=Y[o])&&ut(t,r-=et[o],a),ct(t,o=ht(--i),n),0!==(a=K[o])&&ut(t,i-=ot[o],a)),s<t.last_lit;);ct(t,V,e)}function mt(t,e){var n,i,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,h=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=H,n=0;n<h;n++)0!==o[2*n]?(t.heap[++t.heap_len]=l=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=l,n=t.heap_len>>1;1<=n;n--)yt(t,o,n);for(r=h;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],yt(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,o[2*r]=o[2*n]+o[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,o[2*n+1]=o[2*i+1]=r,t.heap[1]=r++,yt(t,o,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){for(var n,i,r,o,a,s=e.dyn_tree,h=e.max_code,l=e.stat_desc.static_tree,u=e.stat_desc.has_stree,c=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,d=e.stat_desc.max_length,p=0,g=0;g<=G;g++)t.bl_count[g]=0;for(s[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<H;n++)d<(g=s[2*s[2*(i=t.heap[n])+1]+1]+1)&&(g=d,p++),s[2*i+1]=g,h<i||(t.bl_count[g]++,o=0,f<=i&&(o=c[i-f]),a=s[2*i],t.opt_len+=a*(g+o),u&&(t.static_len+=a*(l[2*i+1]+o)));if(0!==p){do{for(g=d-1;0===t.bl_count[g];)g--}while(t.bl_count[g]--,t.bl_count[g+1]+=2,t.bl_count[d]--,0<(p-=2));for(g=d;0!==g;g--)for(i=t.bl_count[g];0!==i;)h<(r=t.heap[--n])||(s[2*r+1]!==g&&(t.opt_len+=(g-s[2*r+1])*s[2*r],s[2*r+1]=g),i--)}}(t,e),dt(o,l,t.bl_count)}function St(t,e,n){var i,r,o=-1,a=e[1],s=0,h=7,l=4;for(0===a&&(h=138,l=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=e[2*(i+1)+1],++s<h&&r===a||(s<l?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[2*W]++):s<=10?t.bl_tree[2*z]++:t.bl_tree[2*$]++,o=r,l=(s=0)===a?(h=138,3):r===a?(h=6,3):(h=7,4))}function Et(t,e,n){var i,r,o=-1,a=e[1],s=0,h=7,l=4;for(0===a&&(h=138,l=3),i=0;i<=n;i++)if(r=a,a=e[2*(i+1)+1],!(++s<h&&r===a)){if(s<l)for(;ct(t,r,t.bl_tree),0!=--s;);else 0!==r?(r!==o&&(ct(t,r,t.bl_tree),s--),ct(t,W,t.bl_tree),ut(t,s-3,2)):s<=10?(ct(t,z,t.bl_tree),ut(t,s-3,3)):(ct(t,$,t.bl_tree),ut(t,s-11,7));o=r,l=(s=0)===a?(h=138,3):r===a?(h=6,3):(h=7,4)}}P(ot);var wt=!1;function bt(t,e,n,i){ut(t,(L<<1)+(i?1:0),3),i=e,e=n,n=!0,gt(t=t),n&&(lt(t,e),lt(t,~e)),D.arraySet(t.pending_buf,t.window,i,e,t.pending),t.pending+=e}var Tt={_tr_init:function(t){wt||(function(){for(var t,e,n,i=new Array(G+1),r=0,o=0;o<M-1;o++)for(et[o]=r,t=0;t<1<<Y[o];t++)tt[r++]=o;for(tt[r-1]=o,o=n=0;o<16;o++)for(ot[o]=n,t=0;t<1<<K[o];t++)Q[n++]=o;for(n>>=7;o<k;o++)for(ot[o]=n<<7,t=0;t<1<<K[o]-7;t++)Q[256+n++]=o;for(e=0;e<=G;e++)i[e]=0;for(t=0;t<=143;)X[2*t+1]=8,t++,i[8]++;for(;t<=255;)X[2*t+1]=9,t++,i[9]++;for(;t<=279;)X[2*t+1]=7,t++,i[7]++;for(;t<=287;)X[2*t+1]=8,t++,i[8]++;for(dt(X,x+1,i),t=0;t<k;t++)J[2*t+1]=5,J[2*t]=ft(t,5);nt=new at(X,Y,F+1,x,G),it=new at(J,K,0,k,G),rt=new at(new Array(0),q,0,B,j)}(),wt=!0),t.l_desc=new st(t.dyn_ltree,nt),t.d_desc=new st(t.dyn_dtree,it),t.bl_desc=new st(t.bl_tree,rt),t.bi_buf=0,t.bi_valid=0,pt(t)},_tr_stored_block:bt,_tr_flush_block:function(t,e,n,i){var r,o,a=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){for(var e=4093624447,n=0;n<=31;n++,e>>>=1)if(1&e&&0!==t.dyn_ltree[2*n])return R;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return N;for(n=32;n<F;n++)if(0!==t.dyn_ltree[2*n])return N;return R}(t)),mt(t,t.l_desc),mt(t,t.d_desc),a=function(t){var e;for(St(t,t.dyn_ltree,t.l_desc.max_code),St(t,t.dyn_dtree,t.d_desc.max_code),mt(t,t.bl_desc),e=B-1;3<=e&&0===t.bl_tree[2*Z[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!==e?bt(t,e,n,i):4===t.strategy||o===r?(ut(t,2+(i?1:0),3),vt(t,X,J)):(ut(t,4+(i?1:0),3),function(t,e,n,i){var r;for(ut(t,e-257,5),ut(t,n-1,5),ut(t,i-4,4),r=0;r<i;r++)ut(t,t.bl_tree[2*Z[r]+1],3);Et(t,t.dyn_ltree,e-1),Et(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),vt(t,t.dyn_ltree,t.dyn_dtree)),pt(t),i&&gt(t)},_tr_tally:function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(tt[n]+F+1)]++,t.dyn_dtree[2*ht(e)]++),t.last_lit===t.lit_bufsize-1},_tr_align:function(t){ut(t,2,3),ct(t,V,X),16===(t=t).bi_valid?(lt(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}};var At=function(t,e,n,i){for(var r=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;o=o+(r=r+e[i++]|0)|0,--a;);r%=65521,o%=65521}return r|o<<16|0};var Ot=function(){for(var t=[],e=0;e<256;e++){for(var n=e,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}();var Ct=function(t,e,n,i){var r=Ot,o=i+n;t^=-1;for(var a=i;a<o;a++)t=t>>>8^r[255&(t^e[a])];return-1^t},It={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Rt=0,Nt=4,Pt=0,Lt=-2,Mt=-1,Dt=4,Ft=2,xt=8,kt=9,Bt=286,Ht=30,Gt=19,Ut=2*Bt+1,jt=15,Vt=3,Wt=258,zt=Wt+Vt+1,$t=42,Yt=113,Kt=1,qt=2,Zt=3,Xt=4;function Jt(t,e){return t.msg=It[e],e}function Qt(t){return(t<<1)-(4<t?9:0)}function te(t){for(var e=t.length;0<=--e;)t[e]=0}function ee(t){var e=t.state,n=e.pending;0!==(n=n>t.avail_out?t.avail_out:n)&&(D.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function ne(t,e){Tt._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ee(t.strm)}function ie(t,e){t.pending_buf[t.pending++]=e}function re(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function oe(t,e){var n,i,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,h=t.strstart>t.w_size-zt?t.strstart-(t.w_size-zt):0,l=t.window,u=t.w_mask,c=t.prev,f=t.strstart+Wt,d=l[o+a-1],p=l[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(l[(n=e)+a]===p&&l[n+a-1]===d&&l[n]===l[o]&&l[++n]===l[o+1]){for(o+=2,n++;l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<f;);if(i=Wt-(f-o),o=f-Wt,a<i){if(t.match_start=e,s<=(a=i))break;d=l[o+a-1],p=l[o+a]}}}while((e=c[e&u])>h&&0!=--r);return a<=t.lookahead?a:t.lookahead}function ae(t){var e,n,i,r,o,a,s,h,l,u=t.w_size;do{if(l=t.window_size-t.lookahead-t.strstart,t.strstart>=u+(u-zt)){for(D.arraySet(t.window,t.window,u,u,0),t.match_start-=u,t.strstart-=u,t.block_start-=u,e=n=t.hash_size;i=t.head[--e],t.head[e]=u<=i?i-u:0,--n;);for(e=n=u;i=t.prev[--e],t.prev[e]=u<=i?i-u:0,--n;);l+=u}if(0===t.strm.avail_in)break;if(o=t.strm,a=t.window,s=t.strstart+t.lookahead,h=l,l=void 0,l=o.avail_in,n=0===(l=h<l?h:l)?0:(o.avail_in-=l,D.arraySet(a,o.input,o.next_in,l,s),1===o.state.wrap?o.adler=At(o.adler,a,l,s):2===o.state.wrap&&(o.adler=Ct(o.adler,a,l,s)),o.next_in+=l,o.total_in+=l,l),t.lookahead+=n,t.lookahead+t.insert>=Vt)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+Vt-1])&t.hash_mask,t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<Vt)););}while(t.lookahead<zt&&0!==t.strm.avail_in)}function se(t,e){for(var n,i;;){if(t.lookahead<zt){if(ae(t),t.lookahead<zt&&e===Rt)return Kt;if(0===t.lookahead)break}if(n=0,t.lookahead>=Vt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-zt&&(t.match_length=oe(t,n)),t.match_length>=Vt)if(i=Tt._tr_tally(t,t.strstart-t.match_start,t.match_length-Vt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Vt){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=Tt._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ne(t,!1),0===t.strm.avail_out))return Kt}return t.insert=t.strstart<Vt-1?t.strstart:Vt-1,e===Nt?(ne(t,!0),0===t.strm.avail_out?Zt:Xt):t.last_lit&&(ne(t,!1),0===t.strm.avail_out)?Kt:qt}function he(t,e){for(var n,i,r;;){if(t.lookahead<zt){if(ae(t),t.lookahead<zt&&e===Rt)return Kt;if(0===t.lookahead)break}if(n=0,t.lookahead>=Vt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Vt-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-zt&&(t.match_length=oe(t,n),t.match_length<=5&&(1===t.strategy||t.match_length===Vt&&4096<t.strstart-t.match_start)&&(t.match_length=Vt-1)),t.prev_length>=Vt&&t.match_length<=t.prev_length){for(r=t.strstart+t.lookahead-Vt,i=Tt._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-Vt),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Vt-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=Vt-1,t.strstart++,i&&(ne(t,!1),0===t.strm.avail_out))return Kt}else if(t.match_available){if((i=Tt._tr_tally(t,0,t.window[t.strstart-1]))&&ne(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Kt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Tt._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Vt-1?t.strstart:Vt-1,e===Nt?(ne(t,!0),0===t.strm.avail_out?Zt:Xt):t.last_lit&&(ne(t,!1),0===t.strm.avail_out)?Kt:qt}function le(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}function ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=xt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new D.Buf16(2*Ut),this.dyn_dtree=new D.Buf16(2*(2*Ht+1)),this.bl_tree=new D.Buf16(2*(2*Gt+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new D.Buf16(jt+1),this.heap=new D.Buf16(2*Bt+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new D.Buf16(2*Bt+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=Ft,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?$t:Yt,t.adler=2===e.wrap?0:1,e.last_flush=Rt,Tt._tr_init(e),Pt):Jt(t,Lt)}function fe(t){var e=ce(t);return e===Pt&&((t=t.state).window_size=2*t.w_size,te(t.head),t.max_lazy_match=pe[t.level].max_lazy,t.good_match=pe[t.level].good_length,t.nice_match=pe[t.level].nice_length,t.max_chain_length=pe[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Vt-1,t.match_available=0,t.ins_h=0),e}function de(t,e,n,i,r,o){if(!t)return Lt;var a=1;if(e===Mt&&(e=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),r<1||kt<r||n!==xt||i<8||15<i||e<0||9<e||o<0||Dt<o)return Jt(t,Lt);8===i&&(i=9);var s=new ue;return(t.state=s).strm=t,s.wrap=a,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Vt-1)/Vt),s.window=new D.Buf8(2*s.w_size),s.head=new D.Buf16(s.hash_size),s.prev=new D.Buf16(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new D.Buf8(s.pending_buf_size),s.d_buf=+s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=e,s.strategy=o,s.method=n,fe(t)}var pe=[new le(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ae(t),0===t.lookahead&&e===Rt)return Kt;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,ne(t,!1),0===t.strm.avail_out))return Kt;if(t.strstart-t.block_start>=t.w_size-zt&&(ne(t,!1),0===t.strm.avail_out))return Kt}return t.insert=0,e===Nt?(ne(t,!0),0===t.strm.avail_out?Zt:Xt):(t.strstart>t.block_start&&(ne(t,!1),t.strm.avail_out),Kt)}),new le(4,4,8,4,se),new le(4,5,16,8,se),new le(4,6,32,32,se),new le(4,4,16,16,he),new le(8,16,32,32,he),new le(8,16,128,128,he),new le(8,32,128,256,he),new le(32,128,258,1024,he),new le(32,258,258,4096,he)],ge={deflateInit:function(t,e){return de(t,e,xt,15,8,0)},deflateInit2:de,deflateReset:fe,deflateResetKeep:ce,deflateSetHeader:function(t,e){return!t||!t.state||2!==t.state.wrap?Lt:(t.state.gzhead=e,Pt)},deflate:function(t,e){var n,i,r,o;if(!t||!t.state||5<e||e<0)return t?Jt(t,Lt):Lt;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||666===n.status&&e!==Nt)return Jt(t,0===t.avail_out?-5:Lt);if(n.strm=t,a=n.last_flush,n.last_flush=e,n.status===$t&&(2===n.wrap?(t.adler=0,ie(n,31),ie(n,139),ie(n,8),n.gzhead?(ie(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ie(n,255&n.gzhead.time),ie(n,n.gzhead.time>>8&255),ie(n,n.gzhead.time>>16&255),ie(n,n.gzhead.time>>24&255),ie(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),ie(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(ie(n,255&n.gzhead.extra.length),ie(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Ct(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(ie(n,0),ie(n,0),ie(n,0),ie(n,0),ie(n,0),ie(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),ie(n,3),n.status=Yt)):(o=xt+(n.w_bits-8<<4)<<8,o|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(o|=32),o+=31-o%31,n.status=Yt,re(n,o),0!==n.strstart&&(re(n,t.adler>>>16),re(n,65535&t.adler)),t.adler=1)),69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ct(t.adler,n.pending_buf,n.pending-i,i)),ee(t),i=n.pending,n.pending!==n.pending_buf_size));)ie(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(t.adler=Ct(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ct(t.adler,n.pending_buf,n.pending-i,i)),ee(t),i=n.pending,n.pending===n.pending_buf_size)){r=1;break}}while(r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,ie(n,r),0!==r);n.gzhead.hcrc&&n.pending>i&&(t.adler=Ct(t.adler,n.pending_buf,n.pending-i,i)),0===r&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ct(t.adler,n.pending_buf,n.pending-i,i)),ee(t),i=n.pending,n.pending===n.pending_buf_size)){r=1;break}}while(r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,ie(n,r),0!==r);n.gzhead.hcrc&&n.pending>i&&(t.adler=Ct(t.adler,n.pending_buf,n.pending-i,i)),0===r&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ee(t),n.pending+2<=n.pending_buf_size&&(ie(n,255&t.adler),ie(n,t.adler>>8&255),t.adler=0,n.status=Yt)):n.status=Yt),0!==n.pending){if(ee(t),0===t.avail_out)return n.last_flush=-1,Pt}else if(0===t.avail_in&&Qt(e)<=Qt(a)&&e!==Nt)return Jt(t,-5);if(666===n.status&&0!==t.avail_in)return Jt(t,-5);if(0!==t.avail_in||0!==n.lookahead||e!==Rt&&666!==n.status){var a=2===n.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(ae(t),0===t.lookahead)){if(e===Rt)return Kt;break}if(t.match_length=0,n=Tt._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(ne(t,!1),0===t.strm.avail_out))return Kt}return t.insert=0,e===Nt?(ne(t,!0),0===t.strm.avail_out?Zt:Xt):t.last_lit&&(ne(t,!1),0===t.strm.avail_out)?Kt:qt}(n,e):3===n.strategy?function(t,e){for(var n,i,r,o,a=t.window;;){if(t.lookahead<=Wt){if(ae(t),t.lookahead<=Wt&&e===Rt)return Kt;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=Vt&&0<t.strstart&&(i=a[r=t.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){for(o=t.strstart+Wt;i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<o;);t.match_length=Wt-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Vt?(n=Tt._tr_tally(t,1,t.match_length-Vt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Tt._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(ne(t,!1),0===t.strm.avail_out))return Kt}return t.insert=0,e===Nt?(ne(t,!0),0===t.strm.avail_out?Zt:Xt):t.last_lit&&(ne(t,!1),0===t.strm.avail_out)?Kt:qt}(n,e):pe[n.level].func(n,e);if(a!==Zt&&a!==Xt||(n.status=666),a===Kt||a===Zt)return 0===t.avail_out&&(n.last_flush=-1),Pt;if(a===qt&&(1===e?Tt._tr_align(n):5!==e&&(Tt._tr_stored_block(n,0,0,!1),3===e&&(te(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ee(t),0===t.avail_out))return n.last_flush=-1,Pt}return e!==Nt?Pt:n.wrap<=0?1:(2===n.wrap?(ie(n,255&t.adler),ie(n,t.adler>>8&255),ie(n,t.adler>>16&255),ie(n,t.adler>>24&255),ie(n,255&t.total_in),ie(n,t.total_in>>8&255),ie(n,t.total_in>>16&255),ie(n,t.total_in>>24&255)):(re(n,t.adler>>>16),re(n,65535&t.adler)),ee(t),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?Pt:1)},deflateEnd:function(t){var e;return t&&t.state?(e=t.state.status)!==$t&&69!==e&&73!==e&&91!==e&&103!==e&&e!==Yt&&666!==e?Jt(t,Lt):(t.state=null,e===Yt?Jt(t,-3):Pt):Lt},deflateSetDictionary:function(t,e){var n,i,r,o,a,s,h,l=e.length;if(!t||!t.state)return Lt;if(2===(o=(n=t.state).wrap)||1===o&&n.status!==$t||n.lookahead)return Lt;for(1===o&&(t.adler=At(t.adler,e,l,0)),n.wrap=0,l>=n.w_size&&(0===o&&(te(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new D.Buf8(n.w_size),D.arraySet(h,e,l-n.w_size,n.w_size,0),e=h,l=n.w_size),a=t.avail_in,s=t.next_in,h=t.input,t.avail_in=l,t.next_in=0,t.input=e,ae(n);n.lookahead>=Vt;){for(i=n.strstart,r=n.lookahead-(Vt-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+Vt-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,--r;);n.strstart=i,n.lookahead=Vt-1,ae(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Vt-1,n.match_available=0,t.next_in=s,t.input=h,t.avail_in=a,n.wrap=o,Pt},deflateInfo:"pako deflate (from Nodeca project)"},_e=!0,ye=!0;try{String.fromCharCode.apply(null,[0])}catch(t){_e=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){ye=!1}for(var ve=new D.Buf8(256),me=0;me<256;me++)ve[me]=252<=me?6:248<=me?5:240<=me?4:224<=me?3:192<=me?2:1;ve[254]=ve[254]=1;function Se(t,e){if(e<65534&&(t.subarray&&ye||!t.subarray&&_e))return String.fromCharCode.apply(null,D.shrinkBuf(t,e));for(var n="",i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n}var Ee={string2buf:function(t){for(var e,n,i,r,o=t.length,a=0,s=0;s<o;s++)55296==(64512&(n=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=t.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new D.Buf8(a),s=r=0;r<a;s++)55296==(64512&(n=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=t.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?e[r++]=n:(n<2048?e[r++]=192|n>>>6:(n<65536?e[r++]=224|n>>>12:(e[r++]=240|n>>>18,e[r++]=128|n>>>12&63),e[r++]=128|n>>>6&63),e[r++]=128|63&n);return e},buf2binstring:function(t){return Se(t,t.length)},binstring2buf:function(t){for(var e=new D.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},buf2string:function(t,e){for(var n,i,r=e||t.length,o=new Array(2*r),a=0,s=0;s<r;)if((n=t[s++])<128)o[a++]=n;else if(4<(i=ve[n]))o[a++]=65533,s+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&s<r;)n=n<<6|63&t[s++],i--;1<i?o[a++]=65533:n<65536?o[a++]=n:(n-=65536,o[a++]=55296|n>>10&1023,o[a++]=56320|1023&n)}return Se(o,a)},utf8border:function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0)&&0!==n&&n+ve[t[n]]>e?n:e}};var we=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},be=Object.prototype.toString,Te=0,Ae=-1,Oe=0,Ce=8;function Ie(t){if(!(this instanceof Ie))return new Ie(t);this.options=D.assign({level:Ae,method:Ce,chunkSize:16384,windowBits:15,memLevel:8,strategy:Oe,to:""},t||{});var e=this.options;if(e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new we,this.strm.avail_out=0,(t=ge.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy))!==Te)throw new Error(It[t]);if(e.header&&ge.deflateSetHeader(this.strm,e.header),e.dictionary){e="string"==typeof e.dictionary?Ee.string2buf(e.dictionary):"[object ArrayBuffer]"===be.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary;if((t=ge.deflateSetDictionary(this.strm,e))!==Te)throw new Error(It[t]);this._dict_set=!0}}function Re(t,e){e=new Ie(e);if(e.push(t,!0),e.err)throw e.msg||It[e.err];return e.result}Ie.prototype.push=function(t,e){var n,i,r=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:!0===e?4:0,"string"==typeof t?r.input=Ee.string2buf(t):"[object ArrayBuffer]"===be.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new D.Buf8(o),r.next_out=0,r.avail_out=o),1!==(n=ge.deflate(r,i))&&n!==Te)return this.onEnd(n),!(this.ended=!0)}while(0!==r.avail_out&&(0!==r.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(Ee.buf2binstring(D.shrinkBuf(r.output,r.next_out))):this.onData(D.shrinkBuf(r.output,r.next_out))),(0<r.avail_in||0===r.avail_out)&&1!==n);return 4===i?(n=ge.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Te):2!==i||(this.onEnd(Te),!(r.avail_out=0))},Ie.prototype.onData=function(t){this.chunks.push(t)},Ie.prototype.onEnd=function(t){t===Te&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=D.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ne={Deflate:Ie,deflate:Re,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Re(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Re(t,e)}},Pe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Le=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],De=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Fe=function(t,e,n,i,r,o,a,s){for(var h,l,u,c,f,d,p,g,_,y=s.bits,v=0,m=0,S=0,E=0,w=0,b=0,T=0,A=0,O=0,C=0,I=null,R=0,N=new D.Buf16(16),P=new D.Buf16(16),L=null,M=0,v=0;v<=15;v++)N[v]=0;for(m=0;m<i;m++)N[e[n+m]]++;for(w=y,E=15;1<=E&&0===N[E];E--);if(E<w&&(w=E),0===E)return r[o++]=20971520,r[o++]=20971520,s.bits=1,0;for(S=1;S<E&&0===N[S];S++);for(w<S&&(w=S),v=A=1;v<=15;v++)if(A<<=1,(A-=N[v])<0)return-1;if(0<A&&(0===t||1!==E))return-1;for(P[1]=0,v=1;v<15;v++)P[v+1]=P[v]+N[v];for(m=0;m<i;m++)0!==e[n+m]&&(a[P[e[n+m]]++]=m);if(d=0===t?(I=L=a,19):1===t?(I=Pe,R-=257,L=Le,M-=257,256):(I=Me,L=De,-1),v=S,f=o,T=m=C=0,u=-1,c=(O=1<<(b=w))-1,1===t&&852<O||2===t&&592<O)return 1;for(;;){for(_=a[m]<d?(g=0,a[m]):a[m]>d?(g=L[M+a[m]],I[R+a[m]]):(g=96,0),h=1<<(p=v-T),S=l=1<<b;r[f+(C>>T)+(l-=h)]=p<<24|g<<16|_|0,0!==l;);for(h=1<<v-1;C&h;)h>>=1;if(0!==h?(C&=h-1,C+=h):C=0,m++,0==--N[v]){if(v===E)break;v=e[n+a[m]]}if(w<v&&(C&c)!==u){for(f+=S,A=1<<(b=v-(T=0===T?w:T));b+T<E&&!((A-=N[b+T])<=0);)b++,A<<=1;if(O+=1<<b,1===t&&852<O||2===t&&592<O)return 1;r[u=C&c]=w<<24|b<<16|f-o|0}}return 0!==C&&(r[f+C]=v-T<<24|64<<16|0),s.bits=w,0},xe=1,ke=2,Be=0,He=-2,Ge=1,Ue=852,je=592;function Ve(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function We(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new D.Buf16(320),this.work=new D.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ze(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Ge,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new D.Buf32(Ue),e.distcode=e.distdyn=new D.Buf32(je),e.sane=1,e.back=-1,Be):He}function $e(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,ze(t)):He}function Ye(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?He:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,$e(t))):He}function Ke(t,e){var n;return t?(n=new We,(t.state=n).window=null,(e=Ye(t,e))!==Be&&(t.state=null),e):He}var qe,Ze,Xe=!0;function Je(t,e,n,i){var r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new D.Buf8(r.wsize)),i>=r.wsize?(D.arraySet(r.window,e,n-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(i<(t=r.wsize-r.wnext)&&(t=i),D.arraySet(r.window,e,n-i,t,r.wnext),(i-=t)?(D.arraySet(r.window,e,n-i,i,0),r.wnext=i,r.whave=r.wsize):(r.wnext+=t,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=t))),0}var Qe={inflateReset:$e,inflateReset2:Ye,inflateResetKeep:ze,inflateInit:function(t){return Ke(t,15)},inflateInit2:Ke,inflate:function(t,e){var n,i,r,o,a,s,h,l,u,c,f,d,p,g,_,y,v,m,S,E,w,b,T,A,O=0,C=new D.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return He;12===(n=t.state).mode&&(n.mode=13),a=t.next_out,r=t.output,h=t.avail_out,o=t.next_in,i=t.input,s=t.avail_in,l=n.hold,u=n.bits,c=s,f=h,b=Be;t:for(;;)switch(n.mode){case Ge:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(2&n.wrap&&35615===l){C[n.check=0]=255&l,C[1]=l>>>8&255,n.check=Ct(n.check,C,2,0),u=l=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&l)){t.msg="unknown compression method",n.mode=30;break}if(u-=4,w=8+(15&(l>>>=4)),0===n.wbits)n.wbits=w;else if(w>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<w,t.adler=n.check=1,n.mode=512&l?10:12,u=l=0;break;case 2:for(;u<16;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(n.flags=l,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&(C[0]=255&l,C[1]=l>>>8&255,n.check=Ct(n.check,C,2,0)),u=l=0,n.mode=3;case 3:for(;u<32;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}n.head&&(n.head.time=l),512&n.flags&&(C[0]=255&l,C[1]=l>>>8&255,C[2]=l>>>16&255,C[3]=l>>>24&255,n.check=Ct(n.check,C,4,0)),u=l=0,n.mode=4;case 4:for(;u<16;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&(C[0]=255&l,C[1]=l>>>8&255,n.check=Ct(n.check,C,2,0)),u=l=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&(C[0]=255&l,C[1]=l>>>8&255,n.check=Ct(n.check,C,2,0)),u=l=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((d=s<(d=n.length)?s:d)&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),D.arraySet(n.head.extra,i,o,d,w)),512&n.flags&&(n.check=Ct(n.check,i,d,o)),s-=d,o+=d,n.length-=d),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break t;for(d=0;w=i[o+d++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w)),w&&d<s;);if(512&n.flags&&(n.check=Ct(n.check,i,d,o)),s-=d,o+=d,w)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break t;for(d=0;w=i[o+d++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w)),w&&d<s;);if(512&n.flags&&(n.check=Ct(n.check,i,d,o)),s-=d,o+=d,w)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(l!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}u=l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;u<32;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}t.adler=n.check=Ve(l),u=l=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=a,t.avail_out=h,t.next_in=o,t.avail_in=s,n.hold=l,n.bits=u,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){l>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}switch(n.last=1&l,--u,3&(l>>>=1)){case 0:n.mode=14;break;case 1:if(!function(t){if(Xe){var e;for(qe=new D.Buf32(512),Ze=new D.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Fe(xe,t.lens,0,288,qe,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Fe(ke,t.lens,0,32,Ze,0,t.work,{bits:5}),Xe=!1}t.lencode=qe,t.lenbits=9,t.distcode=Ze,t.distbits=5}(n),n.mode=20,6!==e)break;l>>>=2,u-=2;break t;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}l>>>=2,u-=2;break;case 14:for(l>>>=7&u,u-=7&u;u<32;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&l,u=l=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(d=n.length){if(0===(d=h<(d=s<d?s:d)?h:d))break t;D.arraySet(r,i,o,d,a),s-=d,o+=d,h-=d,a+=d,n.length-=d;break}n.mode=12;break;case 17:for(;u<14;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(n.nlen=257+(31&l),l>>>=5,u-=5,n.ndist=1+(31&l),l>>>=5,u-=5,n.ncode=4+(15&l),l>>>=4,u-=4,286<n.nlen||30<n.ndist){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}n.lens[I[n.have++]]=7&l,l>>>=3,u-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},b=Fe(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,b){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;y=(O=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,v=65535&O,!((_=O>>>24)<=u);){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(v<16)l>>>=_,u-=_,n.lens[n.have++]=v;else{if(16===v){for(A=_+2;u<A;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(l>>>=_,u-=_,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}w=n.lens[n.have-1],d=3+(3&l),l>>>=2,u-=2}else if(17===v){for(A=_+3;u<A;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}u-=_,w=0,d=3+(7&(l>>>=_)),l>>>=3,u-=3}else{for(A=_+7;u<A;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}u-=_,w=0,d=11+(127&(l>>>=_)),l>>>=7,u-=7}if(n.have+d>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;d--;)n.lens[n.have++]=w}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},b=Fe(xe,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,b){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},b=Fe(ke,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,b){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(6<=s&&258<=h){t.next_out=a,t.avail_out=h,t.next_in=o,t.avail_in=s,n.hold=l,n.bits=u,function(t,e){var n,i,r,o,a,s,h=t.state,l=t.next_in,u=t.input,c=l+(t.avail_in-5),f=t.next_out,d=t.output,p=f-(e-t.avail_out),g=f+(t.avail_out-257),_=h.dmax,y=h.wsize,v=h.whave,m=h.wnext,S=h.window,E=h.hold,w=h.bits,b=h.lencode,T=h.distcode,A=(1<<h.lenbits)-1,O=(1<<h.distbits)-1;e:do{w<15&&(E+=u[l++]<<w,w+=8,E+=u[l++]<<w,w+=8),n=b[E&A];n:for(;;){if(E>>>=i=n>>>24,w-=i,0===(i=n>>>16&255))d[f++]=65535&n;else{if(!(16&i)){if(0==(64&i)){n=b[(65535&n)+(E&(1<<i)-1)];continue n}if(32&i){h.mode=12;break e}t.msg="invalid literal/length code",h.mode=30;break e}r=65535&n,(i&=15)&&(w<i&&(E+=u[l++]<<w,w+=8),r+=E&(1<<i)-1,E>>>=i,w-=i),w<15&&(E+=u[l++]<<w,w+=8,E+=u[l++]<<w,w+=8),n=T[E&O];i:for(;;){if(E>>>=i=n>>>24,w-=i,!(16&(i=n>>>16&255))){if(0==(64&i)){n=T[(65535&n)+(E&(1<<i)-1)];continue i}t.msg="invalid distance code",h.mode=30;break e}if(o=65535&n,w<(i&=15)&&(E+=u[l++]<<w,(w+=8)<i&&(E+=u[l++]<<w,w+=8)),_<(o+=E&(1<<i)-1)){t.msg="invalid distance too far back",h.mode=30;break e}if(E>>>=i,w-=i,(i=f-p)<o){if(v<(i=o-i)&&h.sane){t.msg="invalid distance too far back",h.mode=30;break e}if(s=S,(a=0)===m){if(a+=y-i,i<r){for(r-=i;d[f++]=S[a++],--i;);a=f-o,s=d}}else if(m<i){if(a+=y+m-i,(i-=m)<r){for(r-=i;d[f++]=S[a++],--i;);if(a=0,m<r){for(r-=i=m;d[f++]=S[a++],--i;);a=f-o,s=d}}}else if(a+=m-i,i<r){for(r-=i;d[f++]=S[a++],--i;);a=f-o,s=d}for(;2<r;)d[f++]=s[a++],d[f++]=s[a++],d[f++]=s[a++],r-=3;r&&(d[f++]=s[a++],1<r&&(d[f++]=s[a++]))}else{for(a=f-o;d[f++]=d[a++],d[f++]=d[a++],d[f++]=d[a++],2<(r-=3););r&&(d[f++]=d[a++],1<r&&(d[f++]=d[a++]))}break}}break}}while(l<c&&f<g);E&=(1<<(w-=(r=w>>3)<<3))-1,t.next_in=l-=r,t.next_out=f,t.avail_in=l<c?c-l+5:5-(l-c),t.avail_out=f<g?g-f+257:257-(f-g),h.hold=E,h.bits=w}(t,f),a=t.next_out,r=t.output,h=t.avail_out,o=t.next_in,i=t.input,s=t.avail_in,l=n.hold,u=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;y=(O=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,v=65535&O,!((_=O>>>24)<=u);){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(y&&0==(240&y)){for(m=_,S=y,E=v;y=(O=n.lencode[E+((l&(1<<m+S)-1)>>m)])>>>16&255,v=65535&O,!(m+(_=O>>>24)<=u);){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}l>>>=m,u-=m,n.back+=m}if(l>>>=_,u-=_,n.back+=_,n.length=v,0===y){n.mode=26;break}if(32&y){n.back=-1,n.mode=12;break}if(64&y){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&y,n.mode=22;case 22:if(n.extra){for(A=n.extra;u<A;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;y=(O=n.distcode[l&(1<<n.distbits)-1])>>>16&255,v=65535&O,!((_=O>>>24)<=u);){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(0==(240&y)){for(m=_,S=y,E=v;y=(O=n.distcode[E+((l&(1<<m+S)-1)>>m)])>>>16&255,v=65535&O,!(m+(_=O>>>24)<=u);){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}l>>>=m,u-=m,n.back+=m}if(l>>>=_,u-=_,n.back+=_,64&y){t.msg="invalid distance code",n.mode=30;break}n.offset=v,n.extra=15&y,n.mode=24;case 24:if(n.extra){for(A=n.extra;u<A;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===h)break t;if(n.offset>(d=f-h)){if((d=n.offset-d)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}p=d>n.wnext?(d-=n.wnext,n.wsize-d):n.wnext-d,d>n.length&&(d=n.length),g=n.window}else g=r,p=a-n.offset,d=n.length;for(h-=d=h<d?h:d,n.length-=d;r[a++]=g[p++],--d;);0===n.length&&(n.mode=21);break;case 26:if(0===h)break t;r[a++]=n.length,h--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===s)break t;s--,l|=i[o++]<<u,u+=8}if(f-=h,t.total_out+=f,n.total+=f,f&&(t.adler=n.check=(n.flags?Ct:At)(n.check,r,f,a-f)),f=h,(n.flags?l:Ve(l))!==n.check){t.msg="incorrect data check",n.mode=30;break}u=l=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break t;s--,l+=i[o++]<<u,u+=8}if(l!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}u=l=0}n.mode=29;case 29:b=1;break t;case 30:b=-3;break t;case 31:return-4;default:return He}return t.next_out=a,t.avail_out=h,t.next_in=o,t.avail_in=s,n.hold=l,n.bits=u,(n.wsize||f!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&Je(t,t.output,t.next_out,f-t.avail_out),c-=t.avail_in,f-=t.avail_out,t.total_in+=c,t.total_out+=f,n.total+=f,n.wrap&&f&&(t.adler=n.check=(n.flags?Ct:At)(n.check,r,f,t.next_out-f)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),b=(0==c&&0===f||4===e)&&b===Be?-5:b},inflateEnd:function(t){if(!t||!t.state)return He;var e=t.state;return e.window&&(e.window=null),t.state=null,Be},inflateGetHeader:function(t,e){return!t||!t.state||0==(2&(t=t.state).wrap)?He:((t.head=e).done=!1,Be)},inflateSetDictionary:function(t,e){var n,i=e.length;return!t||!t.state||0!==(n=t.state).wrap&&11!==n.mode?He:11===n.mode&&At(1,e,i,0)!==n.check?-3:Je(t,e,i,i)?(n.mode=31,-4):(n.havedict=1,Be)},inflateInfo:"pako inflate (from Nodeca project)"},tn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var en=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},nn=Object.prototype.toString;function rn(t){if(!(this instanceof rn))return new rn(t);this.options=D.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new we,this.strm.avail_out=0;t=Qe.inflateInit2(this.strm,e.windowBits);if(t!==tn.Z_OK)throw new Error(It[t]);if(this.header=new en,Qe.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Ee.string2buf(e.dictionary):"[object ArrayBuffer]"===nn.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Qe.inflateSetDictionary(this.strm,e.dictionary))!==tn.Z_OK))throw new Error(It[t])}function on(t,e){e=new rn(e);if(e.push(t,!0),e.err)throw e.msg||It[e.err];return e.result}rn.prototype.push=function(t,e){var n,i,r,o,a,s=this.strm,h=this.options.chunkSize,l=this.options.dictionary,u=!1;if(this.ended)return!1;i=e===~~e?e:!0===e?tn.Z_FINISH:tn.Z_NO_FLUSH,"string"==typeof t?s.input=Ee.binstring2buf(t):"[object ArrayBuffer]"===nn.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new D.Buf8(h),s.next_out=0,s.avail_out=h),(n=(n=Qe.inflate(s,tn.Z_NO_FLUSH))===tn.Z_NEED_DICT&&l?Qe.inflateSetDictionary(this.strm,l):n)===tn.Z_BUF_ERROR&&!0===u&&(n=tn.Z_OK,u=!1),n!==tn.Z_STREAM_END&&n!==tn.Z_OK)return this.onEnd(n),!(this.ended=!0)}while(s.next_out&&(0!==s.avail_out&&n!==tn.Z_STREAM_END&&(0!==s.avail_in||i!==tn.Z_FINISH&&i!==tn.Z_SYNC_FLUSH)||("string"===this.options.to?(r=Ee.utf8border(s.output,s.next_out),o=s.next_out-r,a=Ee.buf2string(s.output,r),s.next_out=o,s.avail_out=h-o,o&&D.arraySet(s.output,s.output,r,o,0),this.onData(a)):this.onData(D.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(u=!0),(0<s.avail_in||0===s.avail_out)&&n!==tn.Z_STREAM_END);return(i=n===tn.Z_STREAM_END?tn.Z_FINISH:i)===tn.Z_FINISH?(n=Qe.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===tn.Z_OK):i!==tn.Z_SYNC_FLUSH||(this.onEnd(tn.Z_OK),!(s.avail_out=0))},rn.prototype.onData=function(t){this.chunks.push(t)},rn.prototype.onEnd=function(t){t===tn.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=D.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var an=function(t,e){return(e=e||{}).raw=!0,on(t,e)},t={};(0,D.assign)(t,Ne,{Inflate:rn,inflate:on,inflateRaw:an,ungzip:on},tn);var sn=t;(t=Ei=Ei||{})[t.None=0]="None",t[t.Single=1]="Single",t[t.Image=2]="Image",t[t.Gradation=4]="Gradation";var hn,ln,un=Ei;(Ei=hn=hn||{})[Ei.HWPTAG_DOCUMENT_PROPERTIES=16]="HWPTAG_DOCUMENT_PROPERTIES",Ei[Ei.HWPTAG_ID_MAPPINGS=17]="HWPTAG_ID_MAPPINGS",Ei[Ei.HWPTAG_BIN_DATA=18]="HWPTAG_BIN_DATA",Ei[Ei.HWPTAG_FACE_NAME=19]="HWPTAG_FACE_NAME",Ei[Ei.HWPTAG_BORDER_FILL=20]="HWPTAG_BORDER_FILL",Ei[Ei.HWPTAG_CHAR_SHAPE=21]="HWPTAG_CHAR_SHAPE",Ei[Ei.HWPTAG_TAB_DEF=22]="HWPTAG_TAB_DEF",Ei[Ei.HWPTAG_NUMBERING=23]="HWPTAG_NUMBERING",Ei[Ei.HWPTAG_BULLET=24]="HWPTAG_BULLET",Ei[Ei.HWPTAG_PARA_SHAPE=25]="HWPTAG_PARA_SHAPE",Ei[Ei.HWPTAG_STYLE=26]="HWPTAG_STYLE",Ei[Ei.HWPTAG_DOC_DATA=27]="HWPTAG_DOC_DATA",Ei[Ei.HWPTAG_DISTRIBUTE_DOC_DATA=28]="HWPTAG_DISTRIBUTE_DOC_DATA",Ei[Ei.RESERVED=29]="RESERVED",Ei[Ei.HWPTAG_COMPATIBLE_DOCUMENT=30]="HWPTAG_COMPATIBLE_DOCUMENT",Ei[Ei.HWPTAG_LAYOUT_COMPATIBILITY=31]="HWPTAG_LAYOUT_COMPATIBILITY",Ei[Ei.HWPTAG_TRACKCHANGE=32]="HWPTAG_TRACKCHANGE",Ei[Ei.HWPTAG_MEMO_SHAPE=92]="HWPTAG_MEMO_SHAPE",Ei[Ei.HWPTAG_FORBIDDEN_CHAR=94]="HWPTAG_FORBIDDEN_CHAR",Ei[Ei.HWPTAG_TRACK_CHANGE=96]="HWPTAG_TRACK_CHANGE",Ei[Ei.HWPTAG_TRACK_CHANGE_AUTHOR=97]="HWPTAG_TRACK_CHANGE_AUTHOR",(Ei=ln=ln||{})[Ei.HWPTAG_PARA_HEADER=66]="HWPTAG_PARA_HEADER",Ei[Ei.HWPTAG_PARA_TEXT=67]="HWPTAG_PARA_TEXT",Ei[Ei.HWPTAG_PARA_CHAR_SHAPE=68]="HWPTAG_PARA_CHAR_SHAPE",Ei[Ei.HWPTAG_PARA_LINE_SEG=69]="HWPTAG_PARA_LINE_SEG",Ei[Ei.HWPTAG_PARA_RANGE_TAG=70]="HWPTAG_PARA_RANGE_TAG",Ei[Ei.HWPTAG_CTRL_HEADER=71]="HWPTAG_CTRL_HEADER",Ei[Ei.HWPTAG_LIST_HEADER=72]="HWPTAG_LIST_HEADER",Ei[Ei.HWPTAG_PAGE_DEF=73]="HWPTAG_PAGE_DEF",Ei[Ei.HWPTAG_FOOTNOTE_SHAPE=74]="HWPTAG_FOOTNOTE_SHAPE",Ei[Ei.HWPTAG_PAGE_BORDER_FILL=75]="HWPTAG_PAGE_BORDER_FILL",Ei[Ei.HWPTAG_SHAPE_COMPONENT=76]="HWPTAG_SHAPE_COMPONENT",Ei[Ei.HWPTAG_TABLE=77]="HWPTAG_TABLE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_LINE=78]="HWPTAG_SHAPE_COMPONENT_LINE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_RECTANGLE=79]="HWPTAG_SHAPE_COMPONENT_RECTANGLE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_ELLIPSE=80]="HWPTAG_SHAPE_COMPONENT_ELLIPSE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_ARC=81]="HWPTAG_SHAPE_COMPONENT_ARC",Ei[Ei.HWPTAG_SHAPE_COMPONENT_POLYGON=82]="HWPTAG_SHAPE_COMPONENT_POLYGON",Ei[Ei.HWPTAG_SHAPE_COMPONENT_CURVE=83]="HWPTAG_SHAPE_COMPONENT_CURVE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_OLE=84]="HWPTAG_SHAPE_COMPONENT_OLE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_PICTURE=85]="HWPTAG_SHAPE_COMPONENT_PICTURE",Ei[Ei.HWPTAG_SHAPE_COMPONENT_CONTAINER=86]="HWPTAG_SHAPE_COMPONENT_CONTAINER",Ei[Ei.HWPTAG_CTRL_DATA=87]="HWPTAG_CTRL_DATA",Ei[Ei.HWPTAG_EQEDIT=88]="HWPTAG_EQEDIT",Ei[Ei.RESERVED=89]="RESERVED",Ei[Ei.HWPTAG_SHAPE_COMPONENT_TEXTART=90]="HWPTAG_SHAPE_COMPONENT_TEXTART",Ei[Ei.HWPTAG_FORM_OBJECT=91]="HWPTAG_FORM_OBJECT",Ei[Ei.HWPTAG_MEMO_SHAPE=92]="HWPTAG_MEMO_SHAPE",Ei[Ei.HWPTAG_MEMO_LIST=93]="HWPTAG_MEMO_LIST",Ei[Ei.HWPTAG_CHART_DATA=95]="HWPTAG_CHART_DATA",Ei[Ei.HWPTAG_VIDEO_DATA=98]="HWPTAG_VIDEO_DATA",Ei[Ei.HWPTAG_SHAPE_COMPONENT_UNKNOWN=115]="HWPTAG_SHAPE_COMPONENT_UNKNOWN";function cn(t,e){d(this,cn),p(this,"extension",void 0),p(this,"payload",void 0),this.extension=t,this.payload=e}var fn=function(){function e(t){d(this,e),p(this,"view",void 0),p(this,"offsetByte",0),this.view=new DataView(t)}return n(e,[{key:"readUInt32",value:function(){var t=this.view.getUint32(this.offsetByte,!0);return this.offsetByte+=4,t}},{key:"readInt32",value:function(){var t=this.view.getInt32(this.offsetByte,!0);return this.offsetByte+=4,t}},{key:"readInt16",value:function(){var t=this.view.getUint16(this.offsetByte,!0);return this.offsetByte+=2,t}},{key:"readUInt16",value:function(){var t=this.view.getUint16(this.offsetByte,!0);return this.offsetByte+=2,t}},{key:"readInt8",value:function(){var t=this.view.getInt8(this.offsetByte);return this.offsetByte+=1,t}},{key:"readUInt8",value:function(){var t=this.view.getUint8(this.offsetByte);return this.offsetByte+=1,t}},{key:"readRecord",value:function(){var t=this.readUInt32(),e=1023&t,n=t>>10&1023,t=t>>20&4095;return 4095==t?[e,n,this.readUInt32()]:[e,n,t]}},{key:"read",value:function(t){var e=this.view.buffer.slice(this.offsetByte,this.offsetByte+t);return this.offsetByte+=t,e}},{key:"readString",value:function(){for(var t=this.readUInt16(),e=[],n=0;n<t;n+=1)e.push(String.fromCharCode(this.readUInt16()));return e.join("")}},{key:"remainByte",value:function(){return this.view.byteLength-this.offsetByte}},{key:"skipByte",value:function(t){this.offsetByte+=t}},{key:"isEOF",value:function(){return this.view.byteLength<=this.offsetByte}},{key:"getView",value:function(){return this.view}},{key:"getOffsetByte",value:function(){return this.offsetByte}}]),e}();function dn(t,e,n){for(var t=t>>e,i=0,r=0;r<=n-e;r+=1)i<<=1,i+=1;return t&i}function pn(t){return[dn(t,0,7),dn(t,8,15),dn(t,16,23)]}function gn(t,e){e=1<<e;return(t&e)==e}function _n(t,e,n,i,r,o,a,s,h,l,u,c,f){d(this,_n),p(this,"fontId",void 0),p(this,"fontScale",void 0),p(this,"fontSpacing",void 0),p(this,"fontRatio",void 0),p(this,"fontLocation",void 0),p(this,"fontBaseSize",void 0),p(this,"attr",void 0),p(this,"shadow",void 0),p(this,"shadow2",void 0),p(this,"color",void 0),p(this,"underLineColor",void 0),p(this,"shadeColor",void 0),p(this,"shadowColor",void 0),p(this,"fontBackgroundId",null),p(this,"strikeColor",null),this.fontId=t,this.fontScale=e,this.fontSpacing=n,this.fontRatio=i,this.fontLocation=r,this.fontBaseSize=o/100,this.attr=a,this.shadow=pn(s),this.shadow2=pn(h),this.color=pn(l),this.underLineColor=pn(u),this.shadeColor=pn(c),this.shadowColor=pn(f)}function yn(){d(this,yn),p(this,"align",0)}function vn(t,e){d(this,vn),p(this,"attribute",void 0),p(this,"style",void 0),p(this,"backgroundColor",null),this.attribute=t,this.style=e}var mn=function(){function t(){d(this,t),p(this,"name",""),p(this,"alternative",""),p(this,"default",""),p(this,"panose",null)}return n(t,[{key:"getFontFamily",value:function(){var t,e=["".concat(this.name)];return this.alternative&&e.push('"'.concat(this.alternative,'"')),this.default&&e.push('"'.concat(this.default,'"')),this.panose&&(t=this.panose.getFontFamily(),e.push(t)),e.join(",")}}]),t}(),Sn=function(){function t(){d(this,t),p(this,"family",0),p(this,"serifStyle",0),p(this,"weight",0),p(this,"proportion",0),p(this,"contrast",0),p(this,"strokeVariation",0),p(this,"armStyle",0),p(this,"letterForm",0),p(this,"midline",0),p(this,"xHeight",0)}return n(t,[{key:"getFontFamily",value:function(){if(3===this.family)return"cursive";if(2===this.family){if(1<this.serifStyle&&this.serifStyle<11)return"sans";if(10<this.serifStyle&&this.serifStyle<14)return"sans-serf"}return""}}]),t}(),En=new ArrayBuffer(0),wn=function t(e,n,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:En;d(this,t),p(this,"children",[]),p(this,"payload",void 0),p(this,"tagID",void 0),p(this,"size",void 0),p(this,"parentTagID",void 0),this.tagID=e,this.size=n,this.parentTagID=i,this.payload=r};function bn(t){for(var e=new fn(t.buffer),n=new wn(0,0,0);!e.isEOF();){for(var i=l(e.readRecord(),3),r=i[0],o=i[1],a=i[2],s=n,i=e.read(a),h=0;h<o;h+=1)s=s.children.slice(-1).pop();s.children.push(new wn(r,a,s.tagID,i))}return n}var Tn,An,On,Cn,In,Rn,Nn,Pn,Ln,Mn=function(){function i(t,e){var n=this;d(this,i),p(this,"record",void 0),p(this,"result",new E),p(this,"container",void 0),p(this,"visit",function(t){switch(t.tagID){case hn.HWPTAG_DOCUMENT_PROPERTIES:n.visitDocumentPropertes(t);break;case hn.HWPTAG_CHAR_SHAPE:n.visitCharShape(t);break;case hn.HWPTAG_FACE_NAME:n.visitFaceName(t);break;case hn.HWPTAG_BIN_DATA:n.visitBinData(t);break;case hn.HWPTAG_BORDER_FILL:n.visitBorderFill(t);break;case hn.HWPTAG_PARA_SHAPE:n.visitParagraphShape(t);break;case hn.HWPTAG_COMPATIBLE_DOCUMENT:n.visitCompatibleDocument(t);break;case hn.HWPTAG_LAYOUT_COMPATIBILITY:n.visitLayoutCompatibility(t)}t.children.forEach(n.visit)}),this.record=bn(t),this.container=e}return n(i,[{key:"visitDocumentPropertes",value:function(t){t=new fn(t.payload);this.result.sectionSize=t.readUInt16(),this.result.startingIndex.page=t.readUInt16(),this.result.startingIndex.footnote=t.readUInt16(),this.result.startingIndex.endnote=t.readUInt16(),this.result.startingIndex.picture=t.readUInt16(),this.result.startingIndex.table=t.readUInt16(),this.result.startingIndex.equation=t.readUInt16(),this.result.caratLocation.listId=t.readUInt32(),this.result.caratLocation.paragraphId=t.readUInt32(),this.result.caratLocation.charIndex=t.readUInt32()}},{key:"visitCharShape",value:function(t){var e=new fn(t.payload),n=new _n([e.readUInt16(),e.readUInt16(),e.readUInt16(),e.readUInt16(),e.readUInt16(),e.readUInt16(),e.readUInt16()],[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()],[e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8()],[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()],[e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8(),e.readInt8()],e.readInt32(),e.readUInt32(),e.readUInt8(),e.readUInt8(),e.readUInt32(),e.readUInt32(),e.readUInt32(),e.readUInt32());68<t.size&&(n.fontBackgroundId=e.readUInt16()),70<t.size&&(n.underLineColor=pn(e.readInt32())),this.result.charShapes.push(n)}},{key:"visitFaceName",value:function(t){var e=new fn(t.payload),n=e.readUInt8(),i=gn(n,7),r=gn(n,6),t=gn(n,5),n=new mn;n.name=e.readString(),i&&(e.skipByte(1),n.alternative=e.readString()),r&&((r=new Sn).family=e.readInt8(),r.serifStyle=e.readInt8(),r.weight=e.readInt8(),r.proportion=e.readInt8(),r.contrast=e.readInt8(),r.strokeVariation=e.readInt8(),r.armStyle=e.readInt8(),r.letterForm=e.readInt8(),r.midline=e.readInt8(),r.xHeight=e.readInt8(),n.panose=r),t&&(n.default=e.readString()),this.result.fontFaces.push(n)}},{key:"visitBinData",value:function(t){var e=new fn(t.payload);e.readUInt16();var n=e.readUInt16(),t=e.readString(),e=this.container.getRootStorage().findChild(function(t){return"BinData"===t.getDirectoryEntryName()}),i="BIN".concat("".concat(n.toString(16).toUpperCase()).padStart(4,"0"),".").concat(t),e=e.findChild(function(t){return i===t.getDirectoryEntryName()}),e=new Uint8Array(e.getStreamData());this.result.binData.push(new cn(t,sn.inflate(e,{windowBits:-15})))}},{key:"visitBorderFill",value:function(t){var e=new fn(t.payload),t=new vn(e.readUInt16(),{left:{type:e.readUInt8(),width:e.readUInt8(),color:pn(e.readUInt32())},right:{type:e.readUInt8(),width:e.readUInt8(),color:pn(e.readUInt32())},top:{type:e.readUInt8(),width:e.readUInt8(),color:pn(e.readUInt32())},bottom:{type:e.readUInt8(),width:e.readUInt8(),color:pn(e.readUInt32())}});e.skipByte(6),e.readUInt32()===un.Single&&(t.backgroundColor=pn(e.readUInt32())),this.result.borderFills.push(t)}},{key:"visitParagraphShape",value:function(t){var e=new fn(t.payload).readUInt32(),t=new yn;t.align=dn(e,2,4),this.result.paragraphShapes.push(t)}},{key:"visitCompatibleDocument",value:function(t){t=new fn(t.payload);this.result.compatibleDocument=t.readUInt32()}},{key:"visitLayoutCompatibility",value:function(t){t=new fn(t.payload);this.result.layoutCompatiblity.char=t.readUInt32(),this.result.layoutCompatiblity.paragraph=t.readUInt32(),this.result.layoutCompatiblity.section=t.readUInt32(),this.result.layoutCompatiblity.object=t.readUInt32(),this.result.layoutCompatiblity.field=t.readUInt32()}},{key:"parse",value:function(){return this.record.children.forEach(this.visit),this.result}}]),i}();function Dn(t,e,n,i){return t.charCodeAt(0)<<24|e.charCodeAt(0)<<16|n.charCodeAt(0)<<8|i.charCodeAt(0)}(Ei=Tn=Tn||{})[Ei.Table=Dn("t","b","l"," ")]="Table",Ei[Ei.Line=Dn("$","l","i","n")]="Line",Ei[Ei.Rectangle=Dn("$","r","e","c")]="Rectangle",Ei[Ei.Ellipse=Dn("$","e","l","l")]="Ellipse",Ei[Ei.Arc=Dn("$","a","r","c")]="Arc",Ei[Ei.Polygon=Dn("$","p","o","l")]="Polygon",Ei[Ei.Curve=Dn("$","c","u","r")]="Curve",Ei[Ei.Equation=Dn("e","q","e","d")]="Equation",Ei[Ei.Picture=Dn("$","p","i","c")]="Picture",Ei[Ei.OLE=Dn("$","o","l","e")]="OLE",Ei[Ei.Connected=Dn("$","c","o","n")]="Connected",Ei[Ei.GenShapeObject=Dn("g","s","o"," ")]="GenShapeObject",(Ei=An=An||{})[Ei.Section=Dn("s","e","c","d")]="Section",Ei[Ei.Column=Dn("c","o","l","d")]="Column",Ei[Ei.Header=Dn("h","e","a","d")]="Header",Ei[Ei.Footer=Dn("f","o","o","t")]="Footer",Ei[Ei.Footnote=Dn("f","n"," "," ")]="Footnote",Ei[Ei.Endnote=Dn("e","n"," "," ")]="Endnote",Ei[Ei.AutoNumber=Dn("a","t","n","o")]="AutoNumber",Ei[Ei.NewNumber=Dn("n","w","n","o")]="NewNumber",Ei[Ei.PageHide=Dn("p","g","h","d")]="PageHide",Ei[Ei.PageCT=Dn("p","g","c","t")]="PageCT",Ei[Ei.PageNumberPosition=Dn("p","g","n","p")]="PageNumberPosition",Ei[Ei.Indexmark=Dn("i","d","x","m")]="Indexmark",Ei[Ei.Bookmark=Dn("b","o","k","m")]="Bookmark",Ei[Ei.Overlapping=Dn("t","c","p","s")]="Overlapping",Ei[Ei.Comment=Dn("t","d","u","t")]="Comment",Ei[Ei.HiddenComment=Dn("t","c","m","t")]="HiddenComment",(Ei={})[Ei.Unknown=Dn("%","u","n","k")]="Unknown",Ei[Ei.Date=Dn("$","d","t","e")]="Date",Ei[Ei.DocDate=Dn("%","d","d","t")]="DocDate",Ei[Ei.Path=Dn("%","p","a","t")]="Path",Ei[Ei.Bookmark=Dn("%","b","m","k")]="Bookmark",Ei[Ei.MailMerge=Dn("%","m","m","g")]="MailMerge",Ei[Ei.CrossRef=Dn("%","x","r","f")]="CrossRef",Ei[Ei.Formula=Dn("%","f","m","u")]="Formula",Ei[Ei.ClickHere=Dn("%","c","l","k")]="ClickHere",Ei[Ei.Summary=Dn("$","s","m","r")]="Summary",Ei[Ei.UserInfo=Dn("%","u","s","r")]="UserInfo",Ei[Ei.HyperLink=Dn("%","h","l","k")]="HyperLink",Ei[Ei.RevisionSign=Dn("%","s","i","g")]="RevisionSign",Ei[Ei.RevisionDelete=Dn("%","%","*","d")]="RevisionDelete",Ei[Ei.RevisionAttach=Dn("%","%","*","a")]="RevisionAttach",Ei[Ei.RevisionClipping=Dn("%","%","*","C")]="RevisionClipping",Ei[Ei.RevisionSawtooth=Dn("%","%","*","S")]="RevisionSawtooth",Ei[Ei.RevisionThinking=Dn("%","%","*","T")]="RevisionThinking",Ei[Ei.RevisionPraise=Dn("%","%","*","P")]="RevisionPraise",Ei[Ei.RevisionLine=Dn("%","%","*","L")]="RevisionLine",Ei[Ei.RevisionSimpleChange=Dn("%","%","*","c")]="RevisionSimpleChange",Ei[Ei.RevisionHyperLink=Dn("%","%","*","h")]="RevisionHyperLink",Ei[Ei.RevisionLineAttach=Dn("%","%","*","A")]="RevisionLineAttach",Ei[Ei.RevisionLineLink=Dn("%","%","*","i")]="RevisionLineLink",Ei[Ei.RevisionLineRansfer=Dn("%","%","*","t")]="RevisionLineRansfer",Ei[Ei.RevisionRightMove=Dn("%","%","*","r")]="RevisionRightMove",Ei[Ei.RevisionLeftMove=Dn("%","%","*","l")]="RevisionLeftMove",Ei[Ei.RevisionTransfer=Dn("%","%","*","n")]="RevisionTransfer",Ei[Ei.RevisionSimpleInsert=Dn("%","%","*","e")]="RevisionSimpleInsert",Ei[Ei.RevisionSplit=Dn("%","s","p","l")]="RevisionSplit",Ei[Ei.RevisionChange=Dn("%","%","m","r")]="RevisionChange",Ei[Ei.Memo=Dn("%","%","m","e")]="Memo",Ei[Ei.PrivateInfoSecurity=Dn("%","c","p","r")]="PrivateInfoSecurity",Ei[Ei.TableOfContents=Dn("%","t","o","c")]="TableOfContents",(Ei=On=On||{})[Ei.Paper=0]="Paper",Ei[Ei.Page=1]="Page",Ei[Ei.Paragraph=2]="Paragraph",(Ei=Cn=Cn||{})[Ei.Page=0]="Page",Ei[Ei.Column=1]="Column",Ei[Ei.Paragraph=2]="Paragraph",(Ei=In=In||{})[Ei.Paper=0]="Paper",Ei[Ei.Page=1]="Page",Ei[Ei.Column=2]="Column",Ei[Ei.Paragraph=3]="Paragraph",Ei[Ei.Absolute=4]="Absolute",(Ei=Rn=Rn||{})[Ei.Paper=0]="Paper",Ei[Ei.Page=1]="Page",Ei[Ei.Absolute=2]="Absolute",(Ei=Nn=Nn||{})[Ei.Square=0]="Square",Ei[Ei.Tight=1]="Tight",Ei[Ei.Through=2]="Through",Ei[Ei.TopAndBottom=3]="TopAndBottom",Ei[Ei.BehindText=4]="BehindText",Ei[Ei.InFrontOfText=5]="InFrontOfText",(Ei=Pn=Pn||{})[Ei.BothSides=0]="BothSides",Ei[Ei.LeftOnly=1]="LeftOnly",Ei[Ei.RightOnly=2]="RightOnly",Ei[Ei.LargestOnly=3]="LargestOnly",(Ei=Ln=Ln||{})[Ei.None=0]="None",Ei[Ei.Figure=1]="Figure",Ei[Ei.Table=2]="Table",Ei[Ei.Equation=3]="Equation";function Fn(){d(this,Fn),p(this,"id",0),p(this,"attribute",new Gn),p(this,"verticalOffset",0),p(this,"horizontalOffset",0),p(this,"width",0),p(this,"height",0),p(this,"zIndex",0),p(this,"margin",[0,0,0,0]),p(this,"uid",0),p(this,"split",0)}function xn(t,e){d(this,xn),p(this,"pos",0),p(this,"shapeIndex",0),this.pos=t,this.shapeIndex=e}function kn(){d(this,kn),p(this,"start",0),p(this,"y",0),p(this,"height",0),p(this,"textHeight",0),p(this,"baseLineGap",0),p(this,"lineSpacing",0),p(this,"startByte",0),p(this,"width",0)}var Bn,Hn,Gn=function(){function t(){d(this,t),p(this,"isTextLike",!1),p(this,"isApplyLineSpace",!1),p(this,"vertRelTo",On.Paper),p(this,"vertRelativeArrange",0),p(this,"horzRelTo",Cn.Page),p(this,"horzRelativeArrange",0),p(this,"isVertRelToParaLimit",!1),p(this,"isAllowOverlap",!1),p(this,"widthCriterion",In.Paper),p(this,"heightCriterion",Rn.Paper),p(this,"isProtectSize",!1),p(this,"textFlowMethod",Nn.Square),p(this,"textHorzArrange",Pn.BothSides),p(this,"objectType",Ln.None)}return n(t,[{key:"setHorzRelTo",value:function(t){0!==t&&1!==t||(this.horzRelTo=Cn.Page),2===t&&(this.horzRelTo=Cn.Column),3===t&&(this.horzRelTo=Cn.Paragraph)}},{key:"getVertAlign",value:function(){return 0===this.vertRelativeArrange?this.vertRelTo===On.Paper||this.vertRelTo===On.Page?"top":"left":1!==this.vertRelativeArrange||this.vertRelTo!==On.Paper&&this.vertRelTo!==On.Page?2===this.vertRelativeArrange?this.vertRelTo===On.Paper||this.vertRelTo===On.Page?"bottom":"right":3!==this.vertRelativeArrange||this.vertRelTo!==On.Paper&&this.vertRelTo!==On.Page?4!==this.vertRelativeArrange||this.vertRelTo!==On.Paper&&this.vertRelTo!==On.Page?null:"outside":"inside":"center"}},{key:"getHorzAlign",value:function(){return 0===this.horzRelativeArrange?this.horzRelTo===Cn.Page?"top":"left":1===this.horzRelativeArrange&&this.horzRelTo===Cn.Page?"center":2===this.horzRelativeArrange?this.horzRelTo===Cn.Page?"bottom":"right":3===this.horzRelativeArrange&&this.horzRelTo===Cn.Page?"inside":4===this.horzRelativeArrange&&this.horzRelTo===Cn.Page?"outside":null}}]),t}(),Un=function(){e(o,Fn);var r=h(o);function o(){var t;d(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return p(s(t=r.call.apply(r,[this].concat(n))),"type",0),p(s(t),"info",null),p(s(t),"content",[]),t}return o}(),jn=function(){e(o,Fn);var r=h(o);function o(){var t;d(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return p(s(t=r.call.apply(r,[this].concat(n))),"tableAttribute",0),p(s(t),"rowCount",0),p(s(t),"columnCount",0),p(s(t),"borderFillID",0),p(s(t),"content",[]),t}return n(o,[{key:"addRow",value:function(t,e){this.content[t]||(this.content[t]=[]),this.content[t].push(e)}}]),o}(),Vn=function(){function t(){d(this,t),p(this,"content",[]),p(this,"shapeBuffer",[]),p(this,"controls",[]),p(this,"lineSegments",[]),p(this,"shapeIndex",0),p(this,"aligns",0),p(this,"textSize",0)}return n(t,[{key:"getShapeEndPos",value:function(t){return t===this.shapeBuffer.length-1?this.content.length-1:this.shapeBuffer[t+1].pos-1}},{key:"getNextSize",value:function(t){t=this.lineSegments[t+1];return t?t.start:this.textSize}}]),t}(),Wn=function t(e,n){d(this,t),p(this,"attribute",void 0),p(this,"items",[]),this.attribute=e,this.items=n},zn=function(){function e(t){d(this,e),p(this,"cursor",void 0),p(this,"records",void 0),this.records=t,this.cursor=0}return n(e,[{key:"hasNext",value:function(){return this.cursor<this.records.length}},{key:"current",value:function(){return this.records[this.cursor]}},{key:"read",value:function(){var t=this.records[this.cursor];return this.cursor+=1,t}}]),e}();function $n(t){return t.id===Tn.Table}function Yn(t){return t.id===Tn.GenShapeObject}function Kn(t){return t.type===Tn.Picture}(Ei=Bn=Bn||{})[Ei.Normal=0]="Normal",Ei[Ei.Parallel=1]="Parallel",Ei[Ei.Justify=2]="Justify",(Ei=Hn=Hn||{})[Ei.Left=0]="Left",Ei[Ei.Right=1]="Right",Ei[Ei.Justify=2]="Justify";function qn(){d(this,qn),p(this,"id",0),p(this,"type",Bn.Normal),p(this,"count",0),p(this,"direction",Hn.Left),p(this,"isSameWidth",!0),p(this,"gap",0),p(this,"widths",[]),p(this,"borderStyle",0),p(this,"borderWidth",0),p(this,"borderColor",0)}var Zn=function(){function e(t){d(this,e),p(this,"record",void 0),p(this,"result",void 0),p(this,"content",[]),this.record=bn(t),this.result=new T}return n(e,[{key:"visitPageDef",value:function(t){t=new fn(t.payload);this.result.width=t.readUInt32(),this.result.height=t.readUInt32(),this.result.paddingLeft=t.readUInt32(),this.result.paddingRight=t.readUInt32(),this.result.paddingTop=t.readUInt32(),this.result.paddingBottom=t.readUInt32(),this.result.headerPadding=t.readUInt32(),this.result.footerPadding=t.readUInt32();t=t.readUInt32();this.result.orientation=dn(t,0,0),this.result.bookBindingMethod=dn(t,1,2)}},{key:"visitParaText",value:function(t,e){for(var n=new fn(t.payload),i=0;i<t.size;){var r=n.readUInt16();switch(r){case 0:case 10:case 13:e.content.push(new A(f.Char,r)),e.textSize+=1,i+=2;break;case 4:case 5:case 6:case 7:case 8:case 9:case 19:case 20:e.content.push(new A(f.Inline,r)),e.textSize+=8,n.skipByte(14),i+=16;break;case 1:case 2:case 3:case 11:case 12:case 14:case 15:case 16:case 17:case 18:case 21:case 22:case 23:e.content.push(new A(f.Extened,r)),n.skipByte(14),e.textSize+=8,i+=16;break;default:e.content.push(new A(f.Char,String.fromCharCode(r))),e.textSize+=1,i+=2}}}},{key:"visitCharShape",value:function(t,e){t=new fn(t.payload),t=new xn(t.readUInt32(),t.readUInt32());e.shapeBuffer.push(t)}},{key:"visitCommonControl",value:function(t,e){var n=t.readUInt32();e.attribute.isTextLike=gn(n,0),e.attribute.isApplyLineSpace=gn(n,2),e.attribute.vertRelTo=dn(n,3,4),e.attribute.vertRelativeArrange=dn(n,5,7),e.attribute.horzRelTo=dn(n,8,9),e.attribute.horzRelativeArrange=dn(n,10,12),e.attribute.isVertRelToParaLimit=gn(n,13),e.attribute.isAllowOverlap=gn(n,14),e.attribute.widthCriterion=dn(n,15,17),e.attribute.heightCriterion=dn(n,18,19),e.attribute.isProtectSize=gn(n,20),e.attribute.textFlowMethod=dn(n,21,23),e.attribute.textHorzArrange=dn(n,24,25),e.attribute.objectType=dn(n,26,28),e.verticalOffset=t.readUInt32(),e.horizontalOffset=t.readUInt32(),e.width=t.readUInt32(),e.height=t.readUInt32(),e.zIndex=t.readUInt32(),e.margin=[t.readInt16(),t.readInt16(),t.readInt16(),t.readInt16()],e.uid=t.readUInt32(),t.getView().byteLength>t.getOffsetByte()&&(e.split=t.readInt32())}},{key:"visitTableControl",value:function(t){var e=new jn;return e.id=Tn.Table,this.visitCommonControl(t,e),e}},{key:"getControl",value:function(t){var e=t.readUInt32();if(e===Tn.Table)return this.visitTableControl(t);if(e===Tn.GenShapeObject){var n=new Un;return n.id=e,this.visitCommonControl(t,n),n}if(e!==An.Column)return{id:e};var i=new qn,n=t.readUInt16();if(i.type=dn(n,0,1),i.count=dn(n,2,9),i.direction=dn(n,10,11),i.isSameWidth=gn(n,12),i.id=e,i.gap=t.readUInt16(),!i.isSameWidth){for(var r=[],o=0;o<i.count;o+=1)r.push(t.readUInt16());i.widths=r}return t.readUInt16(),i.borderStyle=t.readUInt8(),i.borderWidth=t.readUInt8(),i.borderColor=t.readUInt32(),i}},{key:"visitControlHeader",value:function(t,e){for(var n=new fn(t.payload),i=this.getControl(n),r=new zn(t.children);r.hasNext();)this.visit(r,e,i);e.controls.push(i)}},{key:"visitCellListHeader",value:function(t){var e={column:t.readUInt16(),row:t.readUInt16(),colSpan:t.readUInt16(),rowSpan:t.readUInt16(),width:t.readUInt32(),height:t.readUInt32(),padding:[t.readUInt16(),t.readUInt16(),t.readUInt16(),t.readUInt16()]};return t.isEOF()||(e.borderFillID=t.readUInt16()-1),e}},{key:"visitListHeader",value:function(t,e,n){if(!n)throw new Error("Except: control, Recived: ".concat(n));var i=new fn(t.payload),r=30===t.size?i.readInt16():i.readInt32();i.readUInt32();for(var o,a=[],s=0;s<r;s+=1){var h=e.read();this.visitParagraphHeader(h,a,n)}t.parentTagID===ln.HWPTAG_CTRL_HEADER&&$n(n)&&(o=this.visitCellListHeader(i),i=new Wn(o,a),n.addRow(o.row,i)),t.parentTagID===ln.HWPTAG_SHAPE_COMPONENT&&Yn(n)&&n.content.push(new Wn(null,a))}},{key:"visitTable",value:function(t,e){t=new fn(t.payload);if(!e)throw new Error("Expect control");if(e.id!==Tn.Table)throw new Error("Expect: ".concat(Tn.Table,", Recived: ").concat(e.id));e.tableAttribute=t.readUInt32(),e.rowCount=t.readUInt16(),e.columnCount=t.readUInt16(),t.skipByte(10+2*e.rowCount),e.borderFillID=t.readUInt16()}},{key:"visitShapeComponent",value:function(t,e,n){for(var i=new zn(t.children);i.hasNext();)this.visit(i,e,n)}},{key:"visitPicture",value:function(t,e){if(!Yn(e))throw new Error("Control type not matched");t=new fn(t.payload);t.skipByte(71),e.type=Tn.Picture,e.info={binID:t.readUInt16()-1}}},{key:"visitLineSegment",value:function(t,e){for(var n=new fn(t.payload);!n.isEOF();){var i=new kn;i.start=n.readUInt32(),i.y=n.readInt32(),i.height=n.readInt32(),i.textHeight=n.readInt32(),i.baseLineGap=n.readInt32(),i.lineSpacing=n.readInt32(),i.startByte=n.readInt32(),i.width=n.readInt32(),n.readUInt32(),e.lineSegments.push(i)}}},{key:"visit",value:function(t,e,n,i,r){var o=t.read();switch(o.tagID){case ln.HWPTAG_LIST_HEADER:this.visitListHeader(o,t,n);break;case ln.HWPTAG_PAGE_DEF:this.visitPageDef(o);break;case ln.HWPTAG_PARA_TEXT:this.visitParaText(o,e);break;case ln.HWPTAG_PARA_CHAR_SHAPE:this.visitCharShape(o,e);break;case ln.HWPTAG_CTRL_HEADER:this.visitControlHeader(o,e);break;case ln.HWPTAG_TABLE:this.visitTable(o,n);break;case ln.HWPTAG_SHAPE_COMPONENT:this.visitShapeComponent(o,e,n);break;case ln.HWPTAG_SHAPE_COMPONENT_PICTURE:this.visitPicture(o,n);break;case ln.HWPTAG_PARA_LINE_SEG:this.visitLineSegment(o,e)}}},{key:"visitParagraphHeader",value:function(t,e,n,i){var r=new Vn,o=new fn(t.payload);o.skipByte(8),r.shapeIndex=o.readUInt16();for(var a=new zn(t.children);a.hasNext();)this.visit(a,r,n);e.push(r)}},{key:"traverse",value:function(t){for(var e=new zn(t.children);e.hasNext();)this.visitParagraphHeader(e.read(),this.content)}},{key:"parse",value:function(){return this.traverse(this.record),this.result.content=this.content,this.result}}]),e}(),Xn=Qn,Jn=null;try{Jn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function Qn(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function ti(t){return!0===(t&&t.__isLong__)}Object.defineProperty(Qn.prototype,"__isLong__",{value:!0}),Qn.isLong=ti;var ei={},ni={};function ii(t,e){var n,i,r;return e?(r=0<=(t>>>=0)&&t<256)&&(i=ni[t])?i:(n=oi(t,(0|t)<0?-1:0,!0),r&&(ni[t]=n),n):(r=-128<=(t|=0)&&t<128)&&(i=ei[t])?i:(n=oi(t,t<0?-1:0,!1),r&&(ei[t]=n),n)}function ri(t,e){if(isNaN(t))return e?pi:di;if(e){if(t<0)return pi;if(ui<=t)return mi}else{if(t<=-ci)return Si;if(ci<=t+1)return vi}return t<0?ri(-t,e).neg():oi(t%li|0,t/li|0,e)}function oi(t,e,n){return new Qn(t,e,n)}Qn.fromInt=ii,Qn.fromNumber=ri,Qn.fromBits=oi;var ai=Math.pow;function si(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return di;if(e="number"==typeof e?(n=e,!1):!!e,(n=n||10)<2||36<n)throw RangeError("radix");var i;if(0<(i=t.indexOf("-")))throw Error("interior hyphen");if(0===i)return si(t.substring(1),e,n).neg();for(var r=ri(ai(n,8)),o=di,a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a),h=parseInt(t.substring(a,a+s),n);o=s<8?(s=ri(ai(n,s)),o.mul(s).add(ri(h))):(o=o.mul(r)).add(ri(h))}return o.unsigned=e,o}function hi(t,e){return"number"==typeof t?ri(t,e):"string"==typeof t?si(t,e):oi(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}Qn.fromString=si,Qn.fromValue=hi;var li=4294967296,ui=li*li,ci=ui/2,fi=ii(1<<24),di=ii(0);Qn.ZERO=di;var pi=ii(0,!0);Qn.UZERO=pi;var gi=ii(1);Qn.ONE=gi;var _i=ii(1,!0);Qn.UONE=_i;var yi=ii(-1);Qn.NEG_ONE=yi;var vi=oi(-1,2147483647,!1);Qn.MAX_VALUE=vi;var mi=oi(-1,-1,!0);Qn.MAX_UNSIGNED_VALUE=mi;var Si=oi(0,-2147483648,!1);Qn.MIN_VALUE=Si;var Ei=Qn.prototype;Ei.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ei.toNumber=function(){return this.unsigned?(this.high>>>0)*li+(this.low>>>0):this.high*li+(this.low>>>0)},Ei.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Si)){var e=ri(t),n=this.div(e),e=n.mul(e).sub(this);return n.toString(t)+e.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=ri(ai(t,6),this.unsigned),r=this,o="";;){var a=r.div(i),s=(r.sub(a.mul(i)).toInt()>>>0).toString(t);if((r=a).isZero())return s+o;for(;s.length<6;)s="0"+s;o=""+s+o}},Ei.getHighBits=function(){return this.high},Ei.getHighBitsUnsigned=function(){return this.high>>>0},Ei.getLowBits=function(){return this.low},Ei.getLowBitsUnsigned=function(){return this.low>>>0},Ei.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Si)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;0<e&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},Ei.isZero=function(){return 0===this.high&&0===this.low},Ei.eqz=Ei.isZero,Ei.isNegative=function(){return!this.unsigned&&this.high<0},Ei.isPositive=function(){return this.unsigned||0<=this.high},Ei.isOdd=function(){return 1==(1&this.low)},Ei.isEven=function(){return 0==(1&this.low)},Ei.equals=function(t){return ti(t)||(t=hi(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},Ei.eq=Ei.equals,Ei.notEquals=function(t){return!this.eq(t)},Ei.neq=Ei.notEquals,Ei.ne=Ei.notEquals,Ei.lessThan=function(t){return this.comp(t)<0},Ei.lt=Ei.lessThan,Ei.lessThanOrEqual=function(t){return this.comp(t)<=0},Ei.lte=Ei.lessThanOrEqual,Ei.le=Ei.lessThanOrEqual,Ei.greaterThan=function(t){return 0<this.comp(t)},Ei.gt=Ei.greaterThan,Ei.greaterThanOrEqual=function(t){return 0<=this.comp(t)},Ei.gte=Ei.greaterThanOrEqual,Ei.ge=Ei.greaterThanOrEqual,Ei.compare=function(t){if(ti(t)||(t=hi(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},Ei.comp=Ei.compare,Ei.negate=function(){return!this.unsigned&&this.eq(Si)?Si:this.not().add(gi)},Ei.neg=Ei.negate,Ei.add=function(t){ti(t)||(t=hi(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,r=65535&this.low,o=t.high>>>16,a=65535&t.high,s=t.low>>>16,h=0,l=0,u=0,c=0;return u+=(c+=r+(65535&t.low))>>>16,l+=(u+=i+s)>>>16,h+=(l+=n+a)>>>16,h+=e+o,oi((u&=65535)<<16|(c&=65535),(h&=65535)<<16|(l&=65535),this.unsigned)},Ei.subtract=function(t){return ti(t)||(t=hi(t)),this.add(t.neg())},Ei.sub=Ei.subtract,Ei.multiply=function(t){if(this.isZero())return di;if(ti(t)||(t=hi(t)),Jn)return oi(Jn.mul(this.low,this.high,t.low,t.high),Jn.get_high(),this.unsigned);if(t.isZero())return di;if(this.eq(Si))return t.isOdd()?Si:di;if(t.eq(Si))return this.isOdd()?Si:di;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(fi)&&t.lt(fi))return ri(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,r=65535&this.low,o=t.high>>>16,a=65535&t.high,s=t.low>>>16,h=65535&t.low,l=0,u=0,c=0,t=0;return c+=(t+=r*h)>>>16,u+=(c+=i*h)>>>16,c&=65535,u+=(c+=r*s)>>>16,l+=(u+=n*h)>>>16,u&=65535,l+=(u+=i*s)>>>16,u&=65535,l+=(u+=r*a)>>>16,l+=e*h+n*s+i*a+r*o,oi((c&=65535)<<16|(t&=65535),(l&=65535)<<16|(u&=65535),this.unsigned)},Ei.mul=Ei.multiply,Ei.divide=function(t){if((t=!ti(t)?hi(t):t).isZero())throw Error("division by zero");var e,n,i;if(Jn)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?oi((this.unsigned?Jn.div_u:Jn.div_s)(this.low,this.high,t.low,t.high),Jn.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?pi:di;if(this.unsigned){if((t=!t.unsigned?t.toUnsigned():t).gt(this))return pi;if(t.gt(this.shru(1)))return _i;n=pi}else{if(this.eq(Si))return t.eq(gi)||t.eq(yi)?Si:t.eq(Si)?gi:(i=this.shr(1).div(t).shl(1)).eq(di)?t.isNegative()?gi:yi:(e=this.sub(t.mul(i)),n=i.add(e.div(t)));else if(t.eq(Si))return this.unsigned?pi:di;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();n=di}for(e=this;e.gte(t);){i=Math.max(1,Math.floor(e.toNumber()/t.toNumber()));for(var r=Math.ceil(Math.log(i)/Math.LN2),o=r<=48?1:ai(2,r-48),a=ri(i),s=a.mul(t);s.isNegative()||s.gt(e);)s=(a=ri(i-=o,this.unsigned)).mul(t);a.isZero()&&(a=gi),n=n.add(a),e=e.sub(s)}return n},Ei.div=Ei.divide,Ei.modulo=function(t){return ti(t)||(t=hi(t)),Jn?oi((this.unsigned?Jn.rem_u:Jn.rem_s)(this.low,this.high,t.low,t.high),Jn.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},Ei.mod=Ei.modulo,Ei.rem=Ei.modulo,Ei.not=function(){return oi(~this.low,~this.high,this.unsigned)},Ei.and=function(t){return ti(t)||(t=hi(t)),oi(this.low&t.low,this.high&t.high,this.unsigned)},Ei.or=function(t){return ti(t)||(t=hi(t)),oi(this.low|t.low,this.high|t.high,this.unsigned)},Ei.xor=function(t){return ti(t)||(t=hi(t)),oi(this.low^t.low,this.high^t.high,this.unsigned)},Ei.shiftLeft=function(t){return ti(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?oi(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):oi(0,this.low<<t-32,this.unsigned)},Ei.shl=Ei.shiftLeft,Ei.shiftRight=function(t){return ti(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?oi(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):oi(this.high>>t-32,0<=this.high?0:-1,this.unsigned)},Ei.shr=Ei.shiftRight,Ei.shiftRightUnsigned=function(t){if(ti(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?oi(this.low>>>t|e<<32-t,e>>>t,this.unsigned):oi(32===t?e:e>>>t-32,0,this.unsigned)},Ei.shru=Ei.shiftRightUnsigned,Ei.shr_u=Ei.shiftRightUnsigned,Ei.toSigned=function(){return this.unsigned?oi(this.low,this.high,!1):this},Ei.toUnsigned=function(){return this.unsigned?this:oi(this.low,this.high,!0)},Ei.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},Ei.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},Ei.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},Qn.fromBytes=function(t,e,n){return n?Qn.fromBytesLE(t,e):Qn.fromBytesBE(t,e)},Qn.fromBytesLE=function(t,e){return new Qn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Qn.fromBytesBE=function(t,e){return new Qn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};var wi=C(function(t,e){var n=O&&O.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(Xn);i.default.prototype.to4BytesLE=function(){return this.toBytesLE().slice(0,4)},i.default.prototype.to4BytesBE=function(){return this.toBytesBE().slice(0,4)},i.default.prototype.to2BytesLE=function(){return this.toBytesLE().slice(0,2)},i.default.prototype.to2BytesBE=function(){return this.toBytesBE().slice(0,2)};var r=i.default.fromBytesLE;i.default.fromBytesLE=function(t,e){var n=t.length;if(8===n)return r(t,e);if(4===n)return new i.default(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,0,e);if(2===n)return new i.default(t[0]|t[1]<<8,0,e);throw new Error("Unsupported bytes length: "+n)}}),bi=C(function(t,o){var n=O&&O.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};o.__esModule=!0,o.fromCodePoint=o.codePointFullWidth=o.codePoints=o.codePointAt=void 0,o.codePointAt=function(t,e){if(void 0===e&&(e=0),null==t)throw TypeError();var n=(t=String(t)).length,i=e?Number(e):0;if(!((i=Number.isNaN(i)?0:i)<0||n<=i)){e=t.charCodeAt(i);if(55296<=e&&e<=56319&&i+1<n){i=t.charCodeAt(i+1);if(56320<=i&&i<=57343)return 1024*(e-55296)+i-56320+65536}return e}},o.codePoints=function(t,e){if(e=a({unique:!1},e),"string"!=typeof t)throw new TypeError("Argument str must be type of string.");for(var n=[],i=0;i<t.length;){var r=t.charAt(i)+t.charAt(i+1),r=Number(o.codePointAt(r));if(Number.isNaN(r))throw new Error("An error occured getting code points. Unable to get code point at positions: "+i+" and "+(i+1));i+=65535<r?2:1,e.unique&&-1!==n.indexOf(r)||n.push(r)}return n};var e,i,a=function(t,e){return null==e||"function"==typeof e?t:("boolean"==typeof e&&((t=n({},t)).unique=e,e=t),void 0===e.unique&&(e.unique=!1),e)};o.codePointFullWidth=function(t){return!Number.isNaN(t)&&(4352<=t&&(t<=4447||9001===t||9002===t||11904<=t&&t<=12871&&12351!==t||12880<=t&&t<=19903||19968<=t&&t<=42182||43360<=t&&t<=43388||44032<=t&&t<=55203||63744<=t&&t<=64255||65040<=t&&t<=65049||65072<=t&&t<=65131||65281<=t&&t<=65376||65504<=t&&t<=65510||110592<=t&&t<=110593||127488<=t&&t<=127569||131072<=t&&t<=262141))},o.fromCodePoint=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],i="",r=0,o=t.length;r!==o;++r){var a=+t[r];if(!(a<1114111&&a>>>0===a))throw new RangeError("Invalid code point: "+a);16383<=(a<=65535?n.push(a):(a-=65536,n.push(55296+(a>>10),a%1024+56320)))&&(i+=String.fromCharCode.apply(null,n),n.length=0)}return i+String.fromCharCode.apply(null,n)},String.prototype.codePointAt||(i=function(t){if(null==this)throw TypeError();var e=String(this);return o.codePointAt(e,t)},(e=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(t){}return n}())?e(String.prototype,"codePointAt",{value:i,configurable:!0,writable:!0}):String.prototype.codePointAt=i),String.fromCodePoint||((i=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(t){}return n}())?i(String,"fromCodePoint",{value:o.fromCodePoint,configurable:!0,writable:!0}):String.fromCodePoint=o.fromCodePoint)}),Ti=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e},o=O&&O.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.removeTrailingZeros=e.toUTF16WithNoTrailingZeros=e.addTrailingZeros=e.toUTF16Bytes=e.toUTF16String=e.initializedWidth=e.equal=e.isEndOfChain=e.isFreeSectOrNoStream=e.fill=e.DIFF_BETWEEN_EPOCHS_1970_1601=e.MAX_POSSIBLE_POSITION=e.ENDOFCHAIN_MARK_INT=e.ENDOFCHAIN_MARK=e.FATSECT_MARK_INT=e.FATSECT_MARK=e.DISECT_MARK_INT=e.DISECT_MARK=e.FREESECT_MARK_OR_NOSTREAM_INT=e.FREESECT_MARK_OR_NOSTREAM=void 0;var a=n(Xn);function s(t,e){if(t.length!==e.length)return!1;for(var n=0;n!==t.length;n++)if(t[n]!==e[n])return!1;return!0}function h(t){for(var e=[],n=0;n<t.length;n+=2)e.push(bi.fromCodePoint(a.fromBytesLE([t[n],t[n+1]]).toNumber()));return e.join("")}function l(t){for(var e=t.length,n=t.length-1;0<n&&(0===t[n]&&0===t[n-1]);n-=2)e=n-1;return t.slice(0,e)}e.FREESECT_MARK_OR_NOSTREAM=[255,255,255,255],e.FREESECT_MARK_OR_NOSTREAM_INT=a.fromBytesLE(e.FREESECT_MARK_OR_NOSTREAM).toNumber(),e.DISECT_MARK=[252,255,255,255],e.DISECT_MARK_INT=a.fromBytesLE(e.DISECT_MARK).toNumber(),e.FATSECT_MARK=[253,255,255,255],e.FATSECT_MARK_INT=a.fromBytesLE(e.FATSECT_MARK).toNumber(),e.ENDOFCHAIN_MARK=[254,255,255,255],e.ENDOFCHAIN_MARK_INT=a.fromBytesLE(e.ENDOFCHAIN_MARK).toNumber(),e.MAX_POSSIBLE_POSITION=[250,255,255,255],e.DIFF_BETWEEN_EPOCHS_1970_1601=0xa9730b667fc,e.fill=function(t,e){if(t.length%e.length!=0)throw new Error;for(var n=e.length,i=0;i<t.length;i+=n)t.splice.apply(t,o([i,4],e))},e.isFreeSectOrNoStream=function(t){return t instanceof Array?s(e.FREESECT_MARK_OR_NOSTREAM,t):t===e.FREESECT_MARK_OR_NOSTREAM_INT},e.isEndOfChain=function(t){return t instanceof Array?s(e.ENDOFCHAIN_MARK,t):t===e.ENDOFCHAIN_MARK_INT},e.equal=s,e.initializedWidth=function(t,e){var n=new Array(t);if(e instanceof Array)for(var i=0;i<t;i+=e.length)n.splice.apply(n,o([i,e.length],e));else n.fill(e);return n},e.toUTF16String=h,e.toUTF16Bytes=function(t){for(var e=[],n=0;n<t.length;n++){var i=a.fromValue(bi.codePointAt(t,n)).to2BytesLE();if(2!==i.length)throw new Error("Each character in UTF-16 encoding should be presented with 2 bytes");e.push.apply(e,i)}return e},e.addTrailingZeros=function(t,e){for(var n=t.slice(0,t.length),i=t.length;i<e;i++)n[i]=0;return n},e.toUTF16WithNoTrailingZeros=function(t){return h(l(t))},e.removeTrailingZeros=l}),Ai=C(function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.TreeNode=e.Color=void 0,(i=n=e.Color||(e.Color={}))[i.RED=0]="RED",i[i.BLACK=1]="BLACK";var i=(r.prototype.getLeftChild=function(){return this.leftChild},r.prototype.setLeftChild=function(t){this.leftChild=t,null!=this.leftChild&&this.leftChild.setParent(this)},r.prototype.getValue=function(){return this.value},r.prototype.setRightChild=function(t){this.rightChild=t,null!=this.rightChild&&this.rightChild.setParent(this)},r.prototype.getRightChild=function(){return this.rightChild},r.prototype.getParent=function(){return this.parent},r.prototype.setParent=function(t){this.parent=t},r.prototype.hasChildren=function(){return null!=this.leftChild||null!=this.rightChild},r.prototype.hasTwoChildren=function(){return null!=this.leftChild&&null!=this.rightChild},r.prototype.isLeftChild=function(t){return this.leftChild===t},r.prototype.isRightChild=function(t){return this.rightChild===t},r.prototype.deleteChild=function(t){t===this.leftChild?this.leftChild=null:t===this.rightChild&&(this.rightChild=null)},r.prototype.substituteNode=function(t,e){t===this.rightChild?(this.rightChild=e,this.rightChild.setParent(this)):t===this.leftChild&&(this.leftChild=e,this.leftChild.setParent(this))},r.prototype.getChildrenRecursive=function(){var t=[];return null!=this.leftChild&&(t.push.apply(t,this.leftChild.getChildrenRecursive()),t.push(this.leftChild)),null!=this.rightChild&&(t.push.apply(t,this.rightChild.getChildrenRecursive()),t.push(this.rightChild)),t},r.prototype.getColor=function(){return this.color},r.prototype.setColor=function(t){this.color=t},r.prototype.invertColor=function(){this.color=this.color===n.BLACK?n.RED:n.BLACK},r.prototype.uncle=function(){var t=this.getParent(),e=this.getParent().getParent();return null!=t&&null!=e?e.isLeftChild(t)?e.getRightChild():e.getLeftChild():null},r.prototype.grandParent=function(){var t=null;return t=null!=this.getParent()?this.getParent().getParent():t},r.prototype.sibling=function(){return null==this.getParent()?null:this.getParent().isLeftChild(this)?this.getParent().getRightChild():this.getParent().getLeftChild()},r);function r(t,e){if(this.leftChild=null,this.rightChild=null,this.parent=null,this.color=e,null==t)throw new Error("Null values are not allowed");this.value=t}e.TreeNode=i}),Oi=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.DirectoryEntry=e.toColorFlag=e.toNodeColor=e.ObjectType=e.ColorFlag=void 0;var o,s=n(Xn);(n=o=e.ColorFlag||(e.ColorFlag={}))[n.RED=0]="RED",n[n.BLACK=1]="BLACK",(n=e.ObjectType||(e.ObjectType={}))[n.Storage=1]="Storage",n[n.Stream=2]="Stream",n[n.RootStorage=5]="RootStorage",n[n.Unknown=0]="Unknown",e.toNodeColor=function(t){return t===o.BLACK?Ai.Color.BLACK:Ai.Color.RED},e.toColorFlag=function(t){return t===Ai.Color.BLACK?o.BLACK:o.RED};h.prototype.getView=function(){return this.view},h.prototype.compareTo=function(t){var e=this.getDirectoryEntryName().length-t.getDirectoryEntryName().length;return 0==e?this.getDirectoryEntryName().toUpperCase()>t.getDirectoryEntryName().toUpperCase()?1:this.getDirectoryEntryName().toUpperCase()<t.getDirectoryEntryName().toUpperCase()?-1:0:e},h.prototype.setRightSibling=function(t){null==t?this.view.subView(h.FLAG_POSITION.RIGHT_SIBLING,h.FLAG_POSITION.RIGHT_SIBLING+4).writeAt(0,Ti.FREESECT_MARK_OR_NOSTREAM):this.view.subView(h.FLAG_POSITION.RIGHT_SIBLING,h.FLAG_POSITION.RIGHT_SIBLING+4).writeAt(0,s.fromValue(t.getId()).to4BytesLE())},h.setRightSibling=function(t,e){t.subView(h.FLAG_POSITION.RIGHT_SIBLING,h.FLAG_POSITION.RIGHT_SIBLING+4).writeAt(0,s.fromValue(e).to4BytesLE())},h.prototype.setLeftSibling=function(t){null==t?this.view.subView(h.FLAG_POSITION.LEFT_SIBLING,h.FLAG_POSITION.LEFT_SIBLING+4).writeAt(0,Ti.FREESECT_MARK_OR_NOSTREAM):this.view.subView(h.FLAG_POSITION.LEFT_SIBLING,h.FLAG_POSITION.LEFT_SIBLING+4).writeAt(0,s.fromValue(t.getId()).to4BytesLE())},h.setLeftSibling=function(t,e){t.subView(h.FLAG_POSITION.LEFT_SIBLING,h.FLAG_POSITION.LEFT_SIBLING+4).writeAt(0,s.fromValue(e).to4BytesLE())},h.prototype.setDirectoryEntryName=function(t){if(!t)throw new Error("Directory Entry name should be non-null and non-empty string");if(t.length>h.ENTRY_NAME_MAXIMUM_LENGTH_UTF16_STRING)throw new Error("Directory Entry name may contain 31 UTF-16 at most + NULL terminated character");this.view.subView(h.FLAG_POSITION.DIRECTORY_ENTRY_NAME,h.FLAG_POSITION.DIRECTORY_ENTRY_NAME+h.ENTRY_NAME_MAXIMUM_LENGTH).writeAt(0,Ti.addTrailingZeros(Ti.toUTF16Bytes(t),h.ENTRY_NAME_MAXIMUM_LENGTH));t=t.length;this.view.subView(h.FLAG_POSITION.DIRECTORY_ENTRY_NAME_LENGTH,h.FLAG_POSITION.DIRECTORY_ENTRY_NAME_LENGTH+2).writeAt(0,s.fromValue(2*t+2).to2BytesLE())},h.prototype.getId=function(){return this.id},h.prototype.getDirectoryEntryName=function(){return Ti.toUTF16WithNoTrailingZeros(this.view.subView(h.FLAG_POSITION.DIRECTORY_ENTRY_NAME,h.FLAG_POSITION.DIRECTORY_ENTRY_NAME+h.ENTRY_NAME_MAXIMUM_LENGTH).getData())},h.prototype.getDirectoryEntryNameLength=function(){return s.fromBytesLE(this.view.subView(h.FLAG_POSITION.DIRECTORY_ENTRY_NAME_LENGTH,h.FLAG_POSITION.DIRECTORY_ENTRY_NAME_LENGTH+2).getData()).toNumber()},h.prototype.getDirectoryEntryNameLengthUTF8=function(){return(this.getDirectoryEntryNameLength()-2)/2},h.prototype.getChild=function(){var t=this.getChildPosition();return Ti.isFreeSectOrNoStream(t)?null:this.directoryEntryChain.getEntryById(t)},h.prototype.getChildPosition=function(){return h.getChildPosition(this.view)},h.getChildPosition=function(t){return s.fromBytesLE(t.subView(h.FLAG_POSITION.CHILD,h.FLAG_POSITION.CHILD+4).getData()).toNumber()},h.prototype.setObjectType=function(t){this.objectType=t,this.view.subView(h.FLAG_POSITION.OBJECT_TYPE,h.FLAG_POSITION.OBJECT_TYPE+1).writeAt(0,[t])},h.prototype.getLeftSibling=function(){var t=this.getLeftSiblingPosition();return Ti.isFreeSectOrNoStream(t)||Ti.isEndOfChain(t)?null:this.directoryEntryChain.getEntryById(t)},h.prototype.getLeftSiblingPosition=function(){return h.getLeftSiblingPosition(this.view)},h.getLeftSiblingPosition=function(t){return s.fromBytesLE(t.subView(h.FLAG_POSITION.LEFT_SIBLING,h.FLAG_POSITION.LEFT_SIBLING+4).getData()).toNumber()},h.prototype.getRightSibling=function(){var t=this.getRightSiblingPosition();return Ti.isFreeSectOrNoStream(t)?null:this.directoryEntryChain.getEntryById(t)},h.prototype.getRightSiblingPosition=function(){return h.getRightSiblingPosition(this.view)},h.getRightSiblingPosition=function(t){return s.fromBytesLE(t.subView(h.FLAG_POSITION.RIGHT_SIBLING,h.FLAG_POSITION.RIGHT_SIBLING+4).getData()).toNumber()},h.prototype.getStreamStartingSector=function(){return s.fromBytesLE(this.view.subView(h.FLAG_POSITION.STARTING_SECTOR_LOCATION,h.FLAG_POSITION.STARTING_SECTOR_LOCATION+4).getData()).toNumber()},h.prototype.setStreamStartingSector=function(t){this.view.subView(h.FLAG_POSITION.STARTING_SECTOR_LOCATION,h.FLAG_POSITION.STARTING_SECTOR_LOCATION+4).writeAt(0,s.fromValue(t).to4BytesLE())},h.prototype.traverse=function(t){var e;t(this),null!==(e=this.getLeftSibling())&&void 0!==e&&e.traverse(t),null!==(e=this.getRightSibling())&&void 0!==e&&e.traverse(t),null!==(e=this.getChild())&&void 0!==e&&e.traverse(t)},h.prototype.getObjectType=function(){return this.objectType},h.prototype.getColorFlag=function(){return this.colorFlag},h.prototype.setColorFlag=function(t){this.colorFlag=t,this.view.subView(h.FLAG_POSITION.COLOR_FLAG,h.FLAG_POSITION.COLOR_FLAG+1).writeAt(0,[t])},h.prototype.invertColor=function(){this.colorFlag===o.BLACK?this.setColorFlag(o.RED):this.setColorFlag(o.BLACK)},h.prototype.setCLSID=function(t){this.view.subView(h.FLAG_POSITION.CLSID,h.FLAG_POSITION.CLSID+16).writeAt(0,t)},h.prototype.setStateBits=function(t){this.view.subView(h.FLAG_POSITION.STATE_BITS,h.FLAG_POSITION.STATE_BITS+4).writeAt(0,t)},h.prototype.setCreationTime=function(t){this.view.subView(h.FLAG_POSITION.CREATION_TIME,h.FLAG_POSITION.CREATION_TIME+8).writeAt(0,t)},h.prototype.setModifiedTime=function(t){this.view.subView(h.FLAG_POSITION.MODIFY_TIME,h.FLAG_POSITION.MODIFY_TIME+8).writeAt(0,t)},h.prototype.getCLSID=function(){return this.view.subView(h.FLAG_POSITION.CLSID,h.FLAG_POSITION.CLSID+16).getData()},h.prototype.getStateBits=function(){return this.view.subView(h.FLAG_POSITION.STATE_BITS,h.FLAG_POSITION.STATE_BITS+4).getData()},h.prototype.getCreationTime=function(){return this.view.subView(h.FLAG_POSITION.CREATION_TIME,h.FLAG_POSITION.CREATION_TIME+8).getData()},h.prototype.getModifiedTime=function(){return this.view.subView(h.FLAG_POSITION.MODIFY_TIME,h.FLAG_POSITION.MODIFY_TIME+8).getData()},h.ENTRY_LENGTH=128,h.ENTRY_NAME_MAXIMUM_LENGTH_UTF16_STRING=31,h.ENTRY_NAME_MAXIMUM_LENGTH=64,h.FLAG_POSITION={DIRECTORY_ENTRY_NAME:0,DIRECTORY_ENTRY_NAME_LENGTH:64,OBJECT_TYPE:66,COLOR_FLAG:67,LEFT_SIBLING:68,RIGHT_SIBLING:72,CHILD:76,CLSID:80,STATE_BITS:96,CREATION_TIME:100,MODIFY_TIME:108,STARTING_SECTOR_LOCATION:116,STREAM_SIZE:120},n=h;function h(t,e,n,i,r,o){if(this.id=t,this.directoryEntryChain=e,this.view=n,null==i){if(n.getSize()!==h.ENTRY_LENGTH)throw new Error;if((a=s.fromBytesLE(n.subView(h.FLAG_POSITION.DIRECTORY_ENTRY_NAME_LENGTH,h.FLAG_POSITION.DIRECTORY_ENTRY_NAME_LENGTH+2).getData()).toNumber())<0||h.ENTRY_NAME_MAXIMUM_LENGTH<a)throw new Error;this.objectType=n.subView(h.FLAG_POSITION.OBJECT_TYPE,h.FLAG_POSITION.OBJECT_TYPE+1).getData()[0],this.colorFlag=n.subView(h.FLAG_POSITION.COLOR_FLAG,h.FLAG_POSITION.COLOR_FLAG+1).getData()[0],this.setStateBits(Ti.initializedWidth(4,0)),this.setCLSID(Ti.initializedWidth(16,0)),this.setModifiedTime(Ti.initializedWidth(8,0)),this.setCreationTime(Ti.initializedWidth(8,0))}else{var a;if(this.setObjectType(o),this.setColorFlag(r),(a=2*i.length+2)<0||h.ENTRY_NAME_MAXIMUM_LENGTH<a)throw new Error;this.setDirectoryEntryName(i),this.setLeftSibling(null),this.setRightSibling(null),n.subView(h.FLAG_POSITION.STREAM_SIZE,h.FLAG_POSITION.STREAM_SIZE+8).writeAt(0,s.fromValue(0).toBytesLE()),this.setStreamStartingSector(Ti.ENDOFCHAIN_MARK_INT)}}e.DirectoryEntry=n}),Ci=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),o=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StreamDirectoryEntry=void 0;var s,h=a(Xn),n=(s=Oi.DirectoryEntry,n(l,s),l.prototype.getStreamData=function(){return this.hasStreamData()&&0<this.getStreamSize()?this.streamHolder.getStreamData(this.getStreamStartingSector(),this.getStreamSize()):[]},l.prototype.setStreamData=function(t){this.setStreamStartingSector(this.streamHolder.setStreamData(t)),this.setStreamSize(t.length)},l.prototype.read=function(t,e){return this.streamHolder.read(this.getStreamStartingSector(),this.getStreamSize(),t,e)},l.prototype.writeAt=function(t,e){if(t<0)throw new Error("Starting position should be greater than 0: start = "+t);if(t+e.length>this.getStreamSize())throw new Error("Cannot write beyond the end of the stream: start = "+t+", end = "+(t+e.length));this.streamHolder.writeAt(this.getStreamStartingSector(),this.getStreamSize(),t,e)},l.prototype.append=function(t){var e=this.streamHolder.append(this.getStreamStartingSector(),this.getStreamSize(),t);this.setStreamStartingSector(e),this.setStreamSize(this.getStreamSize()+t.length)},l.prototype.setStreamSize=function(t){this.view.subView(Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE,Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE+4).writeAt(0,h.fromValue(t).to4BytesLE())},l.prototype.getStreamSize=function(){return h.fromBytesLE(this.view.subView(Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE,Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE+4).getData()).toNumber()},l.prototype.hasStreamData=function(){return this.getObjectType()===Oi.ObjectType.Stream&&!Ti.isEndOfChain(this.getStreamStartingSector())},l);function l(t,e,n,i,r,o,a){void 0===a&&(a=Oi.ObjectType.Stream);a=s.call(this,t,e,i,r,o,a)||this;return a.streamHolder=n,a}e.StreamDirectoryEntry=n}),Ii=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.UpdateHandler=void 0;var n=(i.prototype.rightRotate=function(t,e){var n,i=t.getParent();null==i?(t.setLeftChild(e.getRightChild()),e.setRightChild(t),this.tree.setRoot(e)):(n=i.isLeftChild(t),t.setLeftChild(e.getRightChild()),e.setRightChild(t),n?i.setLeftChild(e):i.setRightChild(e)),this.swapColor(t,e)},i.prototype.leftRotate=function(t,e){var n,i=t.getParent();null==i?(t.setRightChild(e.getLeftChild()),e.setLeftChild(t),this.tree.setRoot(e)):(n=i.isLeftChild(t),t.setRightChild(e.getLeftChild()),e.setLeftChild(t),n?i.setLeftChild(e):i.setRightChild(e)),this.swapColor(t,e)},i.prototype.swapColor=function(t,e){var n=t.getColor();t.setColor(e.getColor()),e.setColor(n)},i);function i(t){this.tree=t}e.UpdateHandler=n}),Ri=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.InsertHandler=void 0;var r,n=(r=Ii.UpdateHandler,n(o,r),o.prototype.insert=function(t){t=this.simpleInsert(t);return this.tree.isRoot(t)||this.tree.isRoot(t.getParent())||this.recolorAndRotateIfNeeded(t),t},o.prototype.simpleInsert=function(t){if(this.tree.hasRoot()){for(var e=this.tree.getRoot();null!=e;){if(0===this.comparator(e.getValue(),t))throw new Error("Equal values are not supported: "+t);if(this.comparator(t,e.getValue())<0){if(null==e.getLeftChild()){n=this.nodeFactory.create(t,Ai.Color.RED);return e.setLeftChild(n),n}e=e.getLeftChild()}else{if(null==e.getRightChild()){n=this.nodeFactory.create(t,Ai.Color.RED);return e.setRightChild(n),n}e=e.getRightChild()}}throw new Error("Unexpected behaviour -- cannot find node location in the tree")}var n=this.nodeFactory.create(t,Ai.Color.BLACK);return this.tree.setRoot(n),n},o.prototype.recolorAndRotateIfNeeded=function(t){for(var e=t;null!=e&&e.getColor()===Ai.Color.RED&&null!=e.getParent()&&e.getParent().getColor()===Ai.Color.RED;){e.getParent();var n=e.uncle();switch(null==n?Ai.Color.BLACK:n.getColor()){case Ai.Color.BLACK:this.rotateAndRecolorIfBlackScenario(e);break;case Ai.Color.RED:this.recolorIfRedScenario(e);break;default:throw new Error("Should not pass here")}e=e.grandParent()}},o.prototype.rotateSubtree=function(t,e,n){t.isLeftChild(e)&&e.isLeftChild(n)?this.rightRotate(t,e):t.isLeftChild(e)&&e.isRightChild(n)?(this.leftRotate(e,n),this.rightRotate(t,n),n.setColor(Ai.Color.BLACK),t.setColor(Ai.Color.RED)):t.isRightChild(e)&&e.isRightChild(n)?this.leftRotate(t,e):(this.rightRotate(e,n),this.leftRotate(t,n),n.setColor(Ai.Color.BLACK),t.setColor(Ai.Color.RED))},o.prototype.recolorAfterRotate=function(t){t.setColor(Ai.Color.BLACK);var e=t.getLeftChild();null!=e&&e.setColor(Ai.Color.RED);t=t.getRightChild();null!=t&&t.setColor(Ai.Color.RED)},o.prototype.recolorIfRedScenario=function(t){var e=t.uncle();null!=e&&e.setColor(Ai.Color.BLACK);e=t.getParent();null!=e&&e.setColor(Ai.Color.BLACK);t=t.grandParent();null!=t&&(this.tree.isRoot(t)?t.setColor(Ai.Color.BLACK):t.setColor(Ai.Color.RED))},o.prototype.rotateAndRecolorIfBlackScenario=function(t){var e=t.getParent(),n=t.grandParent();this.rotateSubtree(n,e,t)},o);function o(t,e,n){t=r.call(this,t)||this;return t.nodeFactory=e,t.comparator=n,t}e.InsertHandler=n}),Ni=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteHandler=void 0;var r,n=(r=Ii.UpdateHandler,n(o,r),o.prototype.delete=function(t){var e,n;t.hasChildren()?t.hasTwoChildren()?(e=this.inOrderPredecessor(t),this.swap(t,e),this.delete(t)):(e=void 0,e=null==t.getRightChild()?t.getLeftChild():t.getRightChild(),this.tree.isRoot(t)?(this.tree.setRoot(e),e.setColor(Ai.Color.BLACK)):e.getColor()===Ai.Color.RED||t.getColor()===Ai.Color.RED?(t.getParent().substituteNode(t,e),e.setColor(Ai.Color.BLACK)):(n=t.sibling(),t.getParent().substituteNode(t,e),this.recover(n))):this.tree.isRoot(t)?this.tree.setRoot(null):t.getColor()===Ai.Color.BLACK?(n=t.sibling(),t.getParent().deleteChild(t),this.recover(n)):t.getParent().deleteChild(t)},o.prototype.inOrderPredecessor=function(t){var n=this;if(null==t.getLeftChild())return null;var e=t.getLeftChild().getChildrenRecursive();return e.push(t.getLeftChild()),e.sort(function(t,e){return n.comparator(t.getValue(),e.getValue())}),e[e.length-1]},o.prototype.recover=function(t){var e,n=t.getColor(),i=t.getLeftChild(),r=t.getRightChild(),o=null==i?Ai.Color.BLACK:i.getColor(),a=null==r?Ai.Color.BLACK:r.getColor(),s=t.getParent().isLeftChild(t);n===Ai.Color.BLACK?o===Ai.Color.RED||a===Ai.Color.RED?t.getParent().isLeftChild(t)?o===Ai.Color.RED?(this.rightRotate(t.getParent(),t),i.setColor(Ai.Color.BLACK)):(this.leftRotate(t,t.getRightChild()),this.rightRotate(t.grandParent(),t.getParent()),t.setColor(Ai.Color.BLACK)):a===Ai.Color.RED?(this.leftRotate(t.getParent(),t),r.setColor(Ai.Color.BLACK)):(this.rightRotate(t,t.getLeftChild()),this.leftRotate(t.grandParent(),t.getParent()),t.setColor(Ai.Color.BLACK)):(t.setColor(Ai.Color.RED),(e=t.getParent()).getColor()!==Ai.Color.BLACK||this.tree.isRoot(e)?e.setColor(Ai.Color.BLACK):this.recover(e.sibling())):(r=t.getParent(),e=void 0,t.setColor(Ai.Color.BLACK),r.setColor(Ai.Color.RED),s?(e=t.getRightChild(),this.rightRotate(t.getParent(),t)):(e=t.getLeftChild(),this.leftRotate(t.getParent(),t)),this.recover(e))},o.prototype.swap=function(t,e){var n,i,r,o,a,s,h,l;t.getParent()===e?this.swapChildParent(e,t):e.getParent()===t?this.swapChildParent(t,e):(n=t.getParent(),i=t.getLeftChild(),r=t.getRightChild(),o=e.getParent(),a=e.getLeftChild(),s=e.getRightChild(),h=t.getColor(),l=e.getColor(),t.setLeftChild(a),t.setRightChild(s),e.setLeftChild(i),e.setRightChild(r),t.setColor(l),e.setColor(h),null==n?this.tree.setRoot(e):n.substituteNode(t,e),null==o?this.tree.setRoot(t):o.substituteNode(e,t))},o.prototype.swapChildParent=function(t,e){var n,i=t.getColor(),r=e.getColor(),o=e.getLeftChild(),a=e.getRightChild(),s=t.getParent();null==s?this.tree.setRoot(e):s.isLeftChild(t)?s.setLeftChild(e):s.setRightChild(e),t.isLeftChild(e)?(n=t.getRightChild(),e.setLeftChild(t),e.setRightChild(n)):(n=t.getLeftChild(),e.setRightChild(t),e.setLeftChild(n)),e.setColor(i),t.setLeftChild(o),t.setRightChild(a),t.setColor(r)},o);function o(t,e){t=r.call(this,t)||this;return t.comparator=e,t}e.DeleteHandler=n}),Pi=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RedBlackTree=void 0;var n=(i.prototype.delete=function(t){this.deleteHandler.delete(t)},i.prototype.insert=function(t){return this.insertHandler.insert(t)},i.prototype.findNode=function(t){if(null==this.root)return null;for(var e=this.root;null!=e;){if(0===this.comparator(e.getValue(),t))return e;e=0<this.comparator(t,e.getValue())?e.getRightChild():e.getLeftChild()}return null},i.prototype.getRoot=function(){return this.root},i.prototype.hasRoot=function(){return null!=this.root},i.prototype.isRoot=function(t){return this.root===t},i.prototype.setRoot=function(t){this.root=t,null!=this.root&&this.root.setParent(null)},i);function i(t,e){this.root=null,this.insertHandler=new Ri.InsertHandler(this,t,e),this.deleteHandler=new Ni.DeleteHandler(this,e),this.comparator=e}e.RedBlackTree=n}),Li=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DirectoryEntryNode=void 0;var r,n=(r=Ai.TreeNode,n(o,r),o.prototype.getLeftChild=function(){var t,e=r.prototype.getLeftChild.call(this);return null==e&&null!=this.getValue().getLeftSibling()&&(e=new o(t=this.getValue().getLeftSibling(),Oi.toNodeColor(t.getColorFlag())),r.prototype.setLeftChild.call(this,e)),null!=e&&null==e.getParent()&&e.setParent(this),e},o.prototype.getRightChild=function(){var t,e=r.prototype.getRightChild.call(this);return null==e&&null!=this.getValue().getRightSibling()&&(e=new o(t=this.getValue().getRightSibling(),Oi.toNodeColor(t.getColorFlag())),r.prototype.setRightChild.call(this,e)),null!=e&&null==e.getParent()&&e.setParent(this),e},o.prototype.setLeftChild=function(t){r.prototype.setLeftChild.call(this,t),this.getValue().setLeftSibling(null==t?null:t.getValue())},o.prototype.setRightChild=function(t){r.prototype.setRightChild.call(this,t),this.getValue().setRightSibling(null==t?null:t.getValue())},o.prototype.deleteChild=function(t){this.isLeftChild(t)?this.getValue().setLeftSibling(null):this.isRightChild(t)&&this.getValue().setRightSibling(null),r.prototype.deleteChild.call(this,t)},o.prototype.substituteNode=function(t,e){this.isRightChild(t)?this.getValue().setRightSibling(e.getValue()):this.isLeftChild(t)&&this.getValue().setLeftSibling(e.getValue()),r.prototype.substituteNode.call(this,t,e)},o.prototype.setColor=function(t){r.prototype.setColor.call(this,t),this.getValue().setColorFlag(Oi.toColorFlag(t))},o.prototype.invertColor=function(){r.prototype.invertColor.call(this),this.getValue().invertColor()},o);function o(t,e){t=r.call(this,t,e)||this;return t.setColor(e),t}e.DirectoryEntryNode=n}),Mi=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),o=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StorageDirectoryEntry=void 0;var s,h=a(Xn),n=(s=Oi.DirectoryEntry,n(l,s),l.prototype.setChildDirectoryEntry=function(t){this.view.subView(Oi.DirectoryEntry.FLAG_POSITION.CHILD,Oi.DirectoryEntry.FLAG_POSITION.CHILD+4).writeAt(0,h.fromValue(t.getId()).to4BytesLE())},l.prototype.addChild=function(t){return this.tree.insert(t),this.setChildDirectoryEntry(this.tree.getRoot().getValue()),t},l.prototype.addStream=function(t,e){return this.addChild(this.directoryEntryChain.createStream(t,Oi.ColorFlag.RED,e))},l.prototype.addStorage=function(t){return this.addChild(this.directoryEntryChain.createStorage(t,Oi.ColorFlag.RED))},l.prototype.findChild=function(e){var n;return this.eachChild(function(t){e(t)&&(n=t)},e),n},l.prototype.findChildren=function(e){var n=[];return this.eachChild(function(t){e(t)&&n.push(t)},function(){return!1}),n},l.prototype.children=function(){var e=[];return this.eachChild(function(t){e.push(t)}),e},l.prototype.storages=function(){return this.children().filter(function(t){return t instanceof l}).map(function(t){return t})},l.prototype.streams=function(){return this.children().filter(function(t){return t instanceof Ci.StreamDirectoryEntry}).map(function(t){return t})},l.prototype.eachChild=function(t,e){null==e&&(e=function(){return!1});var n=[],i=this.tree.getRoot();if(null!=i)for(;null==i||-1!==n.indexOf(i.getValue().getId())||(n.push(i.getValue().getId()),t(i.getValue()),!e(i.getValue()));){var r=i.getLeftChild();if(null==r||-1!==n.indexOf(r.getValue().getId())){r=i.getRightChild();if(null==r||-1!==n.indexOf(r.getValue().getId())){if(null==i.getParent())break;i=i.getParent()}else i=i.getRightChild()}else i=i.getLeftChild()}},l.prototype.find=function(t){var e,n=[],i=this.tree.getRoot();if(null!=i){for(;;){if(null!=i&&-1===n.indexOf(i.getValue().getId())&&(n.push(i.getValue().getId()),i.getValue().getDirectoryEntryName()===t)){e=i.getValue();break}var r=i.getLeftChild();if(null==r||-1!==n.indexOf(r.getValue().getId())){r=i.getRightChild();if(null==r||-1!==n.indexOf(r.getValue().getId())){if(null==i.getParent())break;i=i.getParent()}else i=i.getRightChild()}else i=i.getLeftChild()}return e}},l.NODE_FACTORY={create:function(t,e){return new Li.DirectoryEntryNode(t,e)}},l);function l(t,e,n,i,r,o){void 0===o&&(o=Oi.ObjectType.Storage);r=s.call(this,t,e,n,i,r,o)||this;r.tree=new Pi.RedBlackTree(l.NODE_FACTORY,function(t,e){return t.compareTo(e)});o=r.getChild();return null!=o&&r.tree.setRoot(new Li.DirectoryEntryNode(o,Ai.Color.BLACK)),r}e.StorageDirectoryEntry=n}),Di=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.RootStorageDirectoryEntry=void 0;var a,n=(a=Mi.StorageDirectoryEntry,n(r,a),r.prototype.getChild=function(){if(this.getChildPosition()===r.ID)throw new Error("Root Entry child cannot have ID == 0");return a.prototype.getChild.call(this)},r.prototype.setRightSibling=function(t){if(null!=t)throw new Error("Root Storage cannot have siblings")},r.prototype.setLeftSibling=function(t){if(null!=t)throw new Error("Root Storage cannot have siblings")},r.prototype.setDirectoryEntryName=function(t){if("Root Entry"!==t)throw new Error("Name of Root Storage directory entry is always "+r.NAME);a.prototype.setDirectoryEntryName.call(this,t)},r.NAME="Root Entry",r.ID=0,r);function r(t,e,n,i,r,o){void 0===o&&(o=Oi.ObjectType.Storage);r=a.call(this,t,e,n,i,r,o)||this,o=r.getChild();return null!=o&&r.tree.setRoot(new Li.DirectoryEntryNode(o,Ai.Color.BLACK)),r}e.RootStorageDirectoryEntry=n}),Fi=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.DifatEntries=void 0;var o=n(Xn),n=(a.prototype.getDifatEntries=function(){return this.difatEntries},a.prototype.registerFatSector=function(t){if(this.difatEntries.length>=xi.Header.DIFAT_ENTRIES_LIMIT_IN_HEADER)throw new Error("Unable to register additional FAT sector in Header");this.view.writeAt(4*this.difatEntries.length,o.fromValue(t).to4BytesLE()),this.difatEntries.push(t)},a.prototype.isFull=function(){return this.difatEntries.length>=xi.Header.DIFAT_ENTRIES_LIMIT_IN_HEADER},a);function a(t){this.difatEntries=[],this.view=t;for(var e=0;e<this.view.getSize();e+=4){var n=this.view.subView(e,e+4).getData();if(Ti.isFreeSectOrNoStream(n))break;this.difatEntries.push(o.fromBytesLE(n).toNumber())}}e.DifatEntries=n}),xi=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=void 0;var o=n(Xn),n=(a.empty=function(t){return t.subView(a.FLAG_POSITION.SIGNATURE,a.FLAG_POSITION.SIGNATURE+8).writeAt(0,a.HEADER_SIGNATURE),t.subView(a.FLAG_POSITION.MINOR_VERSION,a.FLAG_POSITION.MINOR_VERSION+2).writeAt(0,a.MINOR_VERSION_3),t.subView(a.FLAG_POSITION.MAJOR_VERSION,a.FLAG_POSITION.MAJOR_VERSION+2).writeAt(0,a.MAJOR_VERSION_3),t.subView(a.FLAG_POSITION.BYTE_ORDER,a.FLAG_POSITION.BYTE_ORDER+2).writeAt(0,a.BYTE_ORDER_LITTLE_ENDIAN),t.subView(a.FLAG_POSITION.SECTOR_SHIFT,a.FLAG_POSITION.SECTOR_SHIFT+2).writeAt(0,a.SECTOR_SHIFT_VERSION_3),t.subView(a.FLAG_POSITION.MINI_SECTOR_SHIFT,a.FLAG_POSITION.MINI_SECTOR_SHIFT+2).writeAt(0,a.MINI_SECTOR_SHIFT_VERSION_3),t.subView(a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION,a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION+4).writeAt(0,a.MINI_STREAM_CUTOFF_SIZE),t.subView(a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION,a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION+4).writeAt(0,a.MINI_STREAM_CUTOFF_SIZE),t.subView(a.FLAG_POSITION.FIRST_DIFAT_SECTOR,a.FLAG_POSITION.FIRST_DIFAT_SECTOR+4).writeAt(0,Ti.ENDOFCHAIN_MARK),t.subView(a.FLAG_POSITION.FIRST_MINIFAT_SECTOR,a.FLAG_POSITION.FIRST_MINIFAT_SECTOR+4).writeAt(0,Ti.ENDOFCHAIN_MARK),t.subView(a.FLAG_POSITION.FIRST_DIRECTORY_SECTOR,a.FLAG_POSITION.FIRST_DIRECTORY_SECTOR+4).writeAt(0,Ti.ENDOFCHAIN_MARK),t.subView(a.FLAG_POSITION.DIFAT_ENTRIES_FIRST_POSITION,512).fill(Ti.FREESECT_MARK_OR_NOSTREAM),new a(t)},a.prototype.getFirstDirectorySectorLocation=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.FIRST_DIRECTORY_SECTOR,a.FLAG_POSITION.FIRST_DIRECTORY_SECTOR+4).getData()).toNumber()},a.prototype.getNumberOfFatSectors=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.NUMBER_OF_FAT_SECTORS,a.FLAG_POSITION.NUMBER_OF_FAT_SECTORS+4).getData()).toNumber()},a.prototype.getFirstMinifatSectorLocation=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.FIRST_MINIFAT_SECTOR,a.FLAG_POSITION.FIRST_MINIFAT_SECTOR+4).getData()).toNumber()},a.prototype.getFirstDifatSectorLocation=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.FIRST_DIFAT_SECTOR,a.FLAG_POSITION.FIRST_DIFAT_SECTOR+4).getData()).toNumber()},a.prototype.getNumberOfMiniFatSectors=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.NUMBER_OF_MINIFAT_SECTORS,a.FLAG_POSITION.NUMBER_OF_MINIFAT_SECTORS+4).getData()).toNumber()},a.prototype.getNumberOfDifatSectors=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.NUMBER_OF_DIFAT_SECTORS,a.FLAG_POSITION.NUMBER_OF_DIFAT_SECTORS+4).getData()).toNumber()},a.prototype.getDifatEntries=function(){return this.difatEntries.getDifatEntries()},a.prototype.canFitMoreDifatEntries=function(){return!this.difatEntries.isFull()},a.prototype.setNumberOfFatSectors=function(t){this.dataView.subView(a.FLAG_POSITION.NUMBER_OF_FAT_SECTORS,a.FLAG_POSITION.NUMBER_OF_FAT_SECTORS+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.setFirstDirectorySectorLocation=function(t){this.dataView.subView(a.FLAG_POSITION.FIRST_DIRECTORY_SECTOR,a.FLAG_POSITION.FIRST_DIRECTORY_SECTOR+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.setFirstMinifatSectorLocation=function(t){this.dataView.subView(a.FLAG_POSITION.FIRST_MINIFAT_SECTOR,a.FLAG_POSITION.FIRST_MINIFAT_SECTOR+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.setNumberOfMiniFatSectors=function(t){this.dataView.subView(a.FLAG_POSITION.NUMBER_OF_MINIFAT_SECTORS,a.FLAG_POSITION.NUMBER_OF_MINIFAT_SECTORS+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.setFirstDifatSectorLocation=function(t){this.dataView.subView(a.FLAG_POSITION.FIRST_DIFAT_SECTOR,a.FLAG_POSITION.FIRST_DIFAT_SECTOR+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.setNumberOfDifatSectors=function(t){this.dataView.subView(a.FLAG_POSITION.NUMBER_OF_DIFAT_SECTORS,a.FLAG_POSITION.NUMBER_OF_DIFAT_SECTORS+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.getSectorShift=function(){return Math.pow(2,o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.SECTOR_SHIFT,a.FLAG_POSITION.SECTOR_SHIFT+2).getData()).toNumber())},a.prototype.getMiniSectorShift=function(){return Math.pow(2,o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.MINI_SECTOR_SHIFT,a.FLAG_POSITION.MINI_SECTOR_SHIFT+2).getData()).toNumber())},a.prototype.getMiniStreamCutoffSize=function(){return o.fromBytesLE(this.dataView.subView(a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION,a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION+4).getData()).toNumber()},a.prototype.registerFatSector=function(t){this.difatEntries.registerFatSector(t)},a.FLAG_POSITION={SIGNATURE:0,CLSID:8,MINOR_VERSION:24,MAJOR_VERSION:26,BYTE_ORDER:28,SECTOR_SHIFT:30,MINI_SECTOR_SHIFT:32,MINI_STREAM_CUTOFF_SIZE_POSITION:56,FIRST_DIRECTORY_SECTOR:48,NUMBER_OF_FAT_SECTORS:44,FIRST_MINIFAT_SECTOR:60,NUMBER_OF_MINIFAT_SECTORS:64,FIRST_DIFAT_SECTOR:68,NUMBER_OF_DIFAT_SECTORS:72,DIFAT_ENTRIES_FIRST_POSITION:76},a.HEADER_SIGNATURE=[225,26,177,161,224,17,207,208].reverse(),a.MAJOR_VERSION_3=[3,0],a.MINOR_VERSION_3=[62,0],a.BYTE_ORDER_LITTLE_ENDIAN=[254,255],a.SECTOR_SHIFT_VERSION_3=[9,0],a.SECTOR_SHIFT_VERSION_3_INT=Math.pow(2,o.fromBytesLE(a.SECTOR_SHIFT_VERSION_3).toNumber()),a.MINI_SECTOR_SHIFT_VERSION_3=[6,0],a.MINI_SECTOR_SHIFT_VERSION_3_INT=Math.pow(2,o.fromBytesLE(a.MINI_SECTOR_SHIFT_VERSION_3).toNumber()),a.MINI_STREAM_CUTOFF_SIZE=o.fromValue(a.MINI_STREAM_CUTOFF_SIZE_INT=4096).to4BytesLE(),a.HEADER_LENGTH=512,a.DIFAT_ENTRIES_LIMIT_IN_HEADER=109,a);function a(t){if(t.getSize()!==a.HEADER_LENGTH)throw new Error("FileHeader must be "+a.HEADER_LENGTH+" bytes, Received: "+t.getSize());if(!Ti.equal(a.HEADER_SIGNATURE,t.subView(a.FLAG_POSITION.SIGNATURE,a.FLAG_POSITION.SIGNATURE+8).getData()))throw new Error;if(!Ti.equal(a.MINOR_VERSION_3,t.subView(a.FLAG_POSITION.MINOR_VERSION,a.FLAG_POSITION.MINOR_VERSION+2).getData()))throw new Error;if(!Ti.equal(a.MAJOR_VERSION_3,t.subView(a.FLAG_POSITION.MAJOR_VERSION,a.FLAG_POSITION.MAJOR_VERSION+2).getData()))throw new Error;if(!Ti.equal(a.BYTE_ORDER_LITTLE_ENDIAN,t.subView(a.FLAG_POSITION.BYTE_ORDER,a.FLAG_POSITION.BYTE_ORDER+2).getData()))throw new Error;if(!Ti.equal(a.SECTOR_SHIFT_VERSION_3,t.subView(a.FLAG_POSITION.SECTOR_SHIFT,a.FLAG_POSITION.SECTOR_SHIFT+2).getData()))throw new Error;if(!Ti.equal(a.MINI_SECTOR_SHIFT_VERSION_3,t.subView(a.FLAG_POSITION.MINI_SECTOR_SHIFT,a.FLAG_POSITION.MINI_SECTOR_SHIFT+2).getData()))throw new Error;if(!Ti.equal(Ti.initializedWidth(6,0),t.subView(34,40).getData()))throw new Error;if(!Ti.equal(Ti.initializedWidth(4,0),t.subView(40,44).getData()))throw new Error;if(!Ti.equal(a.MINI_STREAM_CUTOFF_SIZE,t.subView(a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION,a.FLAG_POSITION.MINI_STREAM_CUTOFF_SIZE_POSITION+4).getData()))throw new Error;this.dataView=t,this.difatEntries=new Fi.DifatEntries(this.dataView.subView(a.FLAG_POSITION.DIFAT_ENTRIES_FIRST_POSITION))}e.Header=n}),ki=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.DIFATSector=void 0;var o=n(Xn),n=(a.prototype.getPosition=function(){return this.delegate.getPosition()},a.prototype.writeAt=function(t,e){if(Ti.isEndOfChain(e)&&508!==t)throw new Error;if(Ti.isFreeSectOrNoStream(e)&&this.fatSectors.length>t/4)throw new Error;if(!Ti.isEndOfChain(e)&&!Ti.isFreeSectOrNoStream(e)&&508!==t&&this.fatSectors.length!==t/4)throw new Error;return this.fatSectors.push(o.fromBytesLE(e).toNumber()),this.delegate.writeAt(t,e)},a.prototype.registerFatSector=function(t){if(127<=this.fatSectors.length)throw new Error;this.writeAt(4*this.fatSectors.length,o.fromValue(t).to4BytesLE())},a.prototype.registerNextDifatSector=function(t){this.writeAt(508,o.fromValue(t).to4BytesLE())},a.prototype.getRegisteredFatSectors=function(){return this.fatSectors},a.prototype.hasFreeSpace=function(){return this.fatSectors.length<127},a.prototype.getSize=function(){return this.delegate.getSize()},a.prototype.getData=function(){return this.delegate.getData()},a.prototype.subView=function(t,e){return this.delegate.subView(t,e)},a.prototype.allocate=function(t){return this.delegate.allocate(t)},a.prototype.fill=function(t){return this.delegate.fill(t),this},a.prototype.isEmpty=function(){return this.delegate.isEmpty()},a.prototype.readAt=function(t,e){return this.delegate.readAt(t,e)},a);function a(t){this.fatSectors=[],this.delegate=t;for(var e=0;e<t.getSize()-4-1;e+=4){var n=t.subView(e,e+4).getData();if(Ti.isFreeSectOrNoStream(n))break;this.fatSectors.push(o.fromBytesLE(n).toNumber())}}e.DIFATSector=n}),Bi=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.DIFAT=void 0;var o=n(Xn),n=(a.prototype.readDifatSectors=function(){var t=this.header.getFirstDifatSectorLocation();if(!Ti.isEndOfChain(t)){var e=new ki.DIFATSector(this.sectors.sector(t));this.difatSectors.push(e);for(var n=o.fromBytesLE(e.subView(this.header.getSectorShift()-4,this.header.getSectorShift()).getData()).toNumber();!Ti.isEndOfChain(n);)e=new ki.DIFATSector(this.sectors.sector(n)),this.difatSectors.push(e),n=o.fromBytesLE(e.subView(this.header.getSectorShift()-4,this.header.getSectorShift()).getData()).toNumber()}},a.prototype.getFatSectorChain=function(){var t=[];t.push.apply(t,this.header.getDifatEntries());for(var e=0,n=this.difatSectors;e<n.length;e++){var i=n[e];t.push.apply(t,i.getRegisteredFatSectors())}return t},a.prototype.registerFATSector=function(t){var e;this.header.canFitMoreDifatEntries()?this.header.registerFatSector(t):(e=void 0,0===this.difatSectors.length?(e=this.sectors.allocateDIFAT(),this.faTtoDIFATFacade.registerDifatSectorInFAT(e.getPosition()),this.header.setFirstDifatSectorLocation(e.getPosition()),this.difatSectors.push(e),this.header.setNumberOfDifatSectors(this.difatSectors.length)):this.difatSectors[this.difatSectors.length-1].hasFreeSpace()?e=this.difatSectors[this.difatSectors.length-1]:(e=this.sectors.allocateDIFAT(),this.faTtoDIFATFacade.registerDifatSectorInFAT(e.getPosition()),this.difatSectors[this.difatSectors.length-1].registerNextDifatSector(e.getPosition()),this.difatSectors.push(e),this.header.setNumberOfDifatSectors(this.difatSectors.length)),e.registerFatSector(t))},a);function a(t,e,n){this.difatSectors=[],this.sectors=t,this.header=e,this.faTtoDIFATFacade=n,this.readDifatSectors()}e.DIFAT=n}),Hi=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleSector=void 0;var n=(i.prototype.getPosition=function(){return this.position},i.prototype.writeAt=function(t,e){return this.view.writeAt(t,e),this},i.prototype.getSize=function(){return this.view.getSize()},i.prototype.getData=function(){return this.view.getData()},i.prototype.subView=function(t,e){return this.view.subView(t,e)},i.prototype.allocate=function(t){return this.view.allocate(t)},i.prototype.fill=function(t){return this.view.fill(t),this},i.prototype.readAt=function(t,e){return this.view.readAt(t,e)},i.from=function(t,e,n){e=new i(t,e);return null!=n&&e.fill(n),e},i.prototype.isEmpty=function(){return 0===this.getSize()},i);function i(t,e){this.view=t,this.position=e}e.SimpleSector=n}),Gi=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Sectors=void 0;var n=(i.prototype.sector=function(t){if(t>this.sectors.length)throw new Error;return this.sectors[t]},i.prototype.readSectors=function(){if(!this.dataView.isEmpty()){if(this.dataView.getSize()%this.sectorShift!=0)throw new Error;for(var t=1;t<this.dataView.getSize()/this.sectorShift;t++)this.sectors.push(Hi.SimpleSector.from(this.dataView.subView(t*this.sectorShift,(t+1)*this.sectorShift),this.sectors.length))}},i.prototype.allocate=function(){var t=Hi.SimpleSector.from(this.dataView.allocate(this.sectorShift),this.sectors.length);return t.fill(Ti.FREESECT_MARK_OR_NOSTREAM),this.sectors.push(t),t},i.prototype.allocateDIFAT=function(){var t=new ki.DIFATSector(this.allocate());return t.fill(Ti.FREESECT_MARK_OR_NOSTREAM),t.subView(508).writeAt(0,Ti.ENDOFCHAIN_MARK),t},i);function i(t,e){this.sectors=[],this.dataView=t,this.sectorShift=e.getSectorShift(),this.header=e,this.readSectors()}e.Sectors=n}),Ui=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.AllocationTable=void 0;var o=n(Xn),n=(a.prototype.buildChain=function(t){if(Ti.isEndOfChain(t))return[];for(var e=[];!Ti.isEndOfChain(t);)e.push(t),t=this.getValueAt(t);return e},a.prototype.getValueAt=function(t){var e=Math.floor(4*t/this.sectorSize),t=4*t%this.sectorSize;if(e>this.sectorChain.length)throw new Error;return o.fromBytesLE(this.sectors.sector(this.sectorChain[e]).subView(t,4+t).getData()).toNumber()},a.prototype.registerSector=function(t,e){this.getFatSectorPointingToAllocatedSector(t).writeAt(this.calculatePositionInsideFatSector(t),Ti.ENDOFCHAIN_MARK),null!=e&&this.getFatSectorPointingToAllocatedSector(e).writeAt(this.calculatePositionInsideFatSector(e),o.fromValue(t).to4BytesLE())},a.prototype.getFatSectorPointingToAllocatedSector=function(t){var e=Math.floor(t/a.ENTRIES_IN_ONE_FAT_SECTOR);if(this.sectorChain.length<=e){for(var n=null;this.sectorChain.length<=e;)n=this.allocateNewSector();return n}return this.sectors.sector(this.sectorChain[e])},a.prototype.allocateNewSector=function(){var t=this.sectors.allocate(),e=t.getPosition();return this.sectorChain.push(e),t},a.prototype.calculatePositionInsideFatSector=function(t){return t%a.ENTRIES_IN_ONE_FAT_SECTOR*4},a.ENTRIES_IN_ONE_FAT_SECTOR=128,a);function a(t,e,n){this.sectorChain=[],this.sectors=t,this.sectorChain=e,this.sectorSize=n}e.AllocationTable=n}),ji=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.FAT=void 0;var r,n=(r=Ui.AllocationTable,n(o,r),o.prototype.registerDifatSector=function(t){this.getFatSectorPointingToAllocatedSector(t).writeAt(this.calculatePositionInsideFatSector(t),Ti.DISECT_MARK)},o.prototype.allocateNewSector=function(){var t=r.prototype.allocateNewSector.call(this),e=t.getPosition(),n=this.getFatSectorPointingToAllocatedSector(e),e=this.calculatePositionInsideFatSector(e);return n.writeAt(e,Ti.FATSECT_MARK),this.difat.registerFatSectorInDIFAT(t.getPosition()),this.header.setNumberOfFatSectors(this.sectorChain.length),t},o);function o(t,e,n){t=r.call(this,t,n.getFatSectorChain(),e.getSectorShift())||this;return t.header=e,t.difat=n,t}e.FAT=n}),Vi=C(function(t,e){var i,n=O&&O.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.MiniFAT=void 0;var r,n=(r=Ui.AllocationTable,n(o,r),o.prototype.allocateNewSector=function(){var t=r.prototype.allocateNewSector.call(this),e=1===this.sectorChain.length?null:this.sectorChain[this.sectorChain.length-2];return this.fat.registerSector(t.getPosition(),e),this.header.setNumberOfMiniFatSectors(this.sectorChain.length),1===this.sectorChain.length&&this.header.setFirstMinifatSectorLocation(this.sectorChain[0]),t},o);function o(t,e,n){t=r.call(this,t,n.buildChain(e.getFirstMinifatSectorLocation()),e.getSectorShift())||this;return t.header=e,t.fat=n,t}e.MiniFAT=n}),Wi=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.DirectoryEntryChain=void 0;var n=(i.prototype.readDirectoryEntryCount=function(){if(0!==this.sectorChain.length){for(var t=-1,e=0,n=this.sectorChain;e<n.length;e++)for(var i=n[e],r=this.sectors.sector(i),o=0;o<4;o++){var a=r.subView(128*o,128*(o+1)),s=Oi.DirectoryEntry.getLeftSiblingPosition(a),h=Oi.DirectoryEntry.getRightSiblingPosition(a),a=Oi.DirectoryEntry.getChildPosition(a);Ti.isFreeSectOrNoStream(s)||(t=Math.max(t,s)),Ti.isFreeSectOrNoStream(h)||(t=Math.max(t,h)),Ti.isFreeSectOrNoStream(a)||(t=Math.max(t,a))}this.directoryEntryCount=t+1}},i.prototype.getRootStorage=function(){return this.getEntryById(0)},i.prototype.getEntryById=function(t){if(t<0||t>this.directoryEntryCount-1)throw new Error("No such element "+t);var e=Math.floor(t/4),n=t%4*128,e=this.sectors.sector(this.sectorChain[e]).subView(n,128+n),n=e.subView(Oi.DirectoryEntry.FLAG_POSITION.OBJECT_TYPE,Oi.DirectoryEntry.FLAG_POSITION.OBJECT_TYPE+1).getData()[0];return n===Oi.ObjectType.RootStorage?new Di.RootStorageDirectoryEntry(t,this,e):n===Oi.ObjectType.Storage?new Mi.StorageDirectoryEntry(t,this,e):new Ci.StreamDirectoryEntry(t,this,this.streamHolder,e)},i.prototype.createRootStorage=function(){if(0!==this.directoryEntryCount)throw new Error("Root Storage should be the first Directory Entry");var t=this.getViewForDirectoryEntry();return new Di.RootStorageDirectoryEntry(0,this,t,Di.RootStorageDirectoryEntry.NAME,Oi.ColorFlag.BLACK,Oi.ObjectType.RootStorage)},i.prototype.createStorage=function(t,e){return new Mi.StorageDirectoryEntry(this.directoryEntryCount,this,this.getViewForDirectoryEntry(),t,e)},i.prototype.createStream=function(t,e,n){e=new Ci.StreamDirectoryEntry(this.directoryEntryCount,this,this.streamHolder,this.getViewForDirectoryEntry(),t,e);return 0<n.length&&e.setStreamData(n),e},i.prototype.getViewForDirectoryEntry=function(){var t=this.directoryEntryCount%4;try{if(0!=t)return this.sectors.sector(this.sectorChain[this.sectorChain.length-1]).subView(t*Oi.DirectoryEntry.ENTRY_LENGTH,(1+t)*Oi.DirectoryEntry.ENTRY_LENGTH);var e=this.sectors.allocate();return 0===this.sectorChain.length?(this.header.setFirstDirectorySectorLocation(e.getPosition()),this.fat.registerSector(e.getPosition(),null)):this.fat.registerSector(e.getPosition(),this.sectorChain[this.sectorChain.length-1]),this.sectorChain.push(e.getPosition()),e.subView(0,128)}finally{this.directoryEntryCount++}},i.UTF16_TERMINATING_BYTES=[0,0],i);function i(t,e,n,i){this.directoryEntryCount=0,this.sectors=t,this.fat=e,this.header=n,this.sectorChain=e.buildChain(n.getFirstDirectorySectorLocation()),this.streamHolder=i,this.readDirectoryEntryCount()}e.DirectoryEntryChain=n}),zi=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.FATtoDIFATFacade=void 0;var n=(i.prototype.setDifat=function(t){this.difat=t},i.prototype.setFat=function(t){this.fat=t},i.prototype.getFatSectorChain=function(){return this.difat.getFatSectorChain()},i.prototype.registerFatSectorInDIFAT=function(t){this.difat.registerFATSector(t)},i.prototype.registerDifatSectorInFAT=function(t){this.fat.registerDifatSector(t)},i);function i(){}e.FATtoDIFATFacade=n}),$i=function(t,e){return($i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Yi=function(){return(Yi=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function Ki(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&i>=t.length?void 0:t)&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qi(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function Zi(t){return this instanceof Zi?(this.v=t,this):new Zi(t)}var Ei=Object.freeze({__proto__:null,__extends:function(t,e){function n(){this.constructor=t}$i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},get __assign(){return Yi},__rest:function(t,e){var n={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},__decorate:function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(r=t[s])&&(a=(o<3?r(a):3<o?r(e,n,a):r(e,n))||a);return 3<o&&a&&Object.defineProperty(e,n,a),a},__param:function(n,i){return function(t,e){i(t,e,n)}},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function(t,a,s,h){return new(s=s||Promise)(function(n,e){function i(t){try{o(h.next(t))}catch(t){e(t)}}function r(t){try{o(h.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(i,r)}o((h=h.apply(t,a||[])).next())})},__generator:function(n,i){var r,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=i.call(n,s)}catch(t){e=[6,t],o=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},__createBinding:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]},__exportStar:function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])},__values:Ki,__read:qi,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(qi(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i},__await:Zi,__asyncGenerator:function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),o=[],a={};return i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(i){r[i]&&(a[i]=function(n){return new Promise(function(t,e){1<o.push([i,n,t,e])||s(i,n)})})}function s(t,e){try{(n=r[t](e)).value instanceof Zi?Promise.resolve(n.value.v).then(h,l):u(o[0][2],n)}catch(t){u(o[0][3],t)}var n}function h(t){s("next",t)}function l(t){s("throw",t)}function u(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncDelegator:function(i){var r,t={};return e("next"),e("throw",function(t){throw t}),e("return"),t[Symbol.iterator]=function(){return this},t;function e(e,n){t[e]=i[e]?function(t){return(r=!r)?{value:Zi(i[e](t)),done:"return"===e}:n?n(t):t}:n}},__asyncValues:function(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=a[Symbol.asyncIterator];return e?e.call(a):(a=Ki(a),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=a[o]&&function(r){return new Promise(function(t,e){var n,i;r=a[o](r),n=t,t=e,i=r.done,e=r.value,Promise.resolve(e).then(function(t){n({value:t,done:i})},t)})}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}}),Xi=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isDate=e.isComparable=e.isIterable=void 0,e.isIterable=t=>{return null!=t&&null!=t[Symbol.iterator]},e.isComparable=t=>{const e=Object.prototype.toString;return null!=t.compare&&e.call(t.compare).endsWith("Function]")},e.isDate=t=>{const e=Object.prototype.toString;return e.call(t).endsWith("Date]")}}),Ji=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0})}),Qi=I(Ei),tr=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const i={number:(t,e)=>t-e,string:(t,e)=>t.localeCompare(e),Date:(t,e)=>t.getTime()-e.getTime(),bigInt:(t,e)=>Number(t-e),none:()=>0};class r extends Map{constructor(t,e){super(),this.specifiedCompareFn=!1,this.isCompareFn=t=>"function"==typeof t,this.compareFn=i.none,this.sortedKeys=[],Xi.isIterable(t)&&this._constructor(t,e),this.isCompareFn(t)&&this._constructor(null,t),null==t&&this._constructor(null,e)}get comparator(){return this.compareFn}compare(t,e){return Math.sign(this.compareFn(t,e))}_constructor(t,e){if(this.compareFn=null==e?i.none:e,this.specifiedCompareFn=null!=e,null!=t)for(const n of t)this.set(...n)}static fromMap(t,e){const n=new r(e);return n.setAll(t),n}duplicate(){return r.fromMap(this,this.compareFn)}toMap(){const n=new Map,t=Array.from(super.entries());return t.sort((t,e)=>this.compareFn(t[0],e[0])),t.forEach(([t,e])=>{n.set(t,e)}),n}reverseKeys(){const t=[...this.sortedKeys].reverse();return t.values()}get(e){var t=this.sortedKeys.find(t=>0===this.comparator(t,e));if(null!=t)return super.get(t)}set(e,t){0!==this.sortedKeys.length||this.specifiedCompareFn||(this.compareFn=(t=>{if("number"==typeof t)return i.number;if("string"==typeof t)return i.string;if("bigint"==typeof t)return i.bigInt;if(Xi.isDate(t))return i.Date;if(Xi.isComparable(t))return(t,e)=>t.compare(e);throw new Error("Cannot sort keys in this map. You have to specify compareFn if the type of key in this map is not number, string, or Date.")})(e),this.specifiedCompareFn=!0);var n=this.sortedKeys.find(t=>0===this.compareFn(t,e));return null==n?(this.sortedKeys.push(e),super.set(e,t)):super.set(n,t),this.sortedKeys.sort(this.compareFn),this}setAll(t){return t.forEach((t,e)=>{this.set(e,t)}),this}delete(e){return!!super.delete(e)&&(this.sortedKeys=this.sortedKeys.filter(t=>0!==this.compare(t,e)),!0)}clear(){super.clear(),this.sortedKeys=[]}keys(){return this.sortedKeys.values()}values(){return this.sortedKeys.map(t=>super.get(t)).values()}entries(){return this.toMap().entries()}firstEntry(){var t=this.firstKey();if(null!=t){var e=this.get(t);return void 0===e?void 0:[t,e]}}firstKey(){return this.sortedKeys[0]}lastEntry(){var t=this.lastKey();if(null!=t){var e=this.get(t);return void 0===e?void 0:[t,e]}}lastKey(){return[...this.sortedKeys].reverse()[0]}shiftEntry(){var t=this.firstEntry();if(null!=t)return this.delete(t[0]),t}popEntry(){var t=this.lastEntry();if(null!=t)return this.delete(t[0]),t}floorEntry(t){var e=this.floorKey(t);if(null!=e){t=this.get(e);return void 0===t?void 0:[e,t]}}floorKey(e){const t=this.sortedKeys.filter(t=>this.compare(t,e)<=0);return t.reverse()[0]}ceilingEntry(t){var e=this.ceilingKey(t);if(null!=e){t=this.get(e);return void 0===t?void 0:[e,t]}}ceilingKey(e){return this.sortedKeys.filter(t=>0<=this.compare(t,e))[0]}lowerEntry(t){var e=this.lowerKey(t);if(null!=e){t=this.get(e);return void 0===t?void 0:[e,t]}}lowerKey(e){const t=this.sortedKeys.filter(t=>this.compare(t,e)<0);return t.reverse()[0]}higherEntry(t){var e=this.higherKey(t);if(null!=e){t=this.get(e);return void 0===t?void 0:[e,t]}}higherKey(e){return this.sortedKeys.filter(t=>0<this.compare(t,e))[0]}splitLower(n,i=!0){var t=Array.from(this.entries()).filter(t=>{var e=this.compare(t[0],n)<0;return i?e||0===this.compare(t[0],n):e});return new r(t,this.compareFn)}splitHigher(n,i=!0){var t=Array.from(this.entries()).filter(t=>{var e=0<this.compare(t[0],n);return i?e||0===this.compare(t[0],n):e});return new r(t,this.compareFn)}forEach(n,t){Array.from(this.entries()).forEach(([t,e])=>{n(e,t,this)},t)}}e.default=r,Qi.__exportStar(Ji,e)}),er=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ReferencingSubview=void 0;var n=(i.prototype.writeAt=function(t,e){return this.delegate.writeAt(this.start+t,e)},i.prototype.getSize=function(){return this.capacity},i.prototype.getData=function(){return this.delegate.readAt(this.start,this.end-this.start)},i.prototype.subView=function(t,e){if((e=null==e?this.capacity:e)<t)throw new Error("end < start ("+e+" < "+t+")");if(t<0)throw new Error("subView start: "+t+", view start: "+this.start);if(e>this.capacity)throw new Error("subView end: "+e+", view end: "+this.capacity);if(t>=this.capacity)throw new Error("subView start: "+t+", view end: "+this.capacity);if(e<0)throw new Error("subView end: "+e+", view start: "+this.start);return new i(this.delegate,this.start+t,this.start+e)},i.prototype.allocate=function(t){throw new Error("Unsupported operation")},i.prototype.fill=function(t){if(this.getSize()%t.length!=0)throw new Error;for(var e=t.length,n=0;n<this.getSize();n+=e)this.writeAt(n,t);return this},i.prototype.readAt=function(t,e){if(this.start+t>=this.end)throw new Error("Starting position cannot be greater then subview 'end'. (starting position: "+t+" < view end: "+this.end+")");if(this.start+t+e>=this.end)throw new Error("Operation exceeds view limits. (read end position "+(t+e)+"< view end: "+this.end+")");return this.delegate.readAt(this.start+t,e)},i.prototype.isEmpty=function(){return 0===this.getSize()},i);function i(t,e,n){this.delegate=t,this.capacity=n-e,this.start=e,this.end=n}e.ReferencingSubview=n}),nr=C(function(t,e){var i=O&&O.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleDataview=void 0;var n=(r.prototype.writeAt=function(t,e){var n;if(t+e.length>this.data.length)throw new Error(e.length+" + "+t+" > "+this.data.length);return(n=this.data).splice.apply(n,i([t,e.length],e)),this},r.prototype.getSize=function(){return this.data.length},r.prototype.getData=function(){return this.data},r.prototype.subView=function(t,e){null==e&&(e=this.data.length);var n=this.data.length;if(e<t)throw new Error("end < start ("+e+" < "+t+")");if(t<0)throw new Error("subView start: "+t+", view start: 0");if(n<e)throw new Error("subView end: "+e+", view end: "+n);if(n<=t)throw new Error("subView start: "+t+", view end: "+n);if(e<0)throw new Error("subView end: "+e+", view start: 0");return new er.ReferencingSubview(this,t,e)},r.prototype.allocate=function(t){throw new Error("Unsupported operation")},r.prototype.fill=function(t){return Ti.fill(this.data,t),this},r.prototype.readAt=function(t,e){return this.data.slice(t,t+e)},r.prototype.isEmpty=function(){return 0===this.getSize()},r);function r(t){this.data=t}e.SimpleDataview=n}),ir=C(function(t,e){var n=O&&O.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VariableSizeChunkedDataView=void 0;var o=n(tr),n=(u.prototype.writeAt=function(t,e){if(t<0)throw new Error("Cannot write at index < 0: start = "+t);if(t+e.length>this.size)throw new Error("Sub-view should has end index < "+this.size+": end = "+(t+e.length-1));var n=this.viewMap.lowerKey(t),n=void 0===n?t:t-n-1,i=e.length,r=this.viewMap.ceilingEntry(t),o=r[0],a=r[1],s=Math.min(a.subView(n).getSize(),i);for(i-=s,a.writeAt(n,e.slice(0,s));0<i;){if(void 0===this.viewMap.higherEntry(o))throw new Error("Preliminary end of chain");i-=s=Math.min(a.getSize(),i),a.writeAt(0,e.slice(0,s))}return this},u.prototype.getSize=function(){return this.size},u.prototype.getData=function(){for(var t=[],e=0,n=Array.from(this.viewMap.values());e<n.length;e++){var i=n[e];t.push.apply(t,i.getData()),i.getSize()}return t},u.prototype.subView=function(t,e){if(null==e){if(t<0)throw new Error("Sub-view should has starting index >= 0: start = "+t);var n=this.viewMap.ceilingEntry(t),i=n[0],r=n[1],o=void 0,a=(o=void 0===this.viewMap.lowerEntry(t)?i:this.viewMap.lowerEntry(t)[0])===i?t:t-o-1;return(l=[]).push(r.subView(a)),l.push.apply(l,Array.from(this.viewMap.splitHigher(i,!1).values())),new u(l)}if(t<0)throw new Error("Sub-view should has starting index >= 0: start = "+t);if(e>this.size)throw new Error("Sub-view should has end index < "+this.getSize()+": end = "+e);if(t>=this.getSize())throw new Error("Sub-view should not exceed the size of a view: size = "+this.getSize());if(e<t)throw new Error("Sub-view start should be less or equal to end: start("+t+") / end("+e+")");if(t===e)return new nr.SimpleDataview(new Array(0));var s=e-1,h=this.viewMap.ceilingEntry(t),n=h[0],o=h[1],r=this.viewMap.ceilingEntry(s),i=r[0],h=r[1],a=void 0,r=this.viewMap.lowerKey(t);if(a=void 0===r?t:t-r-1,n===i)return void 0===r?o.subView(a,e):o.subView(a,e-r-1);var l,s=this.viewMap.lowerKey(s);return(l=[]).push(o.subView(a)),l.push.apply(l,Array.from(this.viewMap.splitHigher(n,!1).splitLower(i,!1).values())),l.push(h.subView(0,e-s-1)),new u(l)},u.prototype.allocate=function(t){throw new Error("Unsupported Operation")},u.prototype.fill=function(e){return this.viewMap.forEach(function(t){return t.fill(e)}),this},u.prototype.readAt=function(t,e){return this.subView(t,t+e).getData()},u.prototype.isEmpty=function(){return 0===this.getSize()},u);function u(t){this.viewMap=new o.default;for(var e=0,n=0,i=t;n<i.length;n++){var r=i[n];e+=r.getSize(),this.viewMap.set(e-1,r)}this.size=e}e.VariableSizeChunkedDataView=n}),rr=C(function(t,e){var u=O&&O.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.MiniStreamRW=void 0;var n=(i.prototype.read=function(t,e,n){var i=this;if(null!=n)return new ir.VariableSizeChunkedDataView(this.miniFAT.buildChain(t).map(function(t){return i.getMiniSectorData(t)})).subView(e,n).getData();for(var r=Ti.initializedWidth(e,0),o=0,a=0,s=this.miniFAT.buildChain(t);a<s.length;a++){var h=s[a];if(!(0<e))break;var l=this.getMiniSectorData(h),h=Math.min(l.getSize(),e);r.splice.apply(r,u([o,h],l.subView(0,h).getData())),o+=h,e-=h}return r},i.prototype.getMiniSectorData=function(t){var e=Math.floor(t*this.header.getMiniSectorShift()/this.header.getSectorShift()),t=t*this.header.getMiniSectorShift()%this.header.getSectorShift();return this.sectors.sector(this.miniStreamSectorChain[e]).subView(t,t+this.header.getMiniSectorShift())},i.prototype.write=function(t){if(t.length<=0)throw new Error;for(var e=this.howManyChunksNeeded(t.length),n=Ti.ENDOFCHAIN_MARK_INT,i=0;i<e;i++){var r=i*this.header.getMiniSectorShift(),o=Math.min((i+1)*this.header.getMiniSectorShift(),t.length),o=t.slice(r,o);this.getDataHolderForNextChunk().writeAt(0,o);o=this.miniStreamLength/this.header.getMiniSectorShift();n===Ti.ENDOFCHAIN_MARK_INT&&(n=o),0===i?this.miniFAT.registerSector(o,null):this.miniFAT.registerSector(o,o-1),this.miniStreamLength+=this.header.getMiniSectorShift()}return n},i.prototype.howManyChunksNeeded=function(t){t=t%this.header.getMiniSectorShift()==0?Math.floor(t/this.header.getMiniSectorShift()):Math.floor(t/this.header.getMiniSectorShift())+1;return t},i.prototype.writeAt=function(t,e,n){var i=this;new ir.VariableSizeChunkedDataView(this.miniFAT.buildChain(t).map(function(t){return i.getMiniSectorData(t)})).writeAt(e,n)},i.prototype.append=function(t,e,n){var i=this.miniFAT.buildChain(t);if(0===i.length)return this.write(n);var r=i[i.length-1],o=this.getMiniSectorData(r),a=0,i=n.length;if(e%this.header.getMiniSectorShift()!=0&&0<(a=o.getSize()-e%this.header.getMiniSectorShift())&&(e=Math.min(a,n.length),o.writeAt(o.getSize()-a,n.slice(0,e)),a-=e,i-=e),0<a||0===i)return t;for(var s=this.howManyChunksNeeded(i),h=0;h<s;h++){var l=h*this.header.getMiniSectorShift(),u=Math.min((h+1)*this.header.getMiniSectorShift(),n.length),u=n.slice(l,u);this.getDataHolderForNextChunk().writeAt(0,u);u=this.miniStreamLength/this.header.getMiniSectorShift();0===h?this.miniFAT.registerSector(u,r):this.miniFAT.registerSector(u,u-1),this.miniStreamLength+=this.header.getMiniSectorShift()}return t},i.prototype.getDataHolderForNextChunk=function(){var t=this.getSectorForNextChunk(),e=this.miniStreamLength%this.header.getSectorShift();return t.subView(e,e+this.header.getMiniSectorShift())},i.prototype.getSectorForNextChunk=function(){if(0===this.miniStreamSectorChain.length){var t=this.sectors.allocate();return this.fat.registerSector(t.getPosition(),null),this.miniStreamSectorChain.push(t.getPosition()),t}if(this.miniStreamLength%this.header.getSectorShift()!=0)return this.sectors.sector(this.miniStreamSectorChain[this.miniStreamSectorChain.length-1]);t=this.sectors.allocate();return this.fat.registerSector(t.getPosition(),this.sectors.sector(this.miniStreamSectorChain[this.miniStreamSectorChain.length-1]).getPosition()),this.miniStreamSectorChain.push(t.getPosition()),t},i.prototype.getMiniStreamLength=function(){return this.miniStreamLength},i.prototype.getMiniStreamFirstSectorPosition=function(){return this.miniStreamLength<=0?Ti.FREESECT_MARK_OR_NOSTREAM_INT:this.miniStreamSectorChain[0]},i.MINI_STREAM_CHUNK_SIZE=64,i);function i(t,e,n,i,r,o){this.miniFAT=t,this.fat=e,this.miniStreamLength=i,this.miniStreamSectorChain=0<=n?e.buildChain(n):[],this.sectors=r,this.header=o}e.MiniStreamRW=n}),or=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.StreamHolder=void 0;var n=(i.prototype.forSize=function(t){return t>=this.sizeThreshold?this.regularStreamRW:this.miniStreamRW},i.prototype.getStreamData=function(t,e){return this.forSize(e).read(t,e)},i.prototype.setStreamData=function(t){return this.forSize(t.length).write(t)},i.prototype.read=function(t,e,n,i){return this.forSize(e).read(t,n,i)},i.prototype.writeAt=function(t,e,n,i){this.forSize(e).writeAt(t,n,i)},i.prototype.append=function(t,e,n){if(e<this.sizeThreshold&&e+n.length>=this.sizeThreshold){var i=this.forSize(e).read(t,e);return i.push.apply(i,n),this.forSize(e+n.length).write(i)}return this.forSize(e).append(t,e,n)},i);function i(t,e,n){this.regularStreamRW=t,this.miniStreamRW=e,this.sizeThreshold=n}e.StreamHolder=n}),ar=C(function(t,e){var u=O&&O.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.RegularStreamRW=void 0;var n=(i.prototype.read=function(t,e,n){var i=this;if(null!=n)return new ir.VariableSizeChunkedDataView(this.fat.buildChain(t).map(function(t){return i.sectors.sector(t)})).subView(e,n).getData();for(var r=Ti.initializedWidth(e,0),o=0,a=0,s=this.fat.buildChain(t);a<s.length;a++){var h=s[a];if(!(0<e))break;var l=this.sectors.sector(h),h=Math.min(l.getSize(),e);r.splice.apply(r,u([o,h],l.subView(0,h).getData())),o+=h,e-=h}return r},i.prototype.write=function(t){for(var e=null,n=null,i=0;i<t.length;i+=this.header.getSectorShift()){var r=this.sectors.allocate(),o=Math.min(this.header.getSectorShift(),t.length-i);r.writeAt(0,t.slice(i,i+o));r=r.getPosition();this.fat.registerSector(r,n),null==e&&(e=r),n=r}return e},i.prototype.writeAt=function(t,e,n){var i=this;new ir.VariableSizeChunkedDataView(this.fat.buildChain(t).map(function(t){return i.sectors.sector(t)})).writeAt(e,n)},i.prototype.append=function(t,e,n){var i=this.fat.buildChain(t);if(0===i.length)return this.write(n);var r=i[i.length-1],o=this.sectors.sector(r),a=0,i=n.length;if(e%this.header.getSectorShift()!=0&&0<(a=o.getSize()-e%this.header.getSectorShift())&&(e=Math.min(a,n.length),o.writeAt(o.getSize()-a,n.slice(0,e)),a-=e,i-=e),0<a||0===i)return t;for(var s=this.howManyChunksNeeded(i),h=r,l=0;l<s;l+=this.header.getSectorShift()){var u=this.sectors.allocate(),c=Math.min(this.header.getSectorShift(),n.length-l);u.writeAt(0,n.slice(l,l+c));u=u.getPosition();this.fat.registerSector(u,h),h=u}return t},i.prototype.howManyChunksNeeded=function(t){t=t%this.header.getSectorShift()==0?Math.floor(t/this.header.getSectorShift()):Math.floor(t/this.header.getSectorShift())+1;return t},i);function i(t,e,n){this.fat=t,this.sectors=e,this.header=n}e.RegularStreamRW=n}),sr=C(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.FixedSizeChunkedDataview=void 0;var n=(i.prototype.writeAt=function(t,e){return this.chunks[Math.floor(t/512)].writeAt(t%512,e)},i.prototype.getSize=function(){return this.chunks.length*this.chunkSize},i.prototype.getData=function(){for(var t=[],e=0,n=this.chunks;e<n.length;e++){var i=n[e];t.push.apply(t,i.getData())}return t},i.prototype.subView=function(t,e){if(null==e)throw new Error("'end' parameter is mandatory");if(Math.floor(t/this.chunkSize)!==Math.floor((e-1)/this.chunkSize))throw new Error("Can only get subview enclosed by one chunk. Actual values: "+t+" - "+e);if(t===e)throw new Error("Cannot get subview of size 0");var n=this.chunks[Math.floor(t/this.chunkSize)];return e%this.chunkSize==0?n.subView(t%this.chunkSize):n.subView(t%this.chunkSize,e%this.chunkSize)},i.prototype.allocate=function(t){if(t!==this.chunkSize)throw new Error;t=new nr.SimpleDataview(Ti.initializedWidth(t,0));return this.chunks.push(t),t},i.prototype.fill=function(t){throw new Error("Unsupported operation")},i.prototype.readAt=function(t,e){throw new Error("Unsupported operation")},i.prototype.isEmpty=function(){return!1},i);function i(t,e){if(this.chunks=[],this.chunkSize=t,null!=e)if("number"==typeof e[0]){if(e.length%t!=0)throw new Error("The passed bytes array should be divisible by chunk size. Actual array size : "+e.length+"; chunk size: "+t+".");for(var n=e.length,i=new nr.SimpleDataview(e),r=0;r<n;r+=512)this.chunks.push(new er.ReferencingSubview(i,r,r+512))}else(t=this.chunks).push.apply(t,e)}e.FixedSizeChunkedDataview=n}),hr=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=O&&O.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=O&&O.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.CompoundFile=void 0;var o=n(Xn),n=(a.fromBytes=function(t){return new a(new sr.FixedSizeChunkedDataview(512,t))},a.fromUint8Array=function(t){return new a(new sr.FixedSizeChunkedDataview(512,[].slice.call(t)))},a.empty=function(){var t=new sr.FixedSizeChunkedDataview(xi.Header.SECTOR_SHIFT_VERSION_3_INT);return xi.Header.empty(t.allocate(xi.Header.HEADER_LENGTH)),t},a.prototype.getMiniStreamFirstSectorLocation=function(){return Ti.ENDOFCHAIN_MARK_INT===this.header.getFirstDirectorySectorLocation()?Ti.ENDOFCHAIN_MARK_INT:o.fromBytesLE(this.sectors.sector(this.header.getFirstDirectorySectorLocation()).subView(Oi.DirectoryEntry.FLAG_POSITION.STARTING_SECTOR_LOCATION,Oi.DirectoryEntry.FLAG_POSITION.STARTING_SECTOR_LOCATION+4).getData()).toNumber()},a.prototype.getMiniStreamLength=function(){return Ti.ENDOFCHAIN_MARK_INT===this.header.getFirstDirectorySectorLocation()?0:o.fromBytesLE(this.sectors.sector(this.header.getFirstDirectorySectorLocation()).subView(Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE,Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE+4).getData()).toNumber()},a.prototype.setMiniStreamFirstSectorLocation=function(t){this.sectors.sector(this.header.getFirstDirectorySectorLocation()).subView(Oi.DirectoryEntry.FLAG_POSITION.STARTING_SECTOR_LOCATION,Oi.DirectoryEntry.FLAG_POSITION.STARTING_SECTOR_LOCATION+4).writeAt(0,0<=t?o.fromValue(t).to4BytesLE():Ti.ENDOFCHAIN_MARK)},a.prototype.setMiniStreamLength=function(t){this.sectors.sector(this.header.getFirstDirectorySectorLocation()).subView(Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE,Oi.DirectoryEntry.FLAG_POSITION.STREAM_SIZE+4).writeAt(0,o.fromValue(t).to4BytesLE())},a.prototype.getRootStorage=function(){return this.directoryEntryChain.getRootStorage()},a.prototype.asBytes=function(){return this.dataView.getData()},a.prototype.rewrite=function(){var t=new a,e=this.getRootStorage(),n=t.getRootStorage();return e.eachChild(this.copyConsumer(n)),t},a.prototype.copyConsumer=function(n){var i=this.copyConsumer.bind(this);return function(t){if(t instanceof Mi.StorageDirectoryEntry){var e=n.addStorage(t.getDirectoryEntryName());t.eachChild(i(e))}else{if(!(t instanceof Ci.StreamDirectoryEntry))throw new Error("Unsupported object type: "+typeof t);n.addStream(t.getDirectoryEntryName(),t.getStreamData())}}},a);function a(t){var e=null==t;e&&(t=a.empty()),this.dataView=t,this.header=new xi.Header(t.subView(0,xi.Header.HEADER_LENGTH)),this.sectors=new Gi.Sectors(t,this.header);t=new zi.FATtoDIFATFacade;this.difat=new Bi.DIFAT(this.sectors,this.header,t),t.setDifat(this.difat),this.fat=new ji.FAT(this.sectors,this.header,t),t.setFat(this.fat),this.miniFat=new Vi.MiniFAT(this.sectors,this.header,this.fat);var i=new rr.MiniStreamRW(this.miniFat,this.fat,this.getMiniStreamFirstSectorLocation(),this.getMiniStreamLength(),this.sectors,this.header),r=this,t={read:function(t,e,n){return i.read(t,e,n)},write:function(t){t=i.write(t);return r.setMiniStreamFirstSectorLocation(i.getMiniStreamFirstSectorPosition()),r.setMiniStreamLength(i.getMiniStreamLength()),t},writeAt:function(t,e,n){return i.writeAt(t,e,n)},append:function(t,e,n){n=i.append(t,e,n);return r.setMiniStreamFirstSectorLocation(i.getMiniStreamFirstSectorPosition()),r.setMiniStreamLength(i.getMiniStreamLength()),n}},t=new or.StreamHolder(new ar.RegularStreamRW(this.fat,this.sectors,this.header),t,this.header.getMiniStreamCutoffSize());this.directoryEntryChain=new Wi.DirectoryEntryChain(this.sectors,this.fat,this.header,t),e&&this.directoryEntryChain.createRootStorage()}e.CompoundFile=n}),lr=C(function(t,e){var i=O&&O.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),n=O&&O.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"StreamDirectoryEntry",{enumerable:!0,get:function(){return Ci.StreamDirectoryEntry}}),Object.defineProperty(e,"StorageDirectoryEntry",{enumerable:!0,get:function(){return Mi.StorageDirectoryEntry}}),Object.defineProperty(e,"DirectoryEntry",{enumerable:!0,get:function(){return Oi.DirectoryEntry}}),Object.defineProperty(e,"RootStorageDirectoryEntry",{enumerable:!0,get:function(){return Di.RootStorageDirectoryEntry}}),Object.defineProperty(e,"CompoundFile",{enumerable:!0,get:function(){return hr.CompoundFile}}),n(Ti,e),n(wi,e)}),ur=new b(5,1,0,0),cr="HWP Document File";function fr(t){for(var e=lr.CompoundFile.fromUint8Array(t),t=function(t){var e=t.getRootStorage().findChild(function(t){return"FileHeader"===t.getDirectoryEntryName()});if(!e)throw new Error("Cannot find FileHeader");var n=String.fromCharCode.apply(String,v(e.getStreamData().slice(0,17)));if(cr!==n)throw new Error("hwp file's signature should be '".concat(cr,"'. Received version: '").concat(n,"'"));var i=(o=l(e.getStreamData().slice(32,36).reverse(),4))[0],r=o[1],t=o[2],o=o[3];if(!(o=new b(i,r,t,o)).isCompatible(ur))throw new Error("hwp.js only support '".concat(ur,"' format. Received version: '").concat(o,"'"));return e=e.getStreamData().slice(36,49),new w(n,o,e)}(e),n=function(t){var e=t.getRootStorage().findChild(function(t){return"DocInfo"===t.getDirectoryEntryName()});if(!e)throw new Error("DocInfo not exist");return e=new Uint8Array(e.getStreamData()),e=sn.inflate(e,{windowBits:-15}),new Mn(e,t).parse()}(e),i=[],r=0;r<n.sectionSize;r+=1)i.push(function(t,e){var t=t.getRootStorage().findChild(function(t){return"BodyText"===t.getDirectoryEntryName()}),n="Section".concat(e);if(!(t=t.findChild(function(t){return n===t.getDirectoryEntryName()})))throw new Error("Section not exist");return t=new Uint8Array(t.getStreamData()),t=sn.inflate(t,{windowBits:-15}),new Zn(t).parse()}(e,r));return new g(t,n,i)}var dr=function(){function e(t){var i=this;d(this,e),p(this,"section",void 0),p(this,"currentSection",void 0),p(this,"currentParagraph",new Vn),p(this,"readIndex",0),p(this,"contentHeight",0),p(this,"currentHeight",0),p(this,"controlIndex",0),p(this,"startCharIndex",0),p(this,"endCharIndex",0),p(this,"shapeBufferIndex",0),p(this,"latestY",0),p(this,"result",[]),p(this,"visitParagraph",function(n){i.readIndex=0,i.controlIndex=0,i.startCharIndex=0,i.endCharIndex=0,i.shapeBufferIndex=0,i.currentParagraph=new Vn,n.lineSegments.forEach(function(t,e){i.visitLine(t,e,n)}),i.exitParagraph(n)}),this.section=t,this.currentSection=this.createSection(),this.contentHeight=t.height-t.headerPadding-t.footerPadding-t.paddingTop-t.paddingBottom}return n(e,[{key:"createSection",value:function(){var t=new T;return t.width=this.section.width,t.height=this.section.height,t.paddingTop=this.section.paddingTop,t.paddingRight=this.section.paddingRight,t.paddingBottom=this.section.paddingBottom,t.paddingLeft=this.section.paddingLeft,t.headerPadding=this.section.headerPadding,t.footerPadding=this.section.footerPadding,t}},{key:"getLine",value:function(t,e,n){for(var t=t.start,i=n.getNextSize(e),r=[],o=t;o<i;){var a=n.content[this.readIndex];a.type===f.Char?o+=1:o+=8,r.push(a),this.readIndex+=1}return r}},{key:"checkoutShapeBuffer",value:function(t){for(var e=t.getShapeEndPos(this.shapeBufferIndex),n=0;this.endCharIndex<=e&&this.shapeBufferIndex<t.shapeBuffer.length-1;){var e=t.getShapeEndPos(this.shapeBufferIndex),i=t.shapeBuffer[this.shapeBufferIndex];this.currentParagraph.shapeBuffer.push({shapeIndex:i.shapeIndex,pos:n}),n+=e-this.startCharIndex-n,this.shapeBufferIndex+=1}var r=t.shapeBuffer[this.shapeBufferIndex];this.currentParagraph.shapeBuffer.push({shapeIndex:r.shapeIndex,pos:n})}},{key:"exitParagraph",value:function(t){this.checkoutShapeBuffer(t),this.currentSection.content.push(this.currentParagraph)}},{key:"exitPage",value:function(t){this.exitParagraph(t),this.result.push(this.currentSection),this.currentSection=this.createSection(),this.currentParagraph=new Vn,this.currentParagraph.shapeIndex=t.shapeIndex,this.currentHeight=0}},{key:"createTable",value:function(t,e){var n=t.reduce(function(t,e){return t+Math.min.apply(Math,v(e.map(function(t){return t.attribute.height})))},0),i=new jn;return i.id=Tn.Table,i.width=e,i.height=n,i.content=t,i.rowCount=t.length,i}},{key:"visitLine",value:function(t,e,r){var o=this,e=this.getLine(t,e,r);(0===t.y||t.y<this.latestY)&&(this.exitPage(r),this.startCharIndex=this.endCharIndex,this.currentHeight=0),this.latestY=t.y,this.currentHeight+=t.height+t.lineSpacing,e.forEach(function(n){if(n.type!==f.Extened)return o.currentParagraph.content.push(n),void(o.endCharIndex+=1);var e=r.controls[o.controlIndex];if(o.controlIndex+=1,!$n(e))return o.currentParagraph.content.push(n),o.currentParagraph.controls.push(e),void(o.endCharIndex+=1);o.currentHeight-=t.height+t.lineSpacing;var i=function t(e,n,i,r){for(var o=i,a=0,s=-1,h=n,l=[],u=[],c=0;c<e.length;c+=1){var f=e[c],d=Math.min.apply(Math,v(f.map(function(t){return t.attribute.height})));if(u.push(d),!((a+=d)<=o)){s=c;break}l.push(f)}for(var p=0;p<h.length;p+=1){var g=l[0],_=h[p];_&&g.splice(_.attribute.column,0,_)}if(h=[],l.forEach(function(t,r){t.forEach(function(t){var e,n,i;t.attribute.height>o&&(e=t.attribute.height,i=(n=t.attribute.rowSpan)-(s-r-2),t.attribute.height=o,t.attribute.rowSpan=i,h[t.attribute.column]=new Wn(y(y({},t.attribute),{},{row:0,height:e-o,rowSpan:n-i}),[]))}),o-=u[r]}),s<0)return[l];r=t(e.slice(s),h,r,r);return[l].concat(v(r))}(e.content,[],o.contentHeight-o.currentHeight,o.contentHeight).map(function(t){return o.createTable(t,e.width)});i.forEach(function(t,e){o.currentParagraph.content.push(n),o.currentParagraph.controls.push(t),1<i.length&&e!==i.length-1&&(o.exitPage(r),o.startCharIndex=o.endCharIndex)}),o.currentHeight+=i[i.length-1].height,o.endCharIndex+=1})}},{key:"build",value:function(){return this.section.content.forEach(this.visitParagraph),this.result.shift(),this.result.push(this.currentSection),this.result}}]),e}();function pr(t){var e=[];return t.sections.forEach(function(t){e=e.concat(new dr(t).build())}),t.sections=e,t}}.call(this,_r(1))},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var i=n(6),r=Object.keys||function(t){var e,n=[];for(e in t)n.push(e);return n};t.exports=u;t=Object.create(n(4));t.inherits=n(3);var o=n(11),a=n(10);t.inherits(u,o);for(var s=r(a.prototype),h=0;h<s.length;h++){var l=s[h];u.prototype[l]||(u.prototype[l]=a.prototype[l])}function u(t){if(!(this instanceof u))return new u(t);o.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),u.prototype._destroy=function(t,e){this.push(null),this.end(),i.nextTick(e,t)}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){var n;e&&(t.super_=e,(n=function(){}).prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t)}},function(t,n,e){!function(t){function e(t){return Object.prototype.toString.call(t)}n.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},n.isBoolean=function(t){return"boolean"==typeof t},n.isNull=function(t){return null===t},n.isNullOrUndefined=function(t){return null==t},n.isNumber=function(t){return"number"==typeof t},n.isString=function(t){return"string"==typeof t},n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=function(t){return void 0===t},n.isRegExp=function(t){return"[object RegExp]"===e(t)},n.isObject=function(t){return"object"==typeof t&&null!==t},n.isDate=function(t){return"[object Date]"===e(t)},n.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},n.isFunction=function(t){return"function"==typeof t},n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=t.isBuffer}.call(this,e(14).Buffer)},function(t,e){var n,i,t=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var s,h=[],l=!1,u=-1;function c(){l&&s&&(l=!1,s.length?h=s.concat(h):u=-1,h.length&&f())}function f(){if(!l){var t=a(c);l=!0;for(var e=h.length;e;){for(s=h,h=[];++u<e;)s&&s[u].run();u=-1,e=h.length}s=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new d(t,e)),1!==h.length||l||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e,n){"use strict";!function(s){void 0===s||!s.version||0===s.version.indexOf("v0.")||0===s.version.indexOf("v1.")&&0!==s.version.indexOf("v1.8.")?t.exports={nextTick:function(t,e,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var r,o,a=arguments.length;switch(a){case 0:case 1:return s.nextTick(t);case 2:return s.nextTick(function(){t.call(null,e)});case 3:return s.nextTick(function(){t.call(null,e,n)});case 4:return s.nextTick(function(){t.call(null,e,n,i)});default:for(r=new Array(a-1),o=0;o<r.length;)r[o++]=arguments[o];return s.nextTick(function(){t.apply(null,r)})}}}:t.exports=s}.call(this,n(5))},function(t,e,n){var i=n(14),r=i.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return r(t,e,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=i:(o(i,e),e.Buffer=a),o(r,a),a.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,n)},a.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");t=r(t);return void 0!==e?"string"==typeof n?t.fill(e,n):t.fill(e):t.fill(0),t},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},function(t,e,n){"use strict";var i="object"==typeof Reflect?Reflect:null,h=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};var r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)},o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(s,h){return new Promise(function(t,e){function n(t){s.removeListener(h,i),e(t)}function i(){"function"==typeof s.removeListener&&s.removeListener("error",n),t([].slice.call(arguments))}var r,o,a;_(s,h,i,{once:!0}),"error"!==h&&(o=n,a={once:!0},"function"==typeof(r=s).on&&_(r,"error",o,a))})},(a.EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function l(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function c(t,e,n,i){var r,o;return l(n),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener||n),r=t._events),o=r[e]),void 0===o?(o=r[e]=n,++t._eventsCount):("function"==typeof o?o=r[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),0<(n=u(t))&&o.length>n&&!o.warned&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=t,n.type=e,n.count=o.length,n=n,console&&console.warn&&console.warn(n))),t}function f(t,e,n){t={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},e=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(t);return e.listener=n,t.wrapFn=e}function d(t,e,n){t=t._events;if(void 0===t)return[];e=t[e];return void 0===e?[]:"function"==typeof e?n?[e.listener||e]:[e]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):g(e,e.length)}function p(t){var e=this._events;if(void 0!==e){t=e[t];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function g(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function _(n,i,r,o){if("function"==typeof n.on)o.once?n.once(i,r):n.on(i,r);else{if("function"!=typeof n.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n);n.addEventListener(i,function t(e){o.once&&n.removeEventListener(i,t),r(e)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i,r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){if((i=0<e.length?e[0]:i)instanceof Error)throw i;r=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw r.context=i,r}t=o[t];if(void 0===t)return!1;if("function"==typeof t)h(t,this,e);else for(var a=t.length,s=g(t,a),n=0;n<a;++n)h(s[n],this,e);return!0},a.prototype.addListener=function(t,e){return c(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return c(this,t,e,!0)},a.prototype.once=function(t,e){return l(e),this.on(t,f(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,f(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,i,r,o,a;if(l(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;0<=o;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,a||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n=this._events;if(void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){for(var i,r=Object.keys(n),o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(o=e.length-1;0<=o;o--)this.removeListener(t,e[o]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return 0<this._eventsCount?r(this._events):[]}},function(t,e,n){(((e=t.exports=n(11)).Stream=e).Readable=e).Writable=n(10),e.Duplex=n(2),e.Transform=n(17),e.PassThrough=n(36)},function(E,t,w){"use strict";!function(t,e,n){var f=w(6);function u(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var i=t.entry;t.entry=null;for(;i;){var r=i.callback;e.pendingcb--,r(n),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}E.exports=l;var a,s=!t.browser&&-1<["v0.10","v0.9."].indexOf(t.version.slice(0,5))?e:f.nextTick;l.WritableState=h;e=Object.create(w(4));e.inherits=w(3);var i={deprecate:w(35)},r=w(13),d=w(7).Buffer,p=n.Uint8Array||function(){};var o,n=w(15);function g(){}function h(t,o){a=a||w(2);var e=o instanceof a;this.objectMode=!!(t=t||{}).objectMode,e&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,i=t.writableHighWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:e&&(i||0===i)?i:r,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;r=(this.destroyed=!1)===t.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){var e,n,i,r;n=t,i=(e=o)._writableState,r=i.sync,t=i.writecb,function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),n?function(t,e,n,i,r){--e.pendingcb,n?(f.nextTick(r,i),f.nextTick(S,t,e),t._writableState.errorEmitted=!0,t.emit("error",i)):(r(i),t._writableState.errorEmitted=!0,t.emit("error",i),S(t,e))}(e,i,r,n,t):((n=v(i))||i.corked||i.bufferProcessing||!i.bufferedRequest||y(e,i),r?s(c,e,i,n,t):c(e,i,n,t))},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new u(this)}function l(t){if(a=a||w(2),!(o.call(l,this)||this instanceof a))return new l(t);this._writableState=new h(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),r.call(this)}function _(t,e,n,i,r,o,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(r,e.onwrite):t._write(r,o,e.onwrite),e.sync=!1}function c(t,e,n,i){var r;n||(r=t,0===(n=e).length&&n.needDrain&&(n.needDrain=!1,r.emit("drain"))),e.pendingcb--,i(),S(t,e)}function y(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var i=e.bufferedRequestCount,r=new Array(i),i=e.corkedRequestsFree;i.entry=n;for(var o=0,a=!0;n;)(r[o]=n).isBuf||(a=!1),n=n.next,o+=1;r.allBuffers=a,_(t,e,!0,e.length,r,"",i.finish),e.pendingcb++,e.lastBufferedRequest=null,i.next?(e.corkedRequestsFree=i.next,i.next=null):e.corkedRequestsFree=new u(e),e.bufferedRequestCount=0}else{for(;n;){var s=n.chunk,h=n.encoding,l=n.callback;if(_(t,e,!1,e.objectMode?1:s.length,s,h,l),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function v(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function m(e,n){e._final(function(t){n.pendingcb--,t&&e.emit("error",t),n.prefinished=!0,e.emit("prefinish"),S(e,n)})}function S(t,e){var n,i,r=v(e);return r&&(n=t,(i=e).prefinished||i.finalCalled||("function"==typeof n._final?(i.pendingcb++,i.finalCalled=!0,f.nextTick(m,n,i)):(i.prefinished=!0,n.emit("prefinish"))),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),r}e.inherits(l,r),h.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(h.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(t){return!!o.call(this,t)||this===l&&(t&&t._writableState instanceof h)}})):o=function(t){return t instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(t,e,n){var i,r,o,a,s,h,l=this._writableState,u=!1,c=!l.objectMode&&(r=t,d.isBuffer(r)||r instanceof p);return c&&!d.isBuffer(t)&&(o=t,t=d.from(o)),"function"==typeof e&&(n=e,e=null),e=c?"buffer":e||l.defaultEncoding,"function"!=typeof n&&(n=g),l.ended?(a=this,s=n,h=new Error("write after end"),a.emit("error",h),f.nextTick(s,h)):(c||(i=this,r=l,o=n,s=!(a=!0),null===(h=t)?s=new TypeError("May not write null values to stream"):"string"==typeof h||void 0===h||r.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(i.emit("error",s),f.nextTick(o,s),a=!1),a))&&(l.pendingcb++,u=function(t,e,n,i,r,o){n||(h=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=d.from(e,n));return e}(e,i,r),i!==h&&(n=!0,r="buffer",i=h));var a=e.objectMode?1:i.length;e.length+=a;var s=e.length<e.highWaterMark;s||(e.needDrain=!0);{var h;e.writing||e.corked?(h=e.lastBufferedRequest,e.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:o,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1):_(t,e,!1,a,i,r,o)}return s}(this,l,c,t,e,n)),u},l.prototype.cork=function(){this._writableState.corked++},l.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||y(this,t))},l.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),l.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(t,e,n){var i=this._writableState;"function"==typeof t?(n=t,e=t=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(t,e,n){e.ending=!0,S(t,e),n&&(e.finished?f.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),l.prototype.destroy=n.destroy,l.prototype._undestroy=n.undestroy,l.prototype._destroy=function(t,e){this.end(),e(t)}}.call(this,w(5),w(33).setImmediate,w(1))},function(P,t,L){"use strict";!function(t,g){var _=L(6);P.exports=r;var o,y=L(12);r.ReadableState=i;function v(t,e){return t.listeners(e).length}L(8).EventEmitter;var n=L(13),u=L(7).Buffer,c=t.Uint8Array||function(){};var e=Object.create(L(4));e.inherits=L(3);var a,t=L(30),m=void 0,m=t&&t.debuglog?t.debuglog("stream"):function(){},s=L(31),t=L(15);e.inherits(r,n);var h=["error","close","destroy","pause","resume"];function i(t,e){var n=e instanceof(o=o||L(2));this.objectMode=!!(t=t||{}).objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,r=t.readableHighWaterMark,e=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(r||0===r)?r:e,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new s,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(a=a||L(16).StringDecoder,this.decoder=new a(t.encoding),this.encoding=t.encoding)}function r(t){if(o=o||L(2),!(this instanceof r))return new r(t);this._readableState=new i(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),n.call(this)}function l(t,e,n,i,r){var o,a,s,h,l=t._readableState;return null===e?(l.reading=!1,a=t,(s=l).ended||(!s.decoder||(h=s.decoder.end())&&h.length&&(s.buffer.push(h),s.length+=s.objectMode?1:h.length),s.ended=!0,S(a))):(o=!r?function(t,e){var n;(function(t){return u.isBuffer(t)||t instanceof c})(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(l,e):o)?t.emit("error",o):l.objectMode||e&&0<e.length?("string"==typeof e||l.objectMode||Object.getPrototypeOf(e)===u.prototype||(o=e,e=u.from(o)),i?l.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):f(t,l,e,!0):l.ended?t.emit("error",new Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!n?(e=l.decoder.write(e),l.objectMode||0!==e.length?f(t,l,e,!1):w(t,l)):f(t,l,e,!1))):i||(l.reading=!1),!(l=l).ended&&(l.needReadable||l.length<l.highWaterMark||0===l.length)}function f(t,e,n,i){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&S(t)),w(t,e)}Object.defineProperty(r.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),r.prototype.destroy=t.destroy,r.prototype._undestroy=t.undestroy,r.prototype._destroy=function(t,e){this.push(null),e(t)},r.prototype.push=function(t,e){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof t&&((e=e||i.defaultEncoding)!==i.encoding&&(t=u.from(t,e),e=""),n=!0),l(this,t,e,!1,n)},r.prototype.unshift=function(t){return l(this,t,null,!0,!1)},r.prototype.isPaused=function(){return!1===this._readableState.flowing},r.prototype.setEncoding=function(t){return a=a||L(16).StringDecoder,this._readableState.decoder=new a(t),this._readableState.encoding=t,this};var d=8388608;function p(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?(e.flowing&&e.length?e.buffer.head.data:e).length:(t>e.highWaterMark&&(e.highWaterMark=(d<=(n=t)?n=d:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0));var n}function S(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(m("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?_.nextTick(E,t):E(t))}function E(t){m("emit readable"),t.emit("readable"),O(t)}function w(t,e){e.readingMore||(e.readingMore=!0,_.nextTick(b,t,e))}function b(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(m("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function T(t){m("readable nexttick read 0"),t.read(0)}function A(t,e){e.reading||(m("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),O(t),e.flowing&&!e.reading&&t.read(0)}function O(t){var e=t._readableState;for(m("flow",e.flowing);e.flowing&&null!==t.read(););}function C(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var i;t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):i=t===e.head.data.length?e.shift():(n?function(t,e){var n=e.head,i=1,r=n.data;t-=r.length;for(;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?r+=o:r+=o.slice(0,t),0===(t-=a)){a===o.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n).data=o.slice(a);break}++i}return e.length-=i,r}:function(t,e){var n=u.allocUnsafe(t),i=e.head,r=1;i.data.copy(n),t-=i.data.length;for(;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),0===(t-=a)){a===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i).data=o.slice(a);break}++r}return e.length-=r,n})(t,e);return i}(t,e.buffer,e.decoder),n);var n}function I(t){var e=t._readableState;if(0<e.length)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,_.nextTick(R,e,t))}function R(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function N(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}r.prototype.read=function(t){m("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return m("read: emitReadable",e.length,e.ended),(0===e.length&&e.ended?I:S)(this),null;if(0===(t=p(t,e))&&e.ended)return 0===e.length&&I(this),null;var i=e.needReadable;return m("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&m("length less than watermark",i=!0),e.ended||e.reading?m("reading or ended",i=!1):i&&(m("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=p(n,e))),null===(i=0<t?C(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&I(this)),null!==i&&this.emit("data",i),i},r.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},r.prototype.pipe=function(n,t){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=n;break;case 1:r.pipes=[r.pipes,n];break;default:r.pipes.push(n)}r.pipesCount+=1,m("pipe count=%d opts=%j",r.pipesCount,t);t=(!t||!1!==t.end)&&n!==g.stdout&&n!==g.stderr?a:p;function o(t,e){m("onunpipe"),t===i&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,m("cleanup"),n.removeListener("close",f),n.removeListener("finish",d),n.removeListener("drain",s),n.removeListener("error",c),n.removeListener("unpipe",o),i.removeListener("end",a),i.removeListener("end",p),i.removeListener("data",u),h=!0,!r.awaitDrain||n._writableState&&!n._writableState.needDrain||s())}function a(){m("onend"),n.end()}r.endEmitted?_.nextTick(t):i.once("end",t),n.on("unpipe",o);var e,s=(e=i,function(){var t=e._readableState;m("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&v(e,"data")&&(t.flowing=!0,O(e))});n.on("drain",s);var h=!1;var l=!1;function u(t){m("ondata"),(l=!1)!==n.write(t)||l||((1===r.pipesCount&&r.pipes===n||1<r.pipesCount&&-1!==N(r.pipes,n))&&!h&&(m("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,l=!0),i.pause())}function c(t){m("onerror",t),p(),n.removeListener("error",c),0===v(n,"error")&&n.emit("error",t)}function f(){n.removeListener("finish",d),p()}function d(){m("onfinish"),n.removeListener("close",f),p()}function p(){m("unpipe"),i.unpipe(n)}return i.on("data",u),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?y(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(n,"error",c),n.once("close",f),n.once("finish",d),n.emit("pipe",i),r.flowing||(m("pipe resume"),i.resume()),n},r.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t=t||e.pipes,e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var i=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<r;o++)i[o].emit("unpipe",this,n);return this}var a=N(e.pipes,t);return-1===a||(e.pipes.splice(a,1),--e.pipesCount,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},r.prototype.addListener=r.prototype.on=function(t,e){e=n.prototype.on.call(this,t,e);return"data"===t?!1!==this._readableState.flowing&&this.resume():"readable"===t&&((t=this._readableState).endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.emittedReadable=!1,t.reading?t.length&&S(this):_.nextTick(T,this))),e},r.prototype.resume=function(){var t,e=this._readableState;return e.flowing||(m("resume"),e.flowing=!0,t=this,(e=e).resumeScheduled||(e.resumeScheduled=!0,_.nextTick(A,t,e))),this},r.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this},r.prototype.wrap=function(e){var t,n=this,i=this._readableState,r=!1;for(t in e.on("end",function(){var t;m("wrapped end"),!i.decoder||i.ended||(t=i.decoder.end())&&t.length&&n.push(t),n.push(null)}),e.on("data",function(t){m("wrapped data"),i.decoder&&(t=i.decoder.write(t)),i.objectMode&&null==t||(i.objectMode||t&&t.length)&&(n.push(t)||(r=!0,e.pause()))}),e)void 0===this[t]&&"function"==typeof e[t]&&(this[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t));for(var o=0;o<h.length;o++)e.on(h[o],this.emit.bind(this,h[o]));return this._read=function(t){m("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(r.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),r._fromList=C}.call(this,L(1),L(5))},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(8).EventEmitter},function(t,L,M){"use strict";!function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var s=M(28),o=M(29),a=M(12);function n(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(t,e){if(n()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(t=null===t?new c(e):t).length=e,t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"!=typeof t)return i(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}function i(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=u(t,e);return t}(t,e,n,i):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|d(e,n),n=(t=r(t,i)).write(e,n);n!==i&&(t=t.slice(0,n));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|f(e.length);return 0===(t=r(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?r(t,0):u(t,e);if("Buffer"===e.type&&a(e.data))return u(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(h(e),t=r(t,e<0?0:0|f(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function u(t,e){var n=e.length<0?0:0|f(e.length);t=r(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function f(t){if(t>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|t}function d(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var n=(t="string"!=typeof t?""+t:t).length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return R(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(t).length;default:if(i)return R(t).length;e=(""+e).toLowerCase(),i=!0}}function e(t,e,n){var i,r,o,a=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return function(t,e,n){var i=t.length;(!e||e<0)&&(e=0);(!n||n<0||i<n)&&(n=i);for(var r="",o=e;o<n;++o)r+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[o]);return r}(this,e,n);case"utf8":case"utf-8":return m(this,e,n);case"ascii":return function(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}(this,e,n);case"latin1":case"binary":return function(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}(this,e,n);case"base64":return i=this,o=n,0===(r=e)&&o===i.length?s.fromByteArray(i):s.fromByteArray(i.slice(r,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n){for(var i=t.slice(e,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}(this,e,n);default:if(a)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}function p(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function g(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?r?0:t.length-1:n)<0?t.length+n:n)>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=c.from(e,i)),c.isBuffer(e))return 0===e.length?-1:_(t,e,n,i,r);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(r?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,n):_(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,i,r){var o=1,a=t.length,s=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;a/=o=2,s/=2,n/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r)for(var l=-1,u=n;u<a;u++)if(h(t,u)===h(e,-1===l?0:u-l)){if(u-(l=-1===l?u:l)+1===s)return l*o}else-1!==l&&(u-=u-l),l=-1;else for(u=n=a<n+s?a-s:n;0<=u;u--){for(var c=!0,f=0;f<s;f++)if(h(t,u+f)!==h(e,f)){c=!1;break}if(c)return u}return-1}function y(t,e,n,i){return P(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function v(t,e,n,i){return P(function(t,e){for(var n,i,r=[],o=0;o<t.length&&!((e-=2)<0);++o)i=t.charCodeAt(o),n=i>>8,i=i%256,r.push(i),r.push(n);return r}(e,t.length-n),t,n,i)}function m(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var o,a,s,h,l=t[r],u=null,c=239<l?4:223<l?3:191<l?2:1;if(r+c<=n)switch(c){case 1:l<128&&(u=l);break;case 2:128==(192&(o=t[r+1]))&&127<(h=(31&l)<<6|63&o)&&(u=h);break;case 3:o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&2047<(h=(15&l)<<12|(63&o)<<6|63&a)&&(h<55296||57343<h)&&(u=h);break;case 4:o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(h=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)&&h<1114112&&(u=h)}null===u?(u=65533,c=1):65535<u&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=c}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=S));return n}(i)}L.Buffer=c,L.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},L.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),L.kMaxLength=n(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return i(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return i=null,e=e,n=n,h(t=t),!(t<=0)&&void 0!==e?"string"==typeof n?r(i,t).fill(e,n):r(i,t).fill(e):r(i,t);var i},c.allocUnsafe=function(t){return l(null,t)},c.allocUnsafeSlow=function(t){return l(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);if(void 0===e)for(r=e=0;r<t.length;++r)e+=t[r].length;for(var n=c.allocUnsafe(e),i=0,r=0;r<t.length;++r){var o=t[r];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)p(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)p(this,e,e+3),p(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)p(this,e,e+7),p(this,e+1,e+6),p(this,e+2,e+5),p(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?m(this,0,t):e.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",e=L.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,i,r){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),(e=void 0===e?0:e)<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(r<=i&&n<=e)return 0;if(r<=i)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(i>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),h=this.slice(i,r),l=t.slice(e,n),u=0;u<s;++u)if(h[u]!==l[u]){o=h[u],a=l[u];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},c.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||r<n)&&(n=r),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i=i||"utf8";for(var o,a,s,h=!1;;)switch(i){case"hex":return function(t,e,n,i){n=Number(n)||0;var r=t.length-n;if((!i||r<(i=Number(i)))&&(i=r),(r=e.length)%2!=0)throw new TypeError("Invalid hex string");r/2<i&&(i=r/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}(this,t,e,n);case"utf8":case"utf-8":return a=e,s=n,P(R(t,(o=this).length-a),o,a,s);case"ascii":return y(this,t,e,n);case"latin1":case"binary":return y(this,t,e,n);case"base64":return o=this,a=e,s=n,P(N(t),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,t,e,n);default:if(h)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),h=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function E(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function w(t,e,n,i,r,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function b(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);r<o;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function T(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);r<o;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function A(t,e,n,i){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(t,e,n,i,r){return r||A(t,0,n,4),o.write(t,e,n,i,23,4),n+4}function C(t,e,n,i,r){return r||A(t,0,n,8),o.write(t,e,n,i,52,8),n+8}c.prototype.slice=function(t,e){var n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=c.prototype;else for(var i=e-t,r=new c(i,void 0),o=0;o<i;++o)r[o]=this[o+t];return r},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var i=this[t+--e],r=1;0<e&&(r*=256);)i+=this[t+--e]*r;return i},c.prototype.readUInt8=function(t,e){return e||E(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||E(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||E(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||E(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||E(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return(r*=128)<=i&&(i-=Math.pow(2,8*e)),i},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var i=e,r=1,o=this[t+--i];0<i&&(r*=256);)o+=this[t+--i]*r;return(r*=128)<=o&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return e||E(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||E(t,2,this.length);t=this[t]|this[t+1]<<8;return 32768&t?4294901760|t:t},c.prototype.readInt16BE=function(t,e){e||E(t,2,this.length);t=this[t+1]|this[t]<<8;return 32768&t?4294901760|t:t},c.prototype.readInt32LE=function(t,e){return e||E(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||E(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||E(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||E(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||E(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||E(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||w(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||w(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[e+r]=255&t;0<=--r&&(o*=256);)this[e+r]=t/o&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):b(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):b(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):T(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):T(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,i){t=+t,e|=0,i||w(this,t,e,n,(i=Math.pow(2,8*n-1))-1,-i);var r=0,o=1,a=0;for(this[e]=255&t;++r<n&&(o*=256);)t<0&&0===a&&0!==this[e+r-1]&&(a=1),this[e+r]=(t/o>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,i){t=+t,e|=0,i||w(this,t,e,n,(i=Math.pow(2,8*n-1))-1,-i);var r=n-1,o=1,a=0;for(this[e+r]=255&t;0<=--r&&(o*=256);)t<0&&0===a&&0!==this[e+r+1]&&(a=1),this[e+r]=(t/o>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&(t=t<0?255+t+1:t),e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):b(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):b(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):T(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||w(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):T(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return O(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return O(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return C(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return C(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,i){if(n=n||0,i||0===i||(i=this.length),e>=t.length&&(e=t.length),(i=0<i&&i<n?n:i)===n)return 0;if(0===t.length||0===this.length)return 0;if((e=e||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length);var r,o=(i=t.length-e<i-n?t.length-e+n:i)-n;if(this===t&&n<e&&e<i)for(r=o-1;0<=r;--r)t[r+e]=this[r+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},c.prototype.fill=function(t,e,n,i){if("string"==typeof t){var r;if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1!==t.length||(r=t.charCodeAt(0))<256&&(t=r),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;if(e>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(s=e;s<n;++s)this[s]=t;else for(var o=c.isBuffer(t)?t:R(new c(t,i).toString()),a=o.length,s=0;s<n-e;++s)this[s+e]=o[s%a];return this};var I=/[^+\/0-9A-Za-z-_]/g;function R(t,e){var n;e=e||1/0;for(var i=t.length,r=null,o=[],a=0;a<i;++a){if(55295<(n=t.charCodeAt(a))&&n<57344){if(!r){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(a+1===i){-1<(e-=3)&&o.push(239,191,189);continue}r=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&-1<(e-=3)&&o.push(239,191,189);if(r=null,n<128){if(--e<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(t){return s.toByteArray(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(I,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function P(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}.call(this,M(1))},function(t,e,n){"use strict";var o=n(6);function a(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return i||r?e?e(t):!t||this._writableState&&this._writableState.errorEmitted||o.nextTick(a,this,t):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(o.nextTick(a,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";var i=n(7).Buffer,r=i.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(i.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}function a(t){var e;switch(this.encoding=o(t),this.encoding){case"utf16le":this.text=l,this.end=u,e=4;break;case"utf8":this.fillLast=h,e=4;break;case"base64":this.text=c,this.end=f,e=3;break;default:return this.write=d,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function h(t){var e,n,i=this.lastTotal-this.lastNeed,e=(e=this,128!=(192&(n=t)[0])?(e.lastNeed=0,"�"):1<e.lastNeed&&1<n.length?128!=(192&n[1])?(e.lastNeed=1,"�"):2<e.lastNeed&&2<n.length&&128!=(192&n[2])?(e.lastNeed=2,"�"):void 0:void 0);return void 0!==e?e:this.lastNeed<=t.length?(t.copy(this.lastChar,i,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,i,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1);var n=t.toString("utf16le",e);if(n){e=n.charCodeAt(n.length-1);if(55296<=e&&e<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function c(t,e){var n=(t.length-e)%3;return 0==n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){t=t&&t.length?this.write(t):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}(e.StringDecoder=a).prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},a.prototype.end=function(t){t=t&&t.length?this.write(t):"";return this.lastNeed?t+"�":t},a.prototype.text=function(t,e){var n=function(t,e,n){var i=e.length-1;if(i<n)return 0;var r=s(e[i]);if(0<=r)return 0<r&&(t.lastNeed=r-1),r;if(--i<n||-2===r)return 0;if(0<=(r=s(e[i])))return 0<r&&(t.lastNeed=r-2),r;if(--i<n||-2===r)return 0;if(0<=(r=s(e[i])))return 0<r&&(2===r?r=0:t.lastNeed=r-3),r;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;n=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";t.exports=r;var i=n(2),t=Object.create(n(4));function r(t){if(!(this instanceof r))return new r(t);i.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=e&&this.push(e),i(t),(t=this._readableState).reading=!1,(t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",o)}function o(){var n=this;"function"==typeof this._flush?this._flush(function(t,e){a(n,t,e)}):a(this,null,null)}function a(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}t.inherits=n(3),t.inherits(r,i),r.prototype.push=function(t,e){return this._transformState.needTransform=!1,i.prototype.push.call(this,t,e)},r.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},r.prototype._write=function(t,e,n){var i=this._transformState;i.writecb=n,i.writechunk=t,i.writeencoding=e,i.transforming||(e=this._readableState,(i.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark))},r.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},r.prototype._destroy=function(t,e){var n=this;i.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){var o=n(46),i=n(47);e.prototype={children:function(){return[]},parent:function(){return null},first:function(){return this.children()[0]},last:function(){return this.children()[this.children().length-1]},next:function(){for(var t=this;;){var e=t.parent();if(!e)return null;var n=e.children(),i=n[n.indexOf(t)+1];if(i){for(;;){var r=i.first();if(!r)break;i=r}return i}t=e}},previous:function(){var t=this.parent();if(!t)return null;var e=t.children(),e=e[e.indexOf(this)-1];if(e)return e;t=t.previous();return t?t.last():null},byOrdinal:function(e){var n=null;return this.children().some(function(t){if(e>=t.ordinal&&e<t.ordinal+t.length&&(n=t.byOrdinal(e)))return!0})?n:this},byCoordinate:function(n,i){var r;if(this.children().some(function(t){var e=t.bounds();if(e.contains(n,i)&&(r=t.byCoordinate(n,i)))return!0}),!r){for(r=this.last();r;){var t=r.last();if(!t)break;r=t}var e=r.next();e&&e.block&&(r=e)}return r},draw:function(e,n){this.children().forEach(function(t){t.draw(e,n)})},parentOfType:function(t){var e=this.parent();return e&&(e.type===t?e:e.parentOfType(t))},bounds:function(){var e=this._left,n=this._top,i=0,r=0;return this.children().forEach(function(t){t=t.bounds();e=Math.min(e,t.l),n=Math.min(n,t.t),i=Math.max(i,t.l+t.w),r=Math.max(r,t.t+t.h)}),o(e,n,i-e,r-n)}},e.derive=function(t){return i.derive(e.prototype,t)};var r=e.derive({children:function(){return this._children},parent:function(){return this._parent},finalize:function(t,e){var n=Number.MAX_VALUE,i=0;this._children.forEach(function(t){n=Math.min(n,t.ordinal),i=Math.max(i,t.ordinal+t.length)}),Object.defineProperty(this,"ordinal",{value:n-(t||0)}),Object.defineProperty(this,"length",{value:(e||0)+i-n})}});e.generic=function(t,e,n,i){return Object.create(r,{type:{value:t},_children:{value:[]},_parent:{value:e},_left:{value:"number"==typeof n?n:Number.MAX_VALUE},_top:{value:"number"==typeof i?i:Number.MAX_VALUE}})}},function(n,i,t){!function(t){var e;void 0===(e="function"==typeof(e=function(){"use strict";function r(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function u(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){s(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof t&&t.global===t?t:void 0,f=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!f?function(t,e,n){var i=c.URL||c.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?a(r):o(r.href)?u(t,e,n):a(r,r.target="_blank")):(r.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){a(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(r(t,n),e);else if(o(t))u(t,e,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){a(i)})}}:function(t,e,n,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return u(t,e,n);var r="application/octet-stream"===t.type,o=/constructor/i.test(c.HTMLElement)||c.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||r&&o||f)&&"undefined"!=typeof FileReader){var s=new FileReader;s.onloadend=function(){var t=s.result;t=a?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},s.readAsDataURL(t)}else{var h=c.URL||c.webkitURL,l=h.createObjectURL(t);i?i.location=l:location.href=l,i=null,setTimeout(function(){h.revokeObjectURL(l)},4e4)}});c.saveAs=s.saveAs=s,true&&(n.exports=s)})?e.apply(i,[]):e)||(n.exports=e)}.call(this,t(1))},function(t,e){var l,a,u,s;void 0===window.nhn&&(window.nhn={}),nhn.husky||(nhn.husky={}),l=/^\$(LOCAL|BEFORE|ON|AFTER)_/,a=/^\$(BEFORE|ON|AFTER)_MSG_APP_READY$/,u=[],s={},nhn.husky.HuskyCore=jindo.$Class({name:"HuskyCore",aCallerStack:null,bMobile:jindo.$Agent().navigator().mobile||jindo.$Agent().navigator().msafari,$init:function(t){this.htOptions=t||{},u.push(this),this.messageQueue=[],this.oMessageMap={},this.oDisabledMessage={},this.oLazyMessage={},this.aPlugins=[],this.appStatus=nhn.husky.APP_STATUS.NOT_READY,this.aCallerStack=[],this._fnWaitForPluginReady=jindo.$Fn(this._waitForPluginReady,this).bind(),this.registerPlugin(this)},exec:function(t,e,n){if(this.appStatus==nhn.husky.APP_STATUS.NOT_READY)return this.messageQueue[this.messageQueue.length]={msg:t,args:e,event:n},!0;this.exec=this._doExec,this.exec(t,e,n)},absorbedExec:function(t,e,n,i){i=jindo.$Fn(this.exec,this).bind(t,e,i);null!=this["timerId_"+t]&&clearTimeout(this["timerId_"+t]),this["timerId_"+t]=setTimeout(i,n)},delayedExec:function(t,e,n,i){i=jindo.$Fn(this.exec,this).bind(t,e,i);setTimeout(i,n)},_doExec:function(t,e,n){var i=!1;if(this.oLazyMessage[t]){var r=this.oLazyMessage[t];return this._loadLazyFiles(t,e,n,r.aFilenames,0),!1}if(!this.oDisabledMessage[t]){var o=[];if(e&&e.length)for(var a=e.length,s=0;s<a;s++)o[s]=e[s];n&&(o[o.length]=n),i=(i=(i=this._execMsgStep("BEFORE",t,o))&&this._execMsgStep("ON",t,o))&&this._execMsgStep("AFTER",t,o)}return i},registerPlugin:function(t){if(!t)throw"An error occured in registerPlugin(): invalid plug-in";if(t.nIdx=this.aPlugins.length,((t.oApp=this).aPlugins[t.nIdx]=t).status!=nhn.husky.PLUGIN_STATUS.NOT_READY&&(t.status=nhn.husky.PLUGIN_STATUS.READY),this.appStatus!=nhn.husky.APP_STATUS.NOT_READY)for(var e in t)l.test(e)&&this.addToMessageMap(e,t);return this.exec("MSG_PLUGIN_REGISTERED",[t]),t.nIdx},disableMessage:function(t,e){this.oDisabledMessage[t]=e},registerBrowserEvent:function(t,e,n,i,r,o){i=i||[];var a=o?jindo.$Fn(this.delayedExec,this).bind(n,i,o):r?jindo.$Fn(this.delayedExec,this).bind(n,i,r):jindo.$Fn(this.exec,this).bind(n,i),a=o?jindo.$Fn(this.absorbedExec,this).bind(n,i,o):r?jindo.$Fn(this.delayedExec,this).bind(n,i,r):jindo.$Fn(this.exec,this).bind(n,i);return jindo.$Fn(a,this).attach(t,e)},run:function(t){this.htRunOptions=t||{},this._changeAppStatus(nhn.husky.APP_STATUS.WAITING_FOR_PLUGINS_READY);for(var e=this.messageQueue.length,n=0;n<e;n++){var i=this.messageQueue[n];this.exec(i.msg,i.args,i.event)}this._fnWaitForPluginReady()},acceptLocalBeforeFirstAgain:function(t,e){t._husky_bRun=!e},createMessageMap:function(t){this.oMessageMap[t]=[];for(var e=this.aPlugins.length,n=0;n<e;n++)this._doAddToMessageMap(t,this.aPlugins[n])},addToMessageMap:function(t,e){this.oMessageMap[t]&&this._doAddToMessageMap(t,e)},_changeAppStatus:function(t){this.appStatus=t,this.appStatus==nhn.husky.APP_STATUS.READY&&this.exec("MSG_APP_READY")},_execMsgStep:function(t,e,n){return this._execMsgHandler("$"+t+"_"+e,n)},_execMsgHandler:function(t,e){var n;this.oMessageMap[t]||this.createMessageMap(t);var i=this.oMessageMap[t],r=i.length;if(0===r)return!0;var o=!0;if(a.test(t)){for(n=0;n<r;n++)if(!1===this._execHandler(i[n],t,e)){o=!1;break}}else for(n=0;n<r;n++)if((i[n]._husky_bRun||(i[n]._husky_bRun=!0,"function"!=typeof i[n].$LOCAL_BEFORE_FIRST||!1!==this._execHandler(i[n],"$LOCAL_BEFORE_FIRST",[t,e])))&&("function"!=typeof i[n].$LOCAL_BEFORE_ALL||!1!==this._execHandler(i[n],"$LOCAL_BEFORE_ALL",[t,e]))&&!1===this._execHandler(i[n],t,e)){o=!1;break}return o},_execHandler:function(t,e,n){this.aCallerStack.push(t);n=t[e].apply(t,n);return this.aCallerStack.pop(),n},_doAddToMessageMap:function(t,e){if("function"==typeof e[t]){for(var n=0,i=this.oMessageMap[t].length;n<i;n++)if(this.oMessageMap[t][n]==e)return;this.oMessageMap[t][n]=e}},_waitForPluginReady:function(){for(var t=!0,e=0;e<this.aPlugins.length;e++)if(this.aPlugins[e].status==nhn.husky.PLUGIN_STATUS.NOT_READY){t=!1;break}t?this._changeAppStatus(nhn.husky.APP_STATUS.READY):setTimeout(this._fnWaitForPluginReady,100)},_loadLazyFiles:function(t,e,n,i,r){if(i.length<=r)return this.oLazyMessage[t]=null,void this.oApp.exec(t,e,n);var o=i[r];s[o]?this._loadLazyFiles(t,e,n,i,r+1):jindo.LazyLoading.load(nhn.husky.SE2M_Configuration.LazyLoad.sJsBaseURI+"/"+o,jindo.$Fn(function(t,e,n,i,r){var o=i[r];s[o]=1,this._loadLazyFiles(t,e,n,i,r+1)},this).bind(t,e,n,i,r),"utf-8")},registerLazyMessage:function(t,e){t=t||[],e=e||[];for(var n,i,r=0;n=t[r];r++)(i=this.oLazyMessage[n])?i.aFilenames=i.aFilenames.concat(e):this.oLazyMessage[n]={sMsg:n,aFilenames:e}}}),nhn.husky.HuskyCore.reset=function(){u=[],s={}},nhn.husky.HuskyCore.addLoadedFile=function(t){s[t]=1},nhn.husky.HuskyCore.mixin=function(t,e,n){for(var i,r,o,a,s=[],h=0;o=u[h];h++)for(i=0;a=o.aPlugins[i];i++)if(a instanceof t)s.push(a),"function"!=typeof a.$LOCAL_BEFORE_FIRST&&a.oApp.acceptLocalBeforeFirstAgain(a,!0);else if(a._$superClass===t)for(r in"function"!=typeof a.$LOCAL_BEFORE_FIRST&&a.oApp.acceptLocalBeforeFirstAgain(a,!0),e)!n&&Object.prototype.hasOwnProperty.call(a,r)||(a[r]=e[r],l.test(r)&&a.oApp.addToMessageMap(r,a));for(r in e)if((n||!Object.prototype.hasOwnProperty.call(t.prototype,r))&&(t.prototype[r]=e[r],l.test(r)))for(i=0;a=s[i];i++)a.oApp.addToMessageMap(r,a)},nhn.husky.APP_STATUS={NOT_READY:0,WAITING_FOR_PLUGINS_READY:1,READY:2},nhn.husky.PLUGIN_STATUS={NOT_READY:0,READY:1}},function(t,e){void 0===window.nhn&&(window.nhn={}),nhn.CurrentSelection_IE=function(){this.getCommonAncestorContainer=function(){try{return this._oSelection=this._document.selection,"Control"==this._oSelection.type?this._oSelection.createRange().item(0):this._oSelection.createRangeCollection().item(0).parentElement()}catch(t){return this._document.body}},this.isCollapsed=function(){return this._oSelection=this._document.selection,"None"==this._oSelection.type}},nhn.CurrentSelection_FF=function(){this.getCommonAncestorContainer=function(){return this._getSelection().commonAncestorContainer},this.isCollapsed=function(){var t=this._window.getSelection();return t.rangeCount<1||t.getRangeAt(0).collapsed},this._getSelection=function(){try{return this._window.getSelection().getRangeAt(0)}catch(t){return this._document.createRange()}}},nhn.CurrentSelection=new(jindo.$Class({$init:function(){(jindo.$Agent().navigator().ie&&document.selection?nhn.CurrentSelection_IE:nhn.CurrentSelection_FF).apply(this)},setWindow:function(t){this._window=t,this._document=t.document}})),nhn.W3CDOMRange=jindo.$Class({$init:function(t){this.reset(t)},reset:function(t){this._window=t,this._document=this._window.document,this.collapsed=!0,this.commonAncestorContainer=this._document.body,this.endContainer=this._document.body,this.endOffset=0,this.startContainer=this._document.body,this.startOffset=0,this.oBrowserSelection=new nhn.BrowserSelection(this._window),this.selectionLoaded=this.oBrowserSelection.selectionLoaded},cloneContents:function(){var t=this._document.createDocumentFragment(),e=this._document.createDocumentFragment(),n=this._getNodesInRange();if(n.length<1)return t;n=this._constructClonedTree(n,e),e=e.firstChild;if(e)for(var i,r=e.firstChild;r;)i=r.nextSibling,t.appendChild(r),r=i;return(n=this._splitTextEndNodes({oStartContainer:n.oStartContainer,iStartOffset:this.startOffset,oEndContainer:n.oEndContainer,iEndOffset:this.endOffset})).oStartContainer&&n.oStartContainer.previousSibling&&nhn.DOMFix.parentNode(n.oStartContainer).removeChild(n.oStartContainer.previousSibling),n.oEndContainer&&n.oEndContainer.nextSibling&&nhn.DOMFix.parentNode(n.oEndContainer).removeChild(n.oEndContainer.nextSibling),t},_constructClonedTree:function(t,e){var o=null,a=null,s=this.startContainer,h=this.endContainer;return this._recurConstructClonedTree=function(t,e,n){if(e<0)return e;var i=e-1,r=t[e].cloneNode(!1);for(t[e]==s&&(o=r),t[e]==h&&(a=r);0<=i&&nhn.DOMFix.parentNode(t[i])==t[e];)i=this._recurConstructClonedTree(t,i,r);return n.insertBefore(r,n.firstChild),i},t[t.length]=nhn.DOMFix.parentNode(t[t.length-1]),this._recurConstructClonedTree(t,t.length-1,e),{oStartContainer:o,oEndContainer:a}},cloneRange:function(){return this._copyRange(new nhn.W3CDOMRange(this._window))},_copyRange:function(t){return t.collapsed=this.collapsed,t.commonAncestorContainer=this.commonAncestorContainer,t.endContainer=this.endContainer,t.endOffset=this.endOffset,t.startContainer=this.startContainer,t.startOffset=this.startOffset,t._document=this._document,t},collapse:function(t){t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this._updateRangeInfo()},compareBoundaryPoints:function(t,e){switch(t){case nhn.W3CDOMRange.START_TO_START:return this._compareEndPoint(this.startContainer,this.startOffset,e.startContainer,e.startOffset);case nhn.W3CDOMRange.START_TO_END:return this._compareEndPoint(this.endContainer,this.endOffset,e.startContainer,e.startOffset);case nhn.W3CDOMRange.END_TO_END:return this._compareEndPoint(this.endContainer,this.endOffset,e.endContainer,e.endOffset);case nhn.W3CDOMRange.END_TO_START:return this._compareEndPoint(this.startContainer,this.startOffset,e.endContainer,e.endOffset)}},_findBody:function(t){if(!t)return null;for(;t;){if("BODY"==t.tagName)return t;t=nhn.DOMFix.parentNode(t)}return null},_compareEndPoint:function(t,e,n,i){return this.oBrowserSelection.compareEndPoints(t,e,n,i)},_getCommonAncestorContainer:function(t,e){t=t||this.startContainer;for(var n=e=e||this.endContainer;t;){for(;n;){if(t==n)return t;n=nhn.DOMFix.parentNode(n)}n=e,t=nhn.DOMFix.parentNode(t)}return this._document.body},deleteContents:function(){if(!this.collapsed){this._splitTextEndNodesOfTheRange();var t=this._getNodesInRange();if(!(t.length<1)){for(var e=t[0].previousSibling;e&&this._isBlankTextNode(e);)e=e.previousSibling;var n,i=-1;e||(n=nhn.DOMFix.parentNode(t[0]),i=0);for(var r=0;r<t.length;r++){var o=t[r];!o.firstChild||this._isAllChildBlankText(o)?(n==o&&(i=this._getPosIdx(n),n=nhn.DOMFix.parentNode(o)),o.parentNode.removeChild(o)):n==o&&0===i&&(i=this._getPosIdx(n),n=nhn.DOMFix.parentNode(o))}e?"BODY"==e.tagName?this.setStartBefore(e,!0):this.setStartAfter(e,!0):this.setStart(n,i,!0,!0),this.collapse(!0)}}},extractContents:function(){var t=this.cloneContents();return this.deleteContents(),t},getInsertBeforeNodes:function(){var t,e=null,e="3"==this.startContainer.nodeType?(t=nhn.DOMFix.parentNode(this.startContainer),this.startContainer.nodeValue.length<=this.startOffset?this.startContainer.nextSibling:this.startContainer.splitText(this.startOffset)):(t=this.startContainer,nhn.DOMFix.childNodes(this.startContainer)[this.startOffset]);return{elParent:t,elBefore:e=!e||!nhn.DOMFix.parentNode(e)?null:e}},insertNode:function(t){var e=this.getInsertBeforeNodes();e.elParent.insertBefore(t,e.elBefore),this.setStartBefore(t)},selectNode:function(t){this.reset(this._window),this.setStartBefore(t),this.setEndAfter(t)},selectNodeContents:function(t){this.reset(this._window),this.setStart(t,0,!0),this.setEnd(t,nhn.DOMFix.childNodes(t).length)},_endsNodeValidation:function(t,e){if(!t||this._findBody(t)!=this._document.body)throw new Error("INVALID_NODE_TYPE_ERR oNode is not part of current document");return 3==t.nodeType?e>t.nodeValue.length&&(e=t.nodeValue.length):e>nhn.DOMFix.childNodes(t).length&&(e=nhn.DOMFix.childNodes(t).length),e},setEnd:function(t,e,n,i){n||(e=this._endsNodeValidation(t,e)),this.endContainer=t,this.endOffset=e,i||(this.startContainer&&-1==this._compareEndPoint(this.startContainer,this.startOffset,this.endContainer,this.endOffset)?this._updateRangeInfo():this.collapse(!1))},setEndAfter:function(t,e){if(!t)throw new Error("INVALID_NODE_TYPE_ERR in setEndAfter");"BODY"!=t.tagName?this.setEnd(nhn.DOMFix.parentNode(t),this._getPosIdx(t)+1,!0,e):this.setEnd(t,nhn.DOMFix.childNodes(t).length,!0,e)},setEndBefore:function(t,e){if(!t)throw new Error("INVALID_NODE_TYPE_ERR in setEndBefore");"BODY"!=t.tagName?this.setEnd(nhn.DOMFix.parentNode(t),this._getPosIdx(t),!0,e):this.setEnd(t,0,!0,e)},setStart:function(t,e,n,i){n||(e=this._endsNodeValidation(t,e)),this.startContainer=t,this.startOffset=e,i||(this.endContainer&&-1==this._compareEndPoint(this.startContainer,this.startOffset,this.endContainer,this.endOffset)?this._updateRangeInfo():this.collapse(!0))},setStartAfter:function(t,e){if(!t)throw new Error("INVALID_NODE_TYPE_ERR in setStartAfter");"BODY"!=t.tagName?this.setStart(nhn.DOMFix.parentNode(t),this._getPosIdx(t)+1,!0,e):this.setStart(t,nhn.DOMFix.childNodes(t).length,!0,e)},setStartBefore:function(t,e){if(!t)throw new Error("INVALID_NODE_TYPE_ERR in setStartBefore");"BODY"!=t.tagName?this.setStart(nhn.DOMFix.parentNode(t),this._getPosIdx(t),!0,e):this.setStart(t,0,!0,e)},surroundContents:function(t){t.appendChild(this.extractContents()),this.insertNode(t),this.selectNode(t)},toString:function(){var t=this._document.createElement("DIV");return t.appendChild(this.cloneContents()),t.textContent||t.innerText||""},fixCommonAncestorContainer:function(){jindo.$Agent().navigator().ie&&(this.commonAncestorContainer=this._getCommonAncestorContainer())},_isBlankTextNode:function(t){return 3==t.nodeType&&""==t.nodeValue},_isAllChildBlankText:function(t){for(var e=0,n=t.childNodes.length;e<n;e++)if(!this._isBlankTextNode(t.childNodes[e]))return!1;return!0},_getPosIdx:function(t){for(var e=0,n=t.previousSibling;n;n=n.previousSibling)e++;return e},_updateRangeInfo:function(){this.startContainer?(this.collapsed=this.oBrowserSelection.isCollapsed(this)||this.startContainer===this.endContainer&&this.startOffset===this.endOffset,this.commonAncestorContainer=this.oBrowserSelection.getCommonAncestorContainer(this)):this.reset(this._window)},_isCollapsed:function(t,e,n,i){var r=!1;return t==n&&e==i?r=!0:(e=this._getActualStartNode(t,e),i=this._getActualEndNode(n,i),e=this._getNextNode(this._getPrevNode(e)),i=this._getPrevNode(this._getNextNode(i)),e&&i&&"BODY"!=i.tagName&&(this._getNextNode(i)==e||i==e&&this._isBlankTextNode(i))&&(r=!0)),r},_splitTextEndNodesOfTheRange:function(){var t=this._splitTextEndNodes({oStartContainer:this.startContainer,iStartOffset:this.startOffset,oEndContainer:this.endContainer,iEndOffset:this.endOffset});this.startContainer=t.oStartContainer,this.startOffset=t.iStartOffset,this.endContainer=t.oEndContainer,this.endOffset=t.iEndOffset},_splitTextEndNodes:function(t){return t=this._splitStartTextNode(t),t=this._splitEndTextNode(t)},_splitStartTextNode:function(t){var e=t.oStartContainer,n=t.iStartOffset,i=t.oEndContainer,r=t.iEndOffset;if(!e)return t;if(3!=e.nodeType)return t;if(0===n)return t;if(e.nodeValue.length<=n)return t;t=e.splitText(n);return e==i&&(r-=n,i=t),{oStartContainer:e=t,iStartOffset:n=0,oEndContainer:i,iEndOffset:r}},_splitEndTextNode:function(t){var e=t.oStartContainer,n=t.iStartOffset,i=t.oEndContainer,r=t.iEndOffset;return!i||3!=i.nodeType||r>=i.nodeValue.length||0===r?t:(i.splitText(r),{oStartContainer:e,iStartOffset:n,oEndContainer:i,iEndOffset:r})},_getNodesInRange:function(){if(this.collapsed)return[];var t=this._getActualStartNode(this.startContainer,this.startOffset),e=this._getActualEndNode(this.endContainer,this.endOffset);return this._getNodesBetween(t,e)},_getActualStartNode:function(t,e){var n=t;return 3==t.nodeType?e>=t.nodeValue.length?"BODY"==(n=this._getNextNode(t)).tagName&&(n=null):n=t:e<nhn.DOMFix.childNodes(t).length?n=nhn.DOMFix.childNodes(t)[e]:"BODY"==(n=this._getNextNode(t)).tagName&&(n=null),n},_getActualEndNode:function(t,e){var n=t;return 0===e?"BODY"==(n=this._getPrevNode(t)).tagName&&(n=null):n=3==t.nodeType?t:nhn.DOMFix.childNodes(t)[e-1],n},_getNextNode:function(t){return t&&"BODY"!=t.tagName?t.nextSibling||this._getNextNode(nhn.DOMFix.parentNode(t)):this._document.body},_getPrevNode:function(t){return t&&"BODY"!=t.tagName?t.previousSibling||this._getPrevNode(nhn.DOMFix.parentNode(t)):this._document.body},_getNodesBetween:function(t,e){var n=[];if(this._nNodesBetweenLen=0,!t||!e)return n;try{this._recurGetNextNodesUntil(t,e,n)}catch(t){return[]}return n},_recurGetNextNodesUntil:function(t,e,n){if(!t)return!1;if(!this._recurGetChildNodesUntil(t,e,n))return!1;for(var i=t.nextSibling;!i;){if(!(t=nhn.DOMFix.parentNode(t)))return!1;if((n[this._nNodesBetweenLen++]=t)==e)return!1;i=t.nextSibling}return this._recurGetNextNodesUntil(i,e,n)},_recurGetChildNodesUntil:function(t,e,n){if(!t)return!1;var i=!1,r=t;if(r.firstChild)for(r=r.firstChild;r;){if(!this._recurGetChildNodesUntil(r,e,n)){i=!0;break}r=r.nextSibling}return n[this._nNodesBetweenLen++]=t,!i&&t!=e}}),nhn.W3CDOMRange.START_TO_START=0,nhn.W3CDOMRange.START_TO_END=1,nhn.W3CDOMRange.END_TO_END=2,nhn.W3CDOMRange.END_TO_START=3,nhn.HuskyRange=jindo.$Class({_rxCursorHolder:/^(?:\uFEFF|\u00A0|\u200B|<br>)$/i,_rxTextAlign:/text-align:[^"';]*;?/i,setWindow:function(t){this.reset(t||window)},$init:function(t){this.HUSKY_BOOMARK_START_ID_PREFIX="husky_bookmark_start_",this.HUSKY_BOOMARK_END_ID_PREFIX="husky_bookmark_end_",this.sBlockElement="P|DIV|LI|H[1-6]|PRE",this.sBlockContainer="BODY|TABLE|TH|TR|TD|UL|OL|BLOCKQUOTE|FORM",this.rxBlockElement=new RegExp("^("+this.sBlockElement+")$"),this.rxBlockContainer=new RegExp("^("+this.sBlockContainer+")$"),this.rxLineBreaker=new RegExp("^("+this.sBlockElement+"|"+this.sBlockContainer+")$"),this.rxHasBlock=new RegExp("(?:<(?:"+this.sBlockElement+"|"+this.sBlockContainer+").*?>|style=[\"']?[^>]*?(?:display\\s?:\\s?block)[^>]*?[\"']?)","i"),this.setWindow(t)},select:function(){try{this.oBrowserSelection.selectRange(this)}catch(t){}},setFromSelection:function(t){this.setRange(this.oBrowserSelection.getRangeAt(t),!0)},setRange:function(t,e){this.reset(this._window),this.setStart(t.startContainer,t.startOffset,e,!0),this.setEnd(t.endContainer,t.endOffset,e)},setEndNodes:function(t,e){this.reset(this._window),this.setEndAfter(e,!0),this.setStartBefore(t)},splitTextAtBothEnds:function(){this._splitTextEndNodesOfTheRange()},getStartNode:function(){return this.collapsed?3!=this.startContainer.nodeType||0===this.startOffset||this.startContainer.nodeValue.length<=this.startOffset?null:this.startContainer:3==this.startContainer.nodeType?this.startOffset>=this.startContainer.nodeValue.length?this._getNextNode(this.startContainer):this.startContainer:this.startOffset>=nhn.DOMFix.childNodes(this.startContainer).length?this._getNextNode(this.startContainer):nhn.DOMFix.childNodes(this.startContainer)[this.startOffset]},getEndNode:function(){return this.collapsed?this.getStartNode():3==this.endContainer.nodeType?0===this.endOffset?this._getPrevNode(this.endContainer):this.endContainer:0===this.endOffset?this._getPrevNode(this.endContainer):nhn.DOMFix.childNodes(this.endContainer)[this.endOffset-1]},getNodeAroundRange:function(t,e){if(!this.collapsed)return this.getStartNode();if(this.startContainer&&3==this.startContainer.nodeType)return this.startContainer;var n,i=this.startOffset>=nhn.DOMFix.childNodes(this.startContainer).length?this._getNextNode(this.startContainer):nhn.DOMFix.childNodes(this.startContainer)[this.startOffset],r=0===this.endOffset?this._getPrevNode(this.endContainer):nhn.DOMFix.childNodes(this.endContainer)[this.endOffset-1];return t?(n=r)||e||(n=i):(n=i)||e||(n=r),n},_getXPath:function(t){for(var e="";t&&1==t.nodeType;)e="/"+t.tagName+"["+this._getPosIdx4XPath(t)+"]"+e,t=nhn.DOMFix.parentNode(t);return e},_getPosIdx4XPath:function(t){for(var e=0,n=t.previousSibling;n;n=n.previousSibling)n.tagName==t.tagName&&e++;return e},_evaluateXPath:function(t,e){for(var n=(t=t.substring(1,t.length-1)).split(/\//),i=e.body,r=2;r<n.length&&i;r++){n[r].match(/([^[]+)\[(\d+)/i);for(var o=RegExp.$1,a=RegExp.$2,s=nhn.DOMFix.childNodes(i),h=[],l=s.length,u=0,c=0;c<l;c++)s[c].tagName==o&&(h[u++]=s[c]);i=h.length<a?null:h[a]}return i},_evaluateXPathBookmark:function(t){var e=t.sXPath,n=t.nTextNodeIdx,t=t.nOffset,e=this._evaluateXPath(e,this._document);if(-1<n&&e){for(var i,r=nhn.DOMFix.childNodes(e),o=n,a=t;(i=r[o])&&3==i.nodeType&&i.nodeValue.length<a;)a-=i.nodeValue.length,o++;e=nhn.DOMFix.childNodes(e)[o],t=a}return e||(e=this._document.body,t=0),{elContainer:e,nOffset:t}},getXPathBookmark:function(){var t=-1,e={elContainer:this.startContainer,nOffset:this.startOffset},n=this.startContainer;3==n.nodeType&&(e=this._getFixedStartTextNode(),t=this._getPosIdx(e.elContainer),n=nhn.DOMFix.parentNode(n));n=this._getXPath(n);return[{sXPath:n,nTextNodeIdx:t,nOffset:e.nOffset},this.collapsed?{sXPath:n,nTextNodeIdx:t,nOffset:e.nOffset}:(n=-1,t={elContainer:this.endContainer,nOffset:this.endOffset},3==(e=this.endContainer).nodeType&&(t=this._getFixedEndTextNode(),n=this._getPosIdx(t.elContainer),e=nhn.DOMFix.parentNode(e)),{sXPath:this._getXPath(e),nTextNodeIdx:n,nOffset:t.nOffset})]},moveToXPathBookmark:function(t){if(!t)return!1;var e=this._evaluateXPathBookmark(t[0]),t=this._evaluateXPathBookmark(t[1]);return e.elContainer&&t.elContainer?(this.startContainer=e.elContainer,this.startOffset=e.nOffset,this.endContainer=t.elContainer,this.endOffset=t.nOffset,!0):void 0},_getFixedTextContainer:function(t,e){for(;t&&3==t.nodeType&&t.previousSibling&&3==t.previousSibling.nodeType;)e+=t.previousSibling.nodeValue.length,t=t.previousSibling;return{elContainer:t,nOffset:e}},_getFixedStartTextNode:function(){return this._getFixedTextContainer(this.startContainer,this.startOffset)},_getFixedEndTextNode:function(){return this._getFixedTextContainer(this.endContainer,this.endOffset)},placeStringBookmark:function(){return this.collapsed||jindo.$Agent().navigator().ie||jindo.$Agent().navigator().firefox?this.placeStringBookmark_NonWebkit():this.placeStringBookmark_Webkit()},placeStringBookmark_NonWebkit:function(){var t=(new Date).getTime(),e=this.cloneRange();e.collapseToEnd();var n=this._document.createElement("SPAN");n.id=this.HUSKY_BOOMARK_END_ID_PREFIX+t,e.insertNode(n),(e=this.cloneRange()).collapseToStart();var i=this._document.createElement("SPAN");if(i.id=this.HUSKY_BOOMARK_START_ID_PREFIX+t,e.insertNode(i),jindo.$Agent().navigator().ie){try{i.innerHTML=unescape("%uFEFF")}catch(t){}try{n.innerHTML=unescape("%uFEFF")}catch(t){}}return this.moveToBookmark(t),t},placeStringBookmark_Webkit:function(){var t,e,n=(new Date).getTime(),i=this.cloneRange();i.collapseToEnd(),t=this._document.createTextNode(""),i.insertNode(t),e=t.parentNode,t.previousSibling&&"TD"==t.previousSibling.tagName&&(e=t.previousSibling,t=null);var r=this._document.createElement("SPAN");r.id=this.HUSKY_BOOMARK_END_ID_PREFIX+n,e.insertBefore(r,t),(i=this.cloneRange()).collapseToStart(),t=this._document.createTextNode(""),i.insertNode(t),e=t.parentNode,t.nextSibling&&"TD"==t.nextSibling.tagName&&(t=(e=t.nextSibling).firstChild);i=this._document.createElement("SPAN");return i.id=this.HUSKY_BOOMARK_START_ID_PREFIX+n,e.insertBefore(i,t),this.moveToBookmark(n),n},cloneRange:function(){return this._copyRange(new nhn.HuskyRange(this._window))},moveToBookmark:function(t){return"object"!=typeof t?this.moveToStringBookmark(t):this.moveToXPathBookmark(t)},getStringBookmark:function(t,e){return e?this._document.getElementById(this.HUSKY_BOOMARK_END_ID_PREFIX+t):this._document.getElementById(this.HUSKY_BOOMARK_START_ID_PREFIX+t)},moveToStringBookmark:function(t,e){var n=this.getStringBookmark(t),t=this.getStringBookmark(t,!0);return!(!n||!t)&&(this.reset(this._window),e?(this.setEndAfter(t),this.setStartBefore(n)):(this.setEndBefore(t),this.setStartAfter(n)),!0)},removeStringBookmark:function(t){this._removeAll(this.HUSKY_BOOMARK_START_ID_PREFIX+t),this._removeAll(this.HUSKY_BOOMARK_END_ID_PREFIX+t)},_removeAll:function(t){for(var e;e=this._document.getElementById(t);)e.parentNode.removeChild(e)},collapseToStart:function(){this.collapse(!0)},collapseToEnd:function(){this.collapse(!1)},createAndInsertNode:function(t){t=this._document.createElement(t);return this.insertNode(t),t},getNodes:function(t,e){t&&this._splitTextEndNodesOfTheRange();var n=this._getNodesInRange(),i=[];if(!e)return n;for(var r=0;r<n.length;r++)e(n[r])&&(i[i.length]=n[r]);return i},getTextNodes:function(t){return this.getNodes(t,function(t){return 3==t.nodeType&&"\n"!=t.nodeValue&&""!=t.nodeValue})},surroundContentsWithNewNode:function(t){t=this._document.createElement(t);return this.surroundContents(t),t},isRangeinRange:function(t,e){var n=this.compareBoundaryPoints(this.W3CDOMRange.START_TO_START,t),i=this.compareBoundaryPoints(this.W3CDOMRange.START_TO_END,t),r=this.compareBoundaryPoints(this.W3CDOMRange.ND_TO_START,t),t=this.compareBoundaryPoints(this.W3CDOMRange.END_TO_END,t);return n<=0&&0<=t||!!e&&(1!=i&&-1!=r)},isNodeInRange:function(t,e,n){var i=new nhn.HuskyRange(this._window);return n&&t.firstChild?(i.setStartBefore(t.firstChild),i.setEndAfter(t.lastChild)):i.selectNode(t),this.isRangeInRange(i,e)},pasteText:function(t){this.pasteHTML(t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/"/g,"&quot;"))},pasteHTML:function(t,e){var n=this._document.createElement("DIV");if(n.innerHTML=t,n.firstChild){var i=this.cloneRange(),r=i.placeStringBookmark(),o=i.getLineInfo(),a=o.oStart,o=o.oEnd;if(a.oLineBreaker&&"P"===a.oLineBreaker.nodeName&&(e||i.rxHasBlock.test(t))){var s=a.oLineBreaker.parentNode,t=a.oLineBreaker.nextSibling;i.deleteContents(),a.oLineBreaker===o.oLineBreaker&&(h=i.getStringBookmark(r),i.setEndNodes(h,o.oLineBreaker),h=(o=i.extractContents()).firstChild,t?s.insertBefore(o,t):s.appendChild(o),t=h),n.style.cssText=a.oLineBreaker.style.cssText.replace(this._rxTextAlign,""),n.align=a.oLineBreaker.align,t?s.insertBefore(n,t):s.appendChild(n),i.removeStringBookmark(r),this._removeEmptyP(this._getPrevElement(n));var h=this._getNextElement(n);h?(t=this._getNextElement(h))&&this._removeEmptyP(h)&&(h=t):((h=this._document.createElement("P")).style.cssText=a.oLineBreaker.style.cssText,h.align=a.oLineBreaker.align,s.appendChild(h)),""===h.innerHTML&&(h.innerHTML=jindo.$Agent().navigator().ie&&8<jindo.$Agent().navigator().version?"​":"\ufeff"),this.selectNodeContents(h),this.collapseToStart(),jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version<9&&(r=this.placeStringBookmark(),this.removeStringBookmark(r))}else{s=n.firstChild,h=n.lastChild;for(this.collapseToStart();n.lastChild;)this.insertNode(n.lastChild);this.setEndNodes(s,h),i.moveToBookmark(r),i.deleteContents(),i.removeStringBookmark(r)}}else this.deleteContents()},_removeEmptyP:function(t){if(t&&"P"===t.nodeName){var e=t.innerHTML;if(""===e||this._rxCursorHolder.test(e))return t.parentNode.removeChild(t),!0}},_getSiblingElement:function(t,e){if(!t)return null;var n=t[e?"previousSibling":"nextSibling"];return n&&1===n.nodeType?n:arguments.callee(n,e)},_getPrevElement:function(t){return this._getSiblingElement(t,!0)},_getNextElement:function(t){return this._getSiblingElement(t,!1)},toString:function(){return this.toString=nhn.W3CDOMRange.prototype.toString,this.toString()},toHTMLString:function(){var t=this._document.createElement("DIV");return t.appendChild(this.cloneContents()),t.innerHTML},findAncestorByTagName:function(t){for(var e=this.commonAncestorContainer;e&&e.tagName!=t;)e=nhn.DOMFix.parentNode(e);return e},selectNodeContents:function(t){var e;t&&(e=t.firstChild||t,t=t.lastChild||t,this.reset(this._window),3==e.nodeType?this.setStart(e,0,!0):this.setStartBefore(e),3==t.nodeType?this.setEnd(t,t.nodeValue.length,!0):this.setEndAfter(t))},_hasTextDecoration:function(t,e){return!(!t||!t.style)&&(-1<t.style.textDecoration.indexOf(e)||("underline"===e&&"U"===t.tagName||"line-through"===e&&("S"===t.tagName||"STRIKE"===t.tagName)))},_setTextDecoration:function(t,e){jindo.$Agent().navigator().firefox?t.style.textDecoration=t.style.textDecoration?t.style.textDecoration+" "+e:e:"underline"===e?t.innerHTML="<U>"+t.innerHTML+"</U>":"line-through"===e&&(t.innerHTML="<STRIKE>"+t.innerHTML+"</STRIKE>")},_checkTextDecoration:function(t){if("SPAN"===t.tagName){for(var e=!1,n=!1,i=null,r=t.firstChild;r;){if(1===r.nodeType&&(e=e||"U"===r.tagName,n=n||"S"===r.tagName||"STRIKE"===r.tagName),e&&n)return;r=r.nextSibling}for(i=nhn.DOMFix.parentNode(t);i&&"BODY"!==i.tagName;)if(1===i.nodeType){if(!e&&this._hasTextDecoration(i,"underline")&&(e=!0,this._setTextDecoration(t,"underline")),!n&&this._hasTextDecoration(i,"line-through")&&(n=!0,this._setTextDecoration(t,"line-through")),e&&n)return;i=nhn.DOMFix.parentNode(i)}else i=nhn.DOMFix.parentNode(i)}},styleRange:function(t,e,n,i,r){var o=this.aStyleParents=this._getStyleParentNodes(n,i);if(!(o.length<1)){for(var a,s,h,l=0;l<o.length;l++){for(h in t)"string"==typeof(s=t[a=h])&&(r&&t.color&&this._checkTextDecoration(o[l]),o[l].style[a]=s);if(e)for(h in e)"string"==typeof(s=e[a=h])&&("class"==a?jindo.$Element(o[l]).addClass(s):o[l].setAttribute(a,s))}this.reset(this._window),this.setStartBefore(o[0]),this.setEndAfter(o[o.length-1])}},expandBothEnds:function(){this.expandStart(),this.expandEnd()},expandStart:function(){var t;3==this.startContainer.nodeType&&0!==this.startOffset||(t=this._getActualStartNode(this.startContainer,this.startOffset),"BODY"==(t=this._getPrevNode(t)).tagName?this.setStartBefore(t):this.setStartAfter(t))},expandEnd:function(){var t;3==this.endContainer.nodeType&&this.endOffset<this.endContainer.nodeValue.length||(t=this._getActualEndNode(this.endContainer,this.endOffset),"BODY"==(t=this._getNextNode(t)).tagName?this.setEndAfter(t):this.setEndBefore(t))},_getStyleParentNodes:function(t,e){this._splitTextEndNodesOfTheRange();var n,i=this.getStartNode(),r=this.getEndNode(),o=this._getNodesInRange(),a=[],s=0,h=o.length,l=jindo.$A(o).filter(function(t){return!t.firstChild||e&&"LI"==t.tagName}),u=this.commonAncestorContainer;if(e)for(;u;){if("LI"==u.tagName){this._isFullyContained(u,l)&&(a[s++]=u);break}u=u.parentNode}for(var c=0;c<h;c++)if(n=o[c])if(e&&"LI"==n.tagName&&this._isFullyContained(n,l))a[s++]=n;else if(3==n.nodeType&&""!=n.nodeValue&&!n.nodeValue.match(/^(\r|\n)+$/)){var f=nhn.DOMFix.parentNode(n);if("SPAN"==f.tagName){if(this._isFullyContained(f,l,n)){a[s++]=f;continue}}else{var d=this._findParentSingleSpan(f);if(d){a[s++]=d;continue}}d=this._document.createElement("SPAN"),f.insertBefore(d,n),d.appendChild(n),a[s++]=d,t&&d.setAttribute(t,"true")}return this.setStartBefore(i),this.setEndAfter(r),a},_findParentSingleSpan:function(t){if(!t)return null;for(var e,n=0,i=0,r=t.childNodes;e=r[n];n++)if(e=e.nodeValue,!this._rxCursorHolder.test(e)&&1<++i)return null;return"SPAN"===t.nodeName?t:this._findParentSingleSpan(t.parentNode)},_isFullyContained:function(t,e,n){var i,r=this._getVeryFirstRealChild(t),o=n&&r==n?1:e.indexOf(r);return-1!=o&&(r=this._getVeryLastRealChild(t),i=n&&r==n?1:e.indexOf(r)),-1!=o&&-1!=i},_getVeryFirstChild:function(t){return t.firstChild?this._getVeryFirstChild(t.firstChild):t},_getVeryLastChild:function(t){return t.lastChild?this._getVeryLastChild(t.lastChild):t},_getFirstRealChild:function(t){for(var e=t.firstChild;e&&3==e.nodeType&&""==e.nodeValue;)e=e.nextSibling;return e},_getLastRealChild:function(t){for(var e=t.lastChild;e&&3==e.nodeType&&""==e.nodeValue;)e=e.previousSibling;return e},_getVeryFirstRealChild:function(t){var e=this._getFirstRealChild(t);return e?this._getVeryFirstRealChild(e):t},_getVeryLastRealChild:function(t){var e=this._getLastRealChild(t);return e?this._getVeryLastChild(e):t},_getLineStartInfo:function(t){var n=null,i=t,r=t,o=!1,a=this.rxLineBreaker;function e(t){if(t&&!n){if(a.test(t.tagName))return r=t,n=i,void(o=!0);(function t(e){if(!e)return;if(n)return;if(a.test(e.tagName))return r=e,n=i,void(o=!1);i=e;n||t(e.previousSibling)})((i=t).previousSibling),n||e(nhn.DOMFix.parentNode(t))}}return a.test(t.tagName)?n=t:e(t),{oNode:n,oLineBreaker:r,bParentBreak:o}},_getLineEndInfo:function(t){var n=null,i=t,r=t,o=!1,a=this.rxLineBreaker;function e(t){if(t&&!n){if(a.test(t.tagName))return r=t,n=i,void(o=!0);(function t(e){if(!e)return;if(n)return;if(a.test(e.tagName))return r=e,n=i,void(o=!1);i=e;n||t(e.nextSibling)})((i=t).nextSibling),n||e(nhn.DOMFix.parentNode(t))}}return a.test(t.tagName)?n=t:e(t),{oNode:n,oLineBreaker:r,bParentBreak:o}},getLineInfo:function(t){t=t||!1;var e=this.getStartNode(),n=this.getEndNode(),e=e||this.getNodeAroundRange(!t,!0),n=n||this.getNodeAroundRange(!t,!0),i=this._getLineStartInfo(e),r=i.oNode,o=this._getLineEndInfo(n),t=o.oNode;return e==r&&n==t||(r=this._compareEndPoint(nhn.DOMFix.parentNode(r),this._getPosIdx(r),this.endContainer,this.endOffset),t=this._compareEndPoint(nhn.DOMFix.parentNode(t),this._getPosIdx(t)+1,this.startContainer,this.startOffset),r<=0&&0<=t||(e=this.getNodeAroundRange(!1,!0),n=this.getNodeAroundRange(!1,!0),i=this._getLineStartInfo(e),o=this._getLineEndInfo(n))),{oStart:i,oEnd:o}},_findSingleChild:function(t){if(!t)return null;for(var e,n,i=null,r=0,o=0,a=t.childNodes;n=a[r];r++)if(e=n.nodeValue,!this._rxCursorHolder.test(e)&&(i=n,1<++o))return null;return i},_hasCursorHolderOnly:function(t){return!(!t||1!==t.nodeType)&&(!!this._rxCursorHolder.test(t.innerHTML)||this._hasCursorHolderOnly(this._findSingleChild(t)))}}).extend(nhn.W3CDOMRange),nhn.BrowserSelection=function(t){this.init=function(t){this._window=t||window,this._document=this._window.document},this.init(t),(this._document.createRange?nhn.BrowserSelectionImpl_FF:nhn.BrowserSelectionImpl_IE).apply(this),this.selectRange=function(t){this.selectNone(),this.addRange(t)},this.selectionLoaded=!0,this._oSelection||(this.selectionLoaded=!1)},nhn.BrowserSelectionImpl_FF=function(){this._oSelection=this._window.getSelection(),this.getRangeAt=function(t){t=t||0;try{var e=this._oSelection.getRangeAt(t)}catch(t){return new nhn.W3CDOMRange(this._window)}return this._FFRange2W3CRange(e)},this.addRange=function(t){t=this._W3CRange2FFRange(t);this._oSelection.addRange(t)},this.selectNone=function(){this._oSelection.removeAllRanges()},this.getCommonAncestorContainer=function(t){return this._W3CRange2FFRange(t).commonAncestorContainer},this.isCollapsed=function(t){return this._W3CRange2FFRange(t).collapsed},this.compareEndPoints=function(t,e,n,i){var r=this._document.createRange(),o=this._document.createRange();r.setStart(t,e),o.setStart(n,i),r.collapse(!0),o.collapse(!0);try{return r.compareBoundaryPoints(1,o)}catch(t){return 1}},this._FFRange2W3CRange=function(t){var e=new nhn.W3CDOMRange(this._window);return e.setStart(t.startContainer,t.startOffset,!0),e.setEnd(t.endContainer,t.endOffset,!0),e},this._W3CRange2FFRange=function(t){var e=this._document.createRange();return e.setStart(t.startContainer,t.startOffset),e.setEnd(t.endContainer,t.endOffset),e}},nhn.BrowserSelectionImpl_IE=function(){this._oSelection=this._document.selection,this.oLastRange={oBrowserRange:null,elStartContainer:null,nStartOffset:-1,elEndContainer:null,nEndOffset:-1},this._updateLastRange=function(t,e){this.oLastRange.oBrowserRange=t,this.oLastRange.elStartContainer=e.startContainer,this.oLastRange.nStartOffset=e.startOffset,this.oLastRange.elEndContainer=e.endContainer,this.oLastRange.nEndOffset=e.endOffset},this.getRangeAt=function(t){var e,n;return t=t||0,"Control"==this._oSelection.type?(e=new nhn.W3CDOMRange(this._window),(n=this._oSelection.createRange().item(t))&&n.ownerDocument==this._document&&e.selectNode(n),e):e=(n=(t=this._oSelection.createRange()).parentElement())&&n.ownerDocument==this._document?this._IERange2W3CRange(t):new nhn.W3CDOMRange(this._window)},this.addRange=function(t){this._W3CRange2IERange(t).select()},this.selectNone=function(){this._oSelection.empty()},this.getCommonAncestorContainer=function(t){return this._W3CRange2IERange(t).parentElement()},this.isCollapsed=function(t){var e=this._W3CRange2IERange(t),t=e.duplicate();return t.collapse(),e.isEqual(t)},this.compareEndPoints=function(t,e,n,i){var r,o;return t===this.oLastRange.elStartContainer&&e===this.oLastRange.nStartOffset?(r=this.oLastRange.oBrowserRange.duplicate()).collapse(!0):t===this.oLastRange.elEndContainer&&e===this.oLastRange.nEndOffset?(r=this.oLastRange.oBrowserRange.duplicate()).collapse(!1):r=this._getIERangeAt(t,e),n===this.oLastRange.elStartContainer&&i===this.oLastRange.nStartOffset?(o=this.oLastRange.oBrowserRange.duplicate()).collapse(!0):n===this.oLastRange.elEndContainer&&i===this.oLastRange.nEndOffset?(o=this.oLastRange.oBrowserRange.duplicate()).collapse(!1):o=this._getIERangeAt(n,i),r.compareEndPoints("StartToStart",o)},this._W3CRange2IERange=function(t){if(this.oLastRange.elStartContainer===t.startContainer&&this.oLastRange.nStartOffset===t.startOffset&&this.oLastRange.elEndContainer===t.endContainer&&this.oLastRange.nEndOffset===t.endOffset)return this.oLastRange.oBrowserRange;var e=this._getIERangeAt(t.startContainer,t.startOffset),n=this._getIERangeAt(t.endContainer,t.endOffset);return e.setEndPoint("EndToEnd",n),this._updateLastRange(e,t),e},this._getIERangeAt=function(t,e){var n=this._document.body.createTextRange(),i=this._getSelectableNodeAndOffsetForIE(t,e),t=i.oSelectableNodeForIE,e=i.iOffsetForIE;return n.moveToElementText(t),n.collapse(i.bCollapseToStart),n.moveStart("character",e),n},this._getSelectableNodeAndOffsetForIE=function(t,e){for(var n,i=null,r=null,o=0,o=3==t.nodeType?(i=nhn.DOMFix.parentNode(t),(r=nhn.DOMFix.childNodes(i)).length):(i=t,e<(r=nhn.DOMFix.childNodes(i)).length?e:r.length),a=0,s=!0,h=0;h<o;h++)if(3==(n=r[h]).nodeType){if(n==t)break;a+=n.nodeValue.length}else i=n,a=0,s=!1;return 3==t.nodeType&&(a+=e),{oSelectableNodeForIE:i,iOffsetForIE:a,bCollapseToStart:s}},this._IERange2W3CRange=function(t){var e,n=new nhn.W3CDOMRange(this._window),i=null;(i=t.duplicate()).collapse(!0),e=this._getW3CContainerAndOffset(i,!0),n.setStart(e.oContainer,e.iOffset,!0,!0);var r=t.duplicate();return r.collapse(!0),r.isEqual(t)?n.collapse(!0):((i=t.duplicate()).collapse(!1),e=this._getW3CContainerAndOffset(i),n.setEnd(e.oContainer,e.iOffset,!0)),this._updateLastRange(t,n),n},this._getW3CContainerAndOffset=function(t,e){for(var n,i=t,r=i.parentElement(),o=-1,a=this._document.body.createTextRange(),s=nhn.DOMFix.childNodes(r),h=null,l=0;l<s.length;l++)if(3!=s[l].nodeType){if(a.moveToElementText(s[l]),0<=a.compareEndPoints("StartToStart",t))break;h=s[l]}if(0!==(n=l)&&3==s[n-1].nodeType){var u=this._document.body.createTextRange(),c=null,c=h?(u.moveToElementText(h),u.collapse(!1),h.nextSibling):(u.moveToElementText(r),u.collapse(!0),r.firstChild),f=i.duplicate();f.setEndPoint("StartToStart",u);for(var d=f.text.replace(/[\r\n]/g,"").length;d>c.nodeValue.length&&c.nextSibling;)d-=c.nodeValue.length,c=c.nextSibling;c.nodeValue,e&&c.nextSibling&&3==c.nextSibling.nodeType&&d==c.nodeValue.length&&(d-=c.nodeValue.length,c=c.nextSibling),r=c,o=d}else r=i.parentElement(),o=n;return{oContainer:r,iOffset:o}}},nhn.DOMFix=new(jindo.$Class({$init:function(){jindo.$Agent().navigator().ie||jindo.$Agent().navigator().opera?(this.childNodes=this._childNodes_Fix,this.parentNode=this._parentNode_Fix):(this.childNodes=this._childNodes_Native,this.parentNode=this._parentNode_Native)},_parentNode_Native:function(t){return t.parentNode},_parentNode_Fix:function(t){if(!t)return t;for(;t.previousSibling;)t=t.previousSibling;return t.parentNode},_childNodes_Native:function(t){return t.childNodes},_childNodes_Fix:function(t){var e=null,n=0;if(t)for(e=[],t=t.firstChild;t;)t=(e[n++]=t).nextSibling;return e}}))},function(t,e){nhn.husky.CorePlugin=jindo.$Class({name:"CorePlugin",$AFTER_MSG_APP_READY:function(){this.oApp.exec("EXEC_ON_READY_FUNCTION",[])},$ON_ADD_APP_PROPERTY:function(t,e){this.oApp[t]=e},$ON_REGISTER_BROWSER_EVENT:function(t,e,n,i,r){this.oApp.registerBrowserEvent(t,e,n,i,r)},$ON_DISABLE_MESSAGE:function(t){this.oApp.disableMessage(t,!0)},$ON_ENABLE_MESSAGE:function(t){this.oApp.disableMessage(t,!1)},$ON_EXEC_ON_READY_FUNCTION:function(){"function"==typeof this.oApp.htRunOptions.fnOnAppReady&&this.oApp.htRunOptions.fnOnAppReady()}})},function(t,e){nhn.husky.HuskyRangeManager=jindo.$Class({name:"HuskyRangeManager",oWindow:null,$init:function(t){this.oWindow=t||window},$BEFORE_MSG_APP_READY:function(){this.oWindow&&"IFRAME"==this.oWindow.tagName&&(this.oWindow=this.oWindow.contentWindow,nhn.CurrentSelection.setWindow(this.oWindow)),this.oApp.exec("ADD_APP_PROPERTY",["getSelection",jindo.$Fn(this.getSelection,this).bind()]),this.oApp.exec("ADD_APP_PROPERTY",["getEmptySelection",jindo.$Fn(this.getEmptySelection,this).bind()])},$ON_SET_EDITING_WINDOW:function(t){this.oWindow=t},getEmptySelection:function(t){return new nhn.HuskyRange(t||this.oWindow)},getSelection:function(t){this.oApp.exec("RESTORE_IE_SELECTION",[]);t=this.getEmptySelection(t);try{t.setFromSelection()}catch(t){}return t}})},function(t,e){nhn.husky.SE2M_Menubar=jindo.$Class({name:"SE2M_Menubar",menubarArea:null,menubarTitle:null,menubarItem:null,_assignHTMLElements:function(t){this.container=jindo.$(t)||document,this.menubarArea=jindo.$$.getSingle(".menu_bar",t),this.menus=jindo.$$(">[class*=menu_]",this.menubarArea);for(var e=0;e<this.menus.length;e++)if(new RegExp("menu_([^ ]+)").test(this.menus[e].className))for(var n,i=RegExp.$1,r=jindo.$$("[class*=item_]",this.menus[e]),o=0;o<r.length;o++)new RegExp("item_([^ ]+)").test(r[o].className)&&(n=RegExp.$1,this.items[i+"_"+n]=r[o])},$init:function(t,e){this._options=e||{},this.items={},this._assignHTMLElements(t)},$ON_MSG_APP_READY:function(){},$ON_REGISTER_MENU_EVENT:function(t,e,n,i){t=jindo.$Element(this.items[t]);t&&this.oApp.registerBrowserEvent(t,e,n,i)}})},function(t,e){nhn.husky.SE_EditingAreaManager=jindo.$Class({name:"SE_EditingAreaManager",$init:function(t,e,n,i,r){this.sDefaultEditingMode=t,this.elContentsField=jindo.$(e),this.elEditingAreaContainer=jindo.$$.getSingle("div.container",r),this.fOnBeforeUnload=i,this.oEditingMode={},this.elContentsField.style.display="none"},$BEFORE_MSG_APP_READY:function(){},$ON_MSG_APP_READY:function(){},$AFTER_MSG_APP_READY:function(){},$ON_LOAD_CONTENTS_FIELD:function(t){var e=this.elContentsField.value;this.oApp.exec("SET_CONTENTS",[e,t])},$ON_UPDATE_CONTENTS_FIELD:function(){this.elContentsField.value=this.oApp.getContents()},$ON_UPDATE_RAW_CONTENTS:function(){this.sCurrentRawContents=this.oApp.getRawContents()},$BEFORE_CHANGE_EDITING_MODE:function(t){if(!this.oEditingMode[t])return!1;this.oPrevActivePlugin=this.oActivePlugin,this.oActivePlugin=this.oEditingMode[t]},$AFTER_CHANGE_EDITING_MODE:function(t,e){var n;this.oPrevActivePlugin&&(n=this.oPrevActivePlugin.getIR(),this.oApp.exec("SET_IR",[n]),this._setEditingAreaDimension()),e||this.oApp.delayedExec("FOCUS",[],0)},$ON_REGISTER_EDITING_AREA:function(t){this.oEditingMode[t.mode]=t},$ON_EVENT_EDITING_AREA_KEYDOWN:function(){},$ON_EVENT_EDITING_AREA_MOUSEDOWN:function(){},$ON_EVENT_EDITING_AREA_SCROLL:function(){},attachDocumentEvents:function(t){this.oApp.registerBrowserEvent(t,"click","EVENT_EDITING_AREA_CLICK"),this.oApp.registerBrowserEvent(t,"dblclick","EVENT_EDITING_AREA_DBLCLICK"),this.oApp.registerBrowserEvent(t,"mousedown","EVENT_EDITING_AREA_MOUSEDOWN"),this.oApp.registerBrowserEvent(t,"mousemove","EVENT_EDITING_AREA_MOUSEMOVE"),this.oApp.registerBrowserEvent(t,"mouseup","EVENT_EDITING_AREA_MOUSEUP"),this.oApp.registerBrowserEvent(t,"mouseout","EVENT_EDITING_AREA_MOUSEOUT"),this.oApp.registerBrowserEvent(t,"mousewheel","EVENT_EDITING_AREA_MOUSEWHEEL"),this.oApp.registerBrowserEvent(t,"keydown","EVENT_EDITING_AREA_KEYDOWN"),this.oApp.registerBrowserEvent(t,"keypress","EVENT_EDITING_AREA_KEYPRESS"),this.oApp.registerBrowserEvent(t,"keyup","EVENT_EDITING_AREA_KEYUP"),this.oApp.registerBrowserEvent(t,"scroll","EVENT_EDITING_AREA_SCROLL")},getRawContents:function(){return this.oActivePlugin?this.oActivePlugin.getRawContents():""},getContents:function(){},setContents:function(t,e){},getEditingMode:function(){return this.oActivePlugin.sMode},getEditingAreaWidth:function(){return this.elEditingAreaContainer.offsetWidth},getEditingAreaHeight:function(){return this.elEditingAreaContainer.offsetHeight},getWindow:function(){return window},getDocument:function(){return document}})},function(t,e){nhn.husky.SE_EditingArea_Canvas=jindo.$Class({type:"CANVAS",name:"SE_EditingArea_Canvas",$init:function(t){this.appContainer=t,this.menuBar=t.querySelector("#menuBar"),this.toolBar=t.querySelector("#toolBar"),this.statusBar=t.querySelector("#statusBar");var e=this.container=t.querySelector(".container"),t=this.document=e.querySelector(".document"),e=(this.ruler=e.querySelector(".ruler"),this.editingArea=t.querySelector(".editing_area"));this.scrollView=t.querySelector("#scrollView"),this.scrollViewHorizontal=t.querySelector("#scrollViewHorizontal"),this.scrollViewVertical=t.querySelector("#scrollViewVertical"),this.editCanvas=e.querySelector("#editCanvas"),this.doc=hwp.doc(),this.RATIO=3.78,this.documentWidth=Math.floor(210*this.RATIO),this.documentHeight=Math.floor(297*this.RATIO),this.documentMargin=20,this.paddingTop=Math.floor(20*this.RATIO),this.paddingBottom=Math.floor(15*this.RATIO),this.paddingLeft=Math.floor(30*this.RATIO),this.paddingRight=Math.floor(30*this.RATIO),this.paddingHead=Math.floor(15*this.RATIO),this.paddingTail=Math.floor(15*this.RATIO),this.offsetX=0,this.offsetY=0},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("REGISTER_EDITING_AREA",[this])},$ON_MSG_APP_READY:function(){this.oApp.registerBrowserEvent(this.scrollView,"scroll","EVENT_SCROLL_VIEW_SCROLL",[],null,10),this.oApp.registerBrowserEvent(window,"resize","EVENT_WINDOW_RESIZE",[],null,100)},$AFTER_MSG_APP_READY:function(){this.oApp.exec("EVENT_WINDOW_RESIZE")},$ON_EVENT_SCROLL_VIEW_SCROLL:function(){this.oApp.exec("EDITING_AREA_PAINT")},$ON_EVENT_WINDOW_RESIZE:function(){this.editingArea.style.width="100%",this.editingArea.style.height=this.appContainer.clientHeight-(this.menuBar.clientHeight+this.toolBar.clientHeight+this.ruler.clientHeight+this.statusBar.clientHeight)+"px",this.scrollView.style.width=this.editingArea.clientWidth+"px",this.scrollView.style.height=this.editingArea.clientHeight+"px",this.oApp.exec("EDITING_AREA_PAINT"),this.oApp.exec("POSITION_CENTER")},$ON_PASTE_HTML:function(t,e,n){this.oApp.exec("EVENT_WINDOW_RESIZE")},$ON_POSITION_CENTER:function(){var t=this.editingArea.clientWidth;this.editingArea.clientHeight;this.documentWidth>t&&(this.scrollView.scrollLeft=(this.documentWidth+2*this.documentMargin-t)/2)},$ON_EDITING_AREA_PAINT:function(){console.log("$ON_EDITING_AREA_PAINT is called...");var t=this.editingArea.clientWidth,e=this.editingArea.clientHeight;this.offsetX=(t-this.documentWidth)/2,this.offsetY=(e-this.documentHeight)/2,this.offsetX<0&&(this.offsetX=0),this.offsetY<0&&(this.offsetY=0),this.offsetX+=this.documentMargin,this.offsetY+=this.documentMargin;var n=Math.max(1,window.devicePixelRatio||1),t=Math.max(this.documentWidth,t),e=Math.min(this.documentHeight,e)-16;this.editCanvas.width=n*t,this.editCanvas.height=n*e,this.editCanvas.style.width=t+"px",this.editCanvas.style.height=e+"px",this.scrollViewHorizontal.style.width=t+"px",this.scrollViewVertical.style.height=this.documentHeight+"px";e=this.editCanvas.getContext("2d");e.scale(n,n),e.translate(-this.scrollView.scrollLeft,-this.scrollView.scrollTop),e.clearRect(0,0,t,this.documentHeight),e.fillStyle="white",e.fillRect(this.offsetX,this.offsetY,this.documentWidth,this.documentHeight),this._drawPaddingMark(e);e=this.documentWidth-(this.paddingLeft+this.paddingRight),this.documentHeight,this.paddingTop,this.paddingHead,this.paddingBottom,this.paddingTail;this.doc.layout(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead,e)},_drawPaddingMark:function(t){t.beginPath(),t.strokeStyle="#c5c5c5",t.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead),t.lineTo(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead-20),t.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead),t.lineTo(this.offsetX+this.paddingLeft-20,this.offsetY+this.paddingTop+this.paddingHead),t.moveTo(this.offsetX+this.documentWidth-this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead),t.lineTo(this.offsetX+this.documentWidth-this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead-20),t.moveTo(this.offsetX+this.documentWidth-this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead),t.lineTo(this.offsetX+this.documentWidth-this.paddingLeft+20,this.offsetY+this.paddingTop+this.paddingHead),t.moveTo(this.offsetX+this.documentWidth-this.paddingRight,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail),t.lineTo(this.offsetX+this.documentWidth-this.paddingRight,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail+20),t.moveTo(this.offsetX+this.documentWidth-this.paddingRight,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail),t.lineTo(this.offsetX+this.documentWidth-this.paddingRight+20,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail),t.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail),t.lineTo(this.offsetX+this.paddingLeft,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail+20),t.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail),t.lineTo(this.offsetX+this.paddingLeft-20,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail),t.stroke()},$ON_EDITING_AREA_UPDATE:function(){}})},function(t,e,n){t.exports=i;var u=n(8).EventEmitter;function i(){u.call(this)}n(3)(i,u),i.Readable=n(9),i.Writable=n(37),i.Duplex=n(38),i.Transform=n(39),i.PassThrough=n(40),(i.Stream=i).prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",r),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",s));var o=!1;function a(){o||(o=!0,e.end())}function s(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function h(t){if(l(),0===u.listenerCount(this,"error"))throw t}function l(){n.removeListener("data",i),e.removeListener("drain",r),n.removeListener("end",a),n.removeListener("close",s),n.removeListener("error",h),e.removeListener("error",h),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",h),e.on("error",h),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),t=e[0],e=e[1];return 3*(t+e)/4-e},e.toByteArray=function(t){var e,n,i=u(t),r=i[0],i=i[1],o=new l(function(t,e){return 3*(t+e)/4-e}(r,i)),a=0,s=0<i?r-4:r;for(n=0;n<s;n+=4)e=h[t.charCodeAt(n)]<<18|h[t.charCodeAt(n+1)]<<12|h[t.charCodeAt(n+2)]<<6|h[t.charCodeAt(n+3)],o[a++]=e>>16&255,o[a++]=e>>8&255,o[a++]=255&e;2===i&&(e=h[t.charCodeAt(n)]<<2|h[t.charCodeAt(n+1)]>>4,o[a++]=255&e);1===i&&(e=h[t.charCodeAt(n)]<<10|h[t.charCodeAt(n+1)]<<4|h[t.charCodeAt(n+2)]>>2,o[a++]=e>>8&255,o[a++]=255&e);return o},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,r=[],o=0,a=n-i;o<a;o+=16383)r.push(function(t,e,n){for(var i,r=[],o=e;o<n;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),r.push(function(t){return s[t>>18&63]+s[t>>12&63]+s[t>>6&63]+s[63&t]}(i));return r.join("")}(t,o,a<o+16383?a:o+16383));1==i?(e=t[n-1],r.push(s[e>>2]+s[e<<4&63]+"==")):2==i&&(e=(t[n-2]<<8)+t[n-1],r.push(s[e>>10]+s[e>>4&63]+s[e<<2&63]+"="));return r.join("")};for(var s=[],h=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,o=i.length;r<o;++r)s[r]=i[r],h[i.charCodeAt(r)]=r;function u(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");t=t.indexOf("=");return[t=-1===t?e:t,t===e?0:4-t%4]}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,i,r){var o,a,s=8*r-i-1,h=(1<<s)-1,l=h>>1,u=-7,c=n?r-1:0,f=n?-1:1,n=t[e+c];for(c+=f,o=n&(1<<-u)-1,n>>=-u,u+=s;0<u;o=256*o+t[e+c],c+=f,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;0<u;a=256*a+t[e+c],c+=f,u-=8);if(0===o)o=1-l;else{if(o===h)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,i),o-=l}return(n?-1:1)*a*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var a,s,h=8*o-r-1,l=(1<<h)-1,u=l>>1,c=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,o=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(i=Math.pow(2,-a))<1&&(a--,i*=2),2<=(e+=1<=a+u?c/i:c*Math.pow(2,1-u))*i&&(a++,i/=2),l<=a+u?(s=0,a=l):1<=a+u?(s=(e*i-1)*Math.pow(2,r),a+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,r),a=0));8<=r;t[n+f]=255&s,f+=d,s/=256,r-=8);for(a=a<<r|s,h+=r;0<h;t[n+f]=255&a,f+=d,a/=256,h-=8);t[n+f-d]|=128*o}},function(t,e){},function(t,e,n){"use strict";var a=n(7).Buffer,i=n(32);function r(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.head=null,this.tail=null,this.length=0}t.exports=(r.prototype.push=function(t){t={data:t,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},r.prototype.unshift=function(t){t={data:t,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},r.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},r.prototype.concat=function(t){if(0===this.length)return a.alloc(0);if(1===this.length)return this.head.data;for(var e,n,i=a.allocUnsafe(t>>>0),r=this.head,o=0;r;)e=r.data,n=o,e.copy(i,n),o+=r.data.length,r=r.next;return i},r),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,r,o){!function(t){var e=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}r.setTimeout=function(){return new i(n.call(setTimeout,e,arguments),clearTimeout)},r.setInterval=function(){return new i(n.call(setInterval,e,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(e,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},o(34),r.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,r.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}.call(this,o(1))},function(t,e,n){!function(t,d){!function(n,i){"use strict";var r,o,a,s,h,l,e,t;function u(t){delete o[t]}function c(t){if(a)setTimeout(c,0,t);else{var e=o[t];if(e){a=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}(e)}finally{u(t),a=!1}}}}function f(){function t(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(e)&&c(+t.data.slice(e.length))}var e="setImmediate$"+Math.random()+"$";n.addEventListener?n.addEventListener("message",t,!1):n.attachEvent("onmessage",t),h=function(t){n.postMessage(e+t,"*")}}n.setImmediate||(r=1,a=!(o={}),s=n.document,t=(t=Object.getPrototypeOf&&Object.getPrototypeOf(n))&&t.setTimeout?t:n,"[object process]"==={}.toString.call(n.process)?h=function(t){d.nextTick(function(){c(t)})}:!function(){if(n.postMessage&&!n.importScripts){var t=!0,e=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=e,t}}()?h=n.MessageChannel?((e=new MessageChannel).port1.onmessage=function(t){c(t.data)},function(t){e.port2.postMessage(t)}):s&&"onreadystatechange"in s.createElement("script")?(l=s.documentElement,function(t){var e=s.createElement("script");e.onreadystatechange=function(){c(t),e.onreadystatechange=null,l.removeChild(e),e=null},l.appendChild(e)}):function(t){setTimeout(c,0,t)}:f(),t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];return o[r]={callback:t,args:e},h(r),r++},t.clearImmediate=u)}("undefined"==typeof self?void 0===t?this:t:self)}.call(this,n(1),n(5))},function(t,e,n){!function(e){function i(t){try{if(!e.localStorage)return}catch(t){return}t=e.localStorage[t];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}.call(this,n(1))},function(t,e,n){"use strict";t.exports=r;var i=n(17),t=Object.create(n(4));function r(t){if(!(this instanceof r))return new r(t);i.call(this,t)}t.inherits=n(3),t.inherits(r,i),r.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(10)},function(t,e,n){t.exports=n(2)},function(t,e,n){t.exports=n(9).Transform},function(t,e,n){t.exports=n(9).PassThrough},function(t,e){nhn.husky.Utils=jindo.$Class({name:"Utils",$init:function(){var t=jindo.$Agent().navigator();if(t.ie&&6==t.version)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["htBrowser",jindo.$Agent().navigator()])},$ON_ATTACH_HOVER_EVENTS:function(t,e){var n=(e=e||[]).sHoverClass||"hover",i=e.fnElmToSrc||function(t){return t},r=e.fnElmToTarget||function(t){return t};if(t)for(var o=jindo.$Fn(function(t){jindo.$Element(r(t.currentElement)).addClass(n)},this),a=jindo.$Fn(function(t){jindo.$Element(r(t.currentElement)).removeClass(n)},this),s=0,h=t.length;s<h;s++){var l=i(t[s]);o.attach(l,"mouseover"),a.attach(l,"mouseout"),o.attach(l,"focus"),a.attach(l,"blur")}}})},function(t,e){nhn.husky.StringConverterManager=jindo.$Class({name:"StringConverterManager",oConverters:null,$init:function(){this.oConverters={},this.oConverters_DOM={},this.oAgent=jindo.$Agent().navigator()},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["applyConverter",jindo.$Fn(this.applyConverter,this).bind()]),this.oApp.exec("ADD_APP_PROPERTY",["addConverter",jindo.$Fn(this.addConverter,this).bind()]),this.oApp.exec("ADD_APP_PROPERTY",["addConverter_DOM",jindo.$Fn(this.addConverter_DOM,this).bind()])},applyConverter:function(t,e,n){var i,r="@"+(new Date).getTime()+"@",o=new RegExp(r,"g"),a={sContents:r+e};if(n=n||document,this.oApp.exec("MSG_STRING_CONVERTER_STARTED",[t,a]),e=a.sContents,i=this.oConverters_DOM[t]){var s=n.createElement("div");s.innerHTML=e;for(var h=0;h<i.length;h++)i[h](s);e=s.innerHTML,s.parentNode&&s.parentNode.removeChild(s),s=null,jindo.$Agent().navigator().ie&&(r+="(\r\n)?",o=new RegExp(r,"g"))}if(i=this.oConverters[t])for(h=0;h<i.length;h++){var l=i[h](e);void 0!==l&&(e=l)}return this.oApp.exec("MSG_STRING_CONVERTER_ENDED",[t,a={sContents:e}]),a.sContents=a.sContents.replace(o,""),a.sContents},$ON_ADD_CONVERTER:function(t,e){var n=this.oApp.aCallerStack;e.sPluginName=n[n.length-2].name,this.addConverter(t,e)},$ON_ADD_CONVERTER_DOM:function(t,e){var n=this.oApp.aCallerStack;e.sPluginName=n[n.length-2].name,this.addConverter_DOM(t,e)},addConverter:function(t,e){this.oConverters[t]||(this.oConverters[t]=[]),this.oConverters[t][this.oConverters[t].length]=e},addConverter_DOM:function(t,e){this.oConverters_DOM[t]||(this.oConverters_DOM[t]=[]),this.oConverters_DOM[t][this.oConverters_DOM[t].length]=e}})},function(t,e){var n,i,r,o,a,s;void 0===window.nhn&&(window.nhn={}),nhn.husky||(nhn.husky={}),n=navigator.userAgent,i=jindo.$Agent(),r=i.navigator(),o=i.os(),2===(i=n.match(/(SHW-|Chrome|Safari)/gi)||"").length&&"SHW-"===i[0]&&"Safari"===i[1]?r.bGalaxyBrowser=!0:-1<n.indexOf("LG-V500")&&-1<n.indexOf("Version/4.0")&&(r.bGPadBrowser=!0),void 0===o.ios&&(o.ios=-1<n.indexOf("iPad")||-1<n.indexOf("iPhone"),o.ios&&null!=(i=n.match(/(iPhone )?OS ([\d|_]+)/))&&null!=i[2]&&(o.version=String(i[2]).split("_").join("."))),nhn.husky.SE2M_UtilPlugin=jindo.$Class({name:"SE2M_UtilPlugin",$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["oAgent",jindo.$Agent()]),this.oApp.exec("ADD_APP_PROPERTY",["oNavigator",jindo.$Agent().navigator()]),this.oApp.exec("ADD_APP_PROPERTY",["oUtils",this])},$ON_REGISTER_HOTKEY:function(t,e,n,i){this.oApp.exec("ADD_HOTKEY",[t,e,n,i||this.oApp.getWYSIWYGDocument()])},$ON_SE2_ATTACH_HOVER_EVENTS:function(t){this.oApp.exec("ATTACH_HOVER_EVENTS",[t,{fnElmToSrc:this._elm2Src,fnElmToTarget:this._elm2Target}])},_elm2Src:function(t){return"LI"==t.tagName&&t.firstChild&&"BUTTON"==t.firstChild.tagName?t.firstChild:t},_elm2Target:function(t){return"BUTTON"==t.tagName&&"LI"==t.parentNode.tagName?t.parentNode:t},getScrollXY:function(){var t,e=this.oApp.getWYSIWYGWindow(),e=void 0===e.scrollX?(t=e.document.documentElement.scrollLeft,e.document.documentElement.scrollTop):(t=e.scrollX,e.scrollY);return{x:t,y:e}}}),nhn.husky.SE2M_Utils={sURLPattern:"(http|https|ftp|mailto):(?:\\/\\/)?((:?\\w|-)+(:?\\.(:?\\w|-)+)+)([^ <>]+)?",rxDateFormat:/^(?:\d{4}\.)?\d{1,2}\.\d{1,2}$/,_rxTable:/^(?:CAPTION|TBODY|THEAD|TFOOT|TR|TD|TH|COLGROUP|COL)$/i,_rxSpaceOnly:/^\s+$/,_rxFontStart:/<font(?:\s+[^>]*)?>/i,_rxFontStrip:/<\/?font(?:\s+[^>]*)?>/gi,_bUnderIE8:jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version<9,_htFontSize:{1:"7pt",2:"10pt",3:"12pt",4:"13.5pt",5:"18pt",6:"24pt",7:"36pt"},isInvalidNodeInTable:function(t){if(t&&!this._rxTable.test(t.nodeName)){var e;if((e=t.previousSibling)&&this._rxTable.test(e.nodeName))return!0;if((e=t.nextSibling)&&this._rxTable.test(e.nodeName))return!0}return!1},removeInvalidNodeInTable:function(t){this.isInvalidNodeInTable(t)&&t.parentNode&&t.parentNode.removeChild(t)},removeInvalidFont:function(t){t&&(this._removeInvalidFontInTable(t),this._removeEmptyFont(t))},_removeInvalidFontInTable:function(t){for(var e,n=jindo.$$("table font",t),i=0;e=n[i];i++)this.removeInvalidNodeInTable(e)},_removeEmptyFont:function(t){for(var e,n=jindo.$$("font",t),i=0;e=n[i];i++)(e.innerHTML||"").replace(this._rxSpaceOnly,"")||e.parentNode.removeChild(e)},convertFontToSpan:function(t){if(t){for(var e,n,i,r=t.ownerDocument||document,o=jindo.$$("font",t),a=0;e=o[a];a++)("SPAN"!==(n=e.parentNode).tagName||1<n.childNodes.length)&&(n=r.createElement("SPAN"),e.parentNode.insertBefore(n,e)),(i=e.getAttribute("face"))&&(n.style.fontFamily=i),(i=this._htFontSize[e.getAttribute("size")])&&(n.style.fontSize=i),(i=e.getAttribute("color"))&&(n.style.color=i),this._switchFontInnerToSpan(e,n),e.parentNode&&e.parentNode.removeChild(e);0<a&&this._bUnderIE8&&(t.innerHTML=t.innerHTML.replace(this._rxFontStrip,""))}},_switchFontInnerToSpan:function(t,e){var n,i=t.innerHTML;if(this._rxFontStart.test(i)||this._bUnderIE8)for(;n=t.firstChild;)e.appendChild(n);else e.innerHTML=i},stripTag:function(t){for(var e;e=t.firstChild;)t.parentNode.insertBefore(e,t);t.parentNode.removeChild(t)},stripTags:function(t,e){for(var n,i=jindo.$$(e,t),r=0;n=i[r];r++)this.stripTag(n)},reviseDateFormat:function(t){return t=t&&t.replace?t.replace(this.rxDateFormat,"$&."):t},getCustomCSS:function(t,e,n){var i=[];if(void 0===t||void 0===e||!t||!e)return i;e=t.match(e);return e&&e[0]&&e[1]&&(n?i=e[1].split(n):i[0]=e[1]),i},toStringSamePropertiesOfArray:function(t,e,n){if(!t)return"";if(t instanceof Array){for(var i=[],r=0;r<t.length;r++)i.push(t[r][e]);return i.join(",").replace(/,/g,n)}return void 0===t[e]?"":"string"==typeof t[e]?t[e]:void 0},makeArray:function(t){if(null==t)return[];if(t instanceof Array)return t;var e=[];return e.push(t),e},ellipsis:function(t,e,n,i){n=n||"...",void 0===i&&(i=1);var r=jindo.$Element(t),o=jindo.$Element(e),a=r.html(),s=a.length,h=o.height(),l=0;r.html("A");var u=o.height();if(h<u*(i+.5))return r.html(a);for(h=u;h<u*(i+.5);)l+=Math.max(Math.ceil((s-l)/2),1),r.html(a.substring(0,l)+n),h=o.height();for(;u*(i+.5)<h;)r.html(a.substring(0,--l)+n),h=o.height()},ellipsisByPixel:function(t,e,n,i){e=e||"...";var r=jindo.$Element(t);if(!((h=r.width())<n)){var o=r.html(),a=o.length,s=0;if(void 0===i){for(var h=r.html("A").width();h<n;)s+=Math.max(Math.ceil((a-s)/2),1),r.html(o.substring(0,s)+e),h=r.width();i=function(){return!0}}for(s=r.html().length-e.length;n<h&&i();)r.html(o.substring(0,--s)+e),h=r.width()}},ellipsisElementsToDesinatedWidth:function(t,n,i,r){jindo.$A(t).forEach(function(t,e){t||jindo.$A.Continue(),nhn.husky.SE2M_Utils.ellipsisByPixel(t,n,i[e],r)})},paddingZero:function(t,e){for(var n=t.toString();n.length<e;)n="0"+n;return n},cutStringToByte:function(t,e,n){if(null===t||0===t.length)return t;n||""==n||(n="...");for(var i=e,r=0,o=(t=t.replace(/  +/g," ")).length,a=0;a<o;a++){if((r+=this.getCharByte(t.charAt(a)))==i)return a==o-1?t:t.substring(0,a)+n;if(i<r)return t.substring(0,a)+n}return t},getCharByte:function(t){if(null===t||t.length<1)return 0;var e=0,t=escape(t);return 1==t.length?e++:-1!=t.indexOf("%u")?e+=2:-1!=t.indexOf("%")&&(e+=t.length/3),e},getFilteredHashTable:function(t,e){if(!(e instanceof Array))return arguments.callee.call(this,t,[e]);var n=jindo.$A(e);return jindo.$H(t).filter(function(t,e){return!(!n.has(e)||!t)}).$value()},isBlankNode:function(t){function i(t){return!t||(!!r(t)||("BR"==t.tagName||("&nbsp;"==t.innerHTML||""==t.innerHTML)))}function e(t){if("IMG"!=t.tagName&&"IFRAME"!=t.tagName){if(i(t))return 1;if("P"==t.tagName){for(var e=t.childNodes.length-1;0<=e;e--){var n=t.childNodes[e];r(n)&&n.parentNode.removeChild(n)}if(1==t.childNodes.length){if("IMG"==t.firstChild.tagName||"IFRAME"==t.firstChild.tagName)return;if(i(t.firstChild))return 1}}}}var r=this.isBlankTextNode;if(e(t))return!0;for(var n=0,o=t.childNodes.length;n<o;n++)if(!e(t.childNodes[n]))return!1;return!0},isBlankTextNode:function(t){return 3==t.nodeType&&""==t.nodeValue.replace(unescape("%uFEFF"),"")},isFirstChildOfNode:function(t,e,n){return!!n&&(n.tagName==e&&n.firstChild.tagName==t)},findAncestorByTagName:function(t,e){for(;e&&e.tagName!=t;)e=e.parentNode;return e},findAncestorByTagNameWithCount:function(t,e){for(var n=0;e&&e.tagName!=t;)e=e.parentNode,n+=1;return{elNode:e,nRecursiveCount:n}},findClosestAncestorAmongTagNames:function(t,e){for(var n=new RegExp("^("+t.join("|")+")$","i");e&&!n.test(e.tagName);)e=e.parentNode;return e},findClosestAncestorAmongTagNamesWithCount:function(t,e){for(var n=0,i=new RegExp("^("+t.join("|")+")$","i");e&&!i.test(e.tagName);)e=e.parentNode,n+=1;return{elNode:e,nRecursiveCount:n}},isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},deleteProperty:function(t,e){if("object"==typeof t&&"string"==typeof e&&void 0!==t[e]){t[e]=void 0;try{delete t[e]}catch(t){}}},loadCSS:function(t,e){var n=document,i=n.getElementsByTagName("HEAD")[0],r=n.createElement("LINK");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",t),e&&("onload"in r?r.onload=function(){e(),this.onload=null}:r.onreadystatechange=function(){"complete"==r.readyState&&(r.getAttribute("_complete")||(r.setAttribute("_complete",!0),e()))}),i.appendChild(r)},getUniqueId:function(t){return(t||"")+jindo.$Date().time()+(1e5*Math.random()).toFixed()},clone:function(t,e){if(void 0===t||!t||t.constructor!=Array&&t.constructor!=Object)return t;var n,i=t.constructor==Array?[]:{};for(n in t)void 0!==e&&e[n]?i[n]=arguments.callee(e[n]):i[n]=arguments.callee(t[n]);return i},getHtmlTagAttr:function(t,e){t=new RegExp("\\s"+e+"=('([^']*)'|\"([^\"]*)\"|([^\"' >]*))","i").exec(t);if(!t)return"";t=t[1]||t[2]||t[3];return t=t&&t.replace(/["]/g,"")},iframeAlignConverter:function(t,e){var n,i=t.tagName.toUpperCase();"DIV"!=i&&"P"!=i||null!==t.parentNode&&(n=e,e=(i=jindo.$Element(t)).html(),t=jindo.$Element(t).attr("align")||jindo.$Element(t).css("text-align"),(n=jindo.$Element(jindo.$("<div></div>",n))).html(e).attr("align",t),i.replace(n))},getJsonDatafromXML:function(t){function d(t){return void 0===t?"":t.replace(/&[a-z]+;/g,function(t){return"string"==typeof n[t]?n[t]:t})}function p(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&!Object.prototype[e])return;return 1}var e={},g=/^[0-9]+(?:\.[0-9]+)?$/,_=/^\s+$/g,n={"&amp;":"&","&nbsp;":" ","&quot;":'"',"&lt;":"<","&gt;":">"},y={tags:["/"],stack:[e]};return(t=t.replace(/<(\?|!-)[^>]*>/g,"")).replace(/\s*<(\/?[\w:-]+)((?:\s+[\w:-]+\s*=\s*(?:"(?:\\"|[^"])*"|'(?:\\'|[^'])*'))*)\s*((?:\/>)|(?:><\/\1>|\s*))|\s*<!\[CDATA\[([\w\W]*?)\]\]>\s*|\s*>?([^<]*)/gi,function(t,e,n,i,r,o){var a,s,h,l,u,c="",f=y.stack.length-1;"string"==typeof e&&e?"/"!=e.substr(0,1)?(s="string"==typeof i&&i,h=!(a="string"==typeof n&&n)&&s?"":{},l=void 0===(l=y.stack[f])[e]?(l[e]=h,y.stack[1+f]=l[e]):l[e]instanceof Array?(i=l[e].length,l[e][i]=h,y.stack[1+f]=l[e][i]):(l[e]=[l[e],h],y.stack[1+f]=l[e][1]),a&&(u=l,n.replace(/([\w:-]+)\s*=\s*(?:"((?:\\"|[^"])*)"|'((?:\\'|[^'])*)')/g,function(t,e,n,i){u[e]=d((n?n.replace(/\\"/g,'"'):void 0)||(i?i.replace(/\\'/g,"'"):void 0))})),y.tags[1+f]=e,s&&(y.tags.length--,y.stack.length--)):(y.tags.length--,y.stack.length--):"string"==typeof r&&r?c=r:"string"==typeof o&&o.replace(_,"")&&(c=d(o)),0<c.length&&(r=y.stack[f-1],o=y.tags[f],g.test(c)||"true"!=c&&"false"!=c||(c=new Boolean(c)),void 0!==r&&(r[o]instanceof Array?"object"!=typeof(f=r[o])[f.length-1]||p(f[f.length-1])?f[f.length-1]=c:(f[f.length-1].$cdata=c,f[f.length-1].toString=function(){return c}):"object"!=typeof r[o]||p(r[o])?r[o]=c:(r[o].$cdata=c,r[o].toString=function(){return c})))}),jindo.$Json(e)},replaceSpecialChar:function(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},restoreSpecialChar:function(t){return"string"==typeof t?t.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"):""}},nhn.husky.AutoResizer=jindo.$Class({welHiddenDiv:null,welCloneDiv:null,elContainer:null,$init:function(t,e){var n=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"],i=n.length,r={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",wordWrap:"break-word"};for(this.nMinHeight=e.nMinHeight,this.wfnCallback=e.wfnCallback,this.elContainer=t.parentNode,this.welTextArea=jindo.$Element(t),this.welHiddenDiv=jindo.$Element("<div>"),this.wfnResize=jindo.$Fn(this._resize,this),this.sOverflow=this.welTextArea.css("overflow"),this.welTextArea.css("overflow","hidden");i--;)r[n[i]]=this.welTextArea.css(n[i]);this.welHiddenDiv.css(r),this.nLastHeight=this.welTextArea.height()},bind:function(){this.welCloneDiv=jindo.$Element(this.welHiddenDiv.$value().cloneNode(!1)),this.wfnResize.attach(this.welTextArea,"keyup"),this.welCloneDiv.appendTo(this.elContainer),this._resize()},unbind:function(){this.wfnResize.detach(this.welTextArea,"keyup"),this.welTextArea.css("overflow",this.sOverflow),this.welCloneDiv&&this.welCloneDiv.leave()},_resize:function(){var t=this.welTextArea.$value().value,e=!1;t!==this.sContents&&(this.sContents=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br>"),this.sContents+="<br>",this.welCloneDiv.html(this.sContents),(t=this.welCloneDiv.height())<this.nMinHeight&&(t=this.nMinHeight),this.welTextArea.css("height",t+"px"),this.elContainer.style.height=t+"px",this.nLastHeight<t&&(e=!0),this.wfnCallback(e))}}),void 0===window.StringBuffer&&(window.StringBuffer={}),StringBuffer=function(t){this._aString=[],void 0!==t&&this.append(t)},StringBuffer.prototype.append=function(t){return this._aString.push(t),this},StringBuffer.prototype.toString=function(){return this._aString.join("")},StringBuffer.prototype.setLength=function(t){this._aString.length=void 0===t||t<=0?0:t},a=null,s=/,/gi,window.IsInstalledFont=function(t){var e="Comic Sans MS"==t?"Courier New":"Comic Sans MS",n="position:absolute !important; font-size:200px !important; left:-9999px !important; top:-9999px !important;";(a=a||document.createElement("div")).innerHTML="mmmmiiiii"+unescape("%uD55C%uAE00"),a.style.cssText=n+'font-family:"'+e+'" !important';var i=document.body||document.documentElement;i.firstChild?i.insertBefore(a,i.firstChild):document.body.appendChild(a);i=a.offsetWidth+"-"+a.offsetHeight;a.style.cssText=n+'font-family:"'+t.replace(s,'","')+'", "'+e+'" !important';i=i!=a.offsetWidth+"-"+a.offsetHeight;return document.body.removeChild(a),i}},function(t,e,n){n={doc:n(45),frame:n(48),text:n(49),hwp:n(51)};if(t.exports=n,"undefined"!=typeof window&&window.document){if(window.hwp)throw new Error("Something else is called hwp!");window.hwp=n}},function(t,e,n){var i=n(18).derive({load:function(t,e){this._paragraphs=[],this.layout()},layout:function(t,e,n,i){this.frame=null;try{this._left=t||0,this._top=e||0,this._width=n||0,this._paragraphs=[]}catch(t){console.error(t)}},children:function(){return this._paragraphs}});t.exports=function(){var t=Object.create(i);return t._left=0,t._top=0,t._width=0,t._paragraphs=[],t.load([]),t}},function(t,e){var r={contains:function(t,e){return t>=this.l&&t<this.l+this.w&&e>=this.t&&e<this.t+this.h},stroke:function(t){t.strokeRect(this.l,this.t,this.w,this.h)},fill:function(t){t.fillRect(this.l,this.t,this.w,this.h)},offset:function(t,e){return n(this.l+t,this.t+e,this.w,this.h)},equals:function(t){return this.l===t.l&&this.t===t.t&&this.w===t.w&&this.h===t.h},center:function(){return{x:this.l+this.w/2,y:this.t+this.h/2}}},n=t.exports=function(t,e,n,i){return Object.create(r,{l:{value:t},t:{value:e},w:{value:n},h:{value:i},r:{value:t+n},b:{value:e+i}})}},function(t,e){e.event=function(){function t(t){n.push(t)}var n=[];return t.fire=function(){var e=Array.prototype.slice.call(arguments,0);n.forEach(function(t){t.apply(null,e)})},t},e.derive=function(t,e){var n={};return Object.keys(e).forEach(function(t){n[t]={value:e[t]}}),Object.create(t,n)}},function(t,e,n){var r=n(18).derive({children:function(){return this._paragraphs},draw:function(e,n){this.children().forEach(function(t){t.draw(e,n)})}});t.exports=function(t,e,n,i){return Object.create(r,{_paragraphs:{value:[]},_parent:{value:i}})}},function(t,h,e){var n=e(50),i=h.getFontString=function(t){var e=t&&t.size||n.defaultFormatting.size;if(t)switch(t.script){case"super":case"sub":e*=.8}return(t&&t.italic?"italic ":"")+(t&&t.bold?"bold ":"")+" "+e+"pt "+(t&&t.font||n.defaultFormatting.font)};h.applyRunStyle=function(t,e){t.fillStyle=e&&e.color||n.defaultFormatting.color,t.font=i(e)},h.prepareContext=function(t){t.textAlign="left",t.textBaseline="alphabetic"},h.getRunStyle=function(t){var e=["font: ",i(t),"; color: ",t&&t.color||n.defaultFormatting.color];if(t)switch(t.script){case"super":e.push("; vertical-align: super");break;case"sub":e.push("; vertical-align: sub")}return e.join("")};var a=h.nbsp=String.fromCharCode(160),o=(h.enter=a,h.measureText=function(t,e){var n=document.createElement("span"),i=document.createElement("div"),r=document.createElement("div");i.style.display="inline-block",i.style.width="1px",i.style.height="0",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.width="500px",r.style.height="200px",r.appendChild(n),r.appendChild(i),document.body.appendChild(r);try{n.setAttribute("style",e),n.innerHTML="",n.appendChild(document.createTextNode(t.replace(/\s/g,a)));var o={};i.style.verticalAlign="baseline",o.ascent=i.offsetTop-n.offsetTop,i.style.verticalAlign="bottom",o.height=i.offsetTop-n.offsetTop,o.descent=o.height-o.ascent,o.width=n.offsetWidth}finally{r.parentNode.removeChild(r),r=null}return o}),e=h.createCachedMeasureText=function(){var r={};return function(t,e){var n=e+"<>!&%"+t,i=r[n];return i||(r[n]=i=o(t,e)),i}};h.cachedMeasureText=e(),h.measure=function(t,e){return h.cachedMeasureText(t,h.getRunStyle(e))},h.draw=function(t,e,n,i,r,o,a,s){switch(h.prepareContext(t),h.applyRunStyle(t,n),n.script){case"super":r-=a*(1/3);break;case"sub":r+=s/2}t.fillText("\n"===e?h.enter:e,i,r),n.underline&&t.fillRect(i,1+r,o,1),n.strikeout&&t.fillRect(i,1+r-a/2,o,1)}},function(t,e){},function(t,e){e.load=function(t){},e.parse=function(t){}},function(t,e,n){"use strict";n.r(e);n(20),n(21),n(22),n(23),n(24),n(25),n(26);var f=n(0),e=(n(27),n(19)),r=n.n(e);const i=["0.1mm","0.12mm","0.15mm","0.2mm","0.25mm","0.3mm","0.4mm","0.5mm","0.6mm","0.7mm","1.0mm","1.5mm","2.0mm","3.0mm","4.0mm","5.0mm"],o={0:"none",1:"solid",2:"dashed",3:"dotted",8:"double"},a={0:"justify",1:"left",2:"right",3:"center"};nhn.husky.SE_EditingArea_Wysiwyg=jindo.$Class({type:"WYSIWYG",name:"SE_EditingArea_Wysiwyg",$init:function(t){this.appContainer=t,this.menuBar=t.querySelector("#menuBar"),this.toolBar=t.querySelector("#toolBar"),this.statusBar=t.querySelector("#statusBar");var e=this.container=t.querySelector(".container"),t=this.document=e.querySelector(".document");this.ruler=e.querySelector(".ruler"),this.editingArea=t.querySelector(".editing_area");this.scrollView=t.querySelector("#scrollView"),this.scrollViewHorizontal=t.querySelector("#scrollViewHorizontal"),this.scrollViewVertical=t.querySelector("#scrollViewVertical");var n=this;this.$file=$("input[type=file]"),this.$file.on("change",function(){console.log("onchange() is called...");var t=this.files.item(0),e=new FileReader;e.onload=function(t){$(".hwpjs-page").remove(),n.pages=[];t=new Uint8Array(t.target.result);n.document=Object(f.f)(Object(f.e)(t,{type:"array"})),n.document.sections.forEach((t,e)=>{n.drawSection(n.document,n.editingArea,t,e)}),n.oApp.exec("EVENT_WINDOW_RESIZE"),n.oApp.exec("POSITION_TOP")},e.readAsArrayBuffer(t)}),this.pageMargin=20,this.pages=[],this.document,fetch("files/blank.hwp").then(t=>t.arrayBuffer()).then(t=>{console.log("then() is called...");t=new Uint8Array(t);n.document=Object(f.f)(Object(f.e)(t,{type:"array"})),n.document.sections.forEach((t,e)=>{n.drawSection(n.document,n.editingArea,t,e)}),n.oApp.exec("EVENT_WINDOW_RESIZE"),n.oApp.exec("POSITION_TOP")}).catch(()=>{console.log("catch() is called...")})},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("REGISTER_EDITING_AREA",[this]),this.oApp.exec("REGISTER_MENU_EVENT",["FILE_LOAD","click","EXECCOMMAND",["FILE_LOAD",!1,!1]]),this.oApp.exec("REGISTER_MENU_EVENT",["FILE_DOWNLOAD","click","EXECCOMMAND",["FILE_DOWNLOAD",!1,!1]])},$ON_MSG_APP_READY:function(){this.oApp.registerBrowserEvent(window,"resize","EVENT_WINDOW_RESIZE",[],null,100)},$AFTER_MSG_APP_READY:function(){console.log("$AFTER_MSG_APP_READY() is called..."),this.oApp.exec("REGISTER_EDITING_AREA",[this])},$ON_EVENT_SCROLL_VIEW_SCROLL:function(){this.editingArea.scrollTop=this.scrollView.scrollTop,this.editingArea.scrollLeft=this.scrollView.scrollLeft},$ON_EVENT_WINDOW_RESIZE:function(){this.editingArea.style.width="100%",this.editingArea.style.height=this.appContainer.clientHeight-(this.menuBar.clientHeight+this.toolBar.clientHeight+this.ruler.clientHeight+this.statusBar.clientHeight)+"px";var t=this.editingArea.clientWidth,e=(this.editingArea.clientHeight,0),n=0;this.pages.forEach(t=>{e=Math.max(e,t.clientWidth),n=t.clientHeight+2*this.pageMargin}),console.log("maxPaperWidth = "+e),console.log("paperHeight = "+n);var i=Math.max(e+2*this.pageMargin,t),t=n;this.scrollViewHorizontal.style.width=i+"px",this.scrollViewVertical.style.height=t+"px",this.oApp.exec("POSITION_CENTER")},$ON_POSITION_CENTER:function(){var t=this.editingArea.clientWidth,e=(this.editingArea.clientHeight,this.scrollViewHorizontal.clientWidth);t<e?(this.pages.forEach(t=>{t.style.marginLeft=t.style.marginRight=this.pageMargin+"px"}),this.editingArea.scrollLeft=(e-t)/2):this.pages.forEach(t=>{t.style.marginLeft=t.style.marginRight="auto"})},$ON_POSITION_TOP:function(){this.editingArea.scrollTop=0},$ON_PASTE_HTML:function(t,e,n){},$ON_EXECCOMMAND:function(t,e,n){switch(t){case"FILE_LOAD":this.$file.click();break;case"FILE_DOWNLOAD":var i=["blank","basicsReport","kaist-055","noori"];fetch("files/"+i[1]+".hwp").then(t=>t.arrayBuffer()).then(t=>{console.log("then() is called...");t=new Uint8Array(t),t=CompoundFile.fromUint8Array(t);r.a.saveAs(new Blob([new Uint8Array(t.asBytes())]),i[1]+"-saveAs.hwp")}).catch(t=>{console.log("catch() is called..."),console.trace()})}},createPaddingMark:function(){const t=document.createElement("div");return t.style.position="absolute",t.style.borderStyle="solid",t.style.borderColor="#c5c5c5",t.style.width="20px",t.style.height="20px",t},createPage:function(t,e){const n=document.createElement("div");n.style.boxShadow="0 1px 3px 1px rgba(60,64,67,.15)",n.style.backgroundColor="#FFF",n.style.margin=this.pageMargin+"px auto",n.style.position="relative",n.style.pageBreakAfter="always",n.style.width=`${t.width/7200}in`,n.style.height=`${t.height/7200}in`,n.style.paddingTop=`${(t.paddingTop+t.headerPadding)/7200}in`,n.style.paddingRight=`${t.paddingRight/7200}in`,n.style.paddingBottom=`${t.paddingBottom/7200}in`,n.style.paddingLeft=`${t.paddingLeft/7200}in`,n.classList.add("hwpjs-page"),n.setAttribute("data-page-number",e.toString()),n.setAttribute("contenteditable","true");const i=this.createPaddingMark();i.style.left=`calc(${n.style.paddingLeft} - 20px)`,i.style.top=`calc(${n.style.paddingTop} - 20px)`,i.style.borderWidth="0 1px 1px 0";const r=this.createPaddingMark();r.style.right=`calc(${n.style.paddingRight} - 20px)`,r.style.top=`calc(${n.style.paddingTop} - 20px)`,r.style.borderWidth="0 0 1px 1px";const o=this.createPaddingMark();o.style.right=`calc(${n.style.paddingRight} - 20px)`,o.style.bottom=`calc(${n.style.paddingBottom} - 20px)`,o.style.borderWidth="1px 0 0 1px";const a=this.createPaddingMark();return a.style.left=`calc(${n.style.paddingLeft} - 20px)`,a.style.bottom=`calc(${n.style.paddingBottom} - 20px)`,a.style.borderWidth="1px 1px 0 0",n.appendChild(i),n.appendChild(r),n.appendChild(o),n.appendChild(a),n},getRGBStyle:function(t){var[e,n,t]=t;return`rgb(${e}, ${n}, ${t})`},drawBorderFill:function(t,e,n){void 0!==n&&(n=t.info.borderFills[n],e.style.borderTopColor=this.getRGBStyle(n.style.top.color),e.style.borderRightColor=this.getRGBStyle(n.style.right.color),e.style.borderBottomColor=this.getRGBStyle(n.style.bottom.color),e.style.borderLeftColor=this.getRGBStyle(n.style.left.color),e.style.borderTopWidth=i[n.style.top.width],e.style.borderRightWidth=i[n.style.right.width],e.style.borderBottomWidth=i[n.style.bottom.width],e.style.borderLeftWidth=i[n.style.left.width],e.style.borderTopStyle=o[n.style.top.type],e.style.borderRightStyle=o[n.style.right.type],e.style.borderBottomStyle=o[n.style.bottom.type],e.style.borderLeftStyle=o[n.style.left.type],n.backgroundColor&&(e.style.backgroundColor=this.getRGBStyle(n.backgroundColor)))},drawColumn:function(e,t,n){const i=document.createElement("td");var{width:r,height:o,colSpan:a,rowSpan:s,borderFillID:h}=n.attribute;i.style.width=`${r/100}pt`,i.style.height=`${o/100}pt`,i.colSpan=a,i.rowSpan=s,this.drawBorderFill(e,i,h),n.items.forEach(t=>{this.drawParagraph(e,i,t)}),t.appendChild(i)},drawTable:function(e,t,n){const i=document.createElement("table");i.style.display="inline-table",i.style.borderCollapse="collapse",i.style.width=`${n.width/100}pt`,i.style.height=`${n.height/100}pt`;const r=document.createElement("tbody");for(let t=0;t<n.rowCount;t+=1){const o=document.createElement("tr");n.content[t].forEach(t=>{this.drawColumn(e,o,t)}),r.appendChild(o)}i.appendChild(r),t.appendChild(i)},drawShape:function(t,e,n){const i=document.createElement("div");i.style.width=`${n.width/100}pt`,i.style.height=`${n.height/100}pt`,0===n.attribute.vertRelTo?(i.style.position="absolute",i.style.top=`${n.verticalOffset/100}pt`,i.style.left=`${n.horizontalOffset/100}pt`):(i.style.marginTop=`${n.verticalOffset/100}pt`,i.style.marginLeft=`${n.horizontalOffset/100}pt`),i.style.zIndex=`${n.zIndex}`,i.style.verticalAlign="middle",i.style.display="inline-block",Object(f.b)(n)&&(t=t.info.binData[n.info.binID],t=new Blob([t.payload],{type:`images/${t.extension}`}),t=window.URL.createObjectURL(t),i.style.backgroundImage=`url("${t}")`,i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="center",i.style.backgroundSize="contain"),n.content.forEach(t=>{t.items.forEach(t=>{this.drawParagraph(i,t)})}),e.appendChild(i)},drawControl:function(t,e,n){Object(f.d)(n)?this.drawTable(t,e,n):Object(f.c)(n)&&this.drawShape(t,e,n)},drawText:function(n,i,r,t,e){const o=r.content.slice(t.pos,e+1),a=[];let s=0;o.forEach(t=>{var e;"string"!=typeof t.value?(t.type===f.a.Extened&&(e=r.controls[s],s+=1,this.drawControl(n,i,e)),13===t.value&&a.push("\n")):a.push(t.value)});var h=a.join("");const l=document.createElement("div");l.textContent=h;var u=n.info.getCharShpe(t.shapeIndex);if(u){var{fontBaseSize:e,fontRatio:h,color:t,fontId:u}=u,h=e*(h[0]/100);l.style.fontSize=`${h}pt`,l.style.lineBreak="anywhere",l.style.whiteSpace="pre-wrap",l.style.color=this.getRGBStyle(t);const c=n.info.fontFaces[u[0]];l.style.fontFamily=c.getFontFamily()}i.appendChild(l)},drawParagraph:function(n,t,i){var r,e;null!=i&&((r=document.createElement("div")).style.margin="0",e=n.info.paragraphShapes[i.shapeIndex],r.style.textAlign=a[e.align],i.shapeBuffer.forEach((t,e)=>{e=i.getShapeEndPos(e);this.drawText(n,r,i,t,e)}),t.append(r))},drawSection:function(e,t,n,i){var r=this.createPage(n,i);this.pages.push(r),n.content.forEach(t=>{this.drawParagraph(e,r,t)}),t.appendChild(r)}}),nhn.husky.SE2M_ExecCommand=jindo.$Class({name:"SE2M_ExecCommand",$init:function(t){var e=this;this.$file=$("input[type=file]"),this.$file.on("change",function(){console.log("onchange() is called...");var t=this.files[0];e.oApp.getWysiwygPaperHtml();t.arrayBuffer().then(t=>{t=new Uint8Array(t);Object(f.e)(t,{type:"array"}).sections.forEach((t,e)=>{})})})},$BEFORE_MSG_APP_READY:function(){},$ON_MSG_APP_READY:function(){this.oApp.exec("REGISTER_MENU_EVENT",["FILE_LOAD","click","EXECCOMMAND",["FILE_LOAD",!1,!1]]),this.oApp.exec("REGISTER_MENU_EVENT",["FILE_DOWNLOAD","click","EXECCOMMAND",["FILE_DOWNLOAD",!1,!1]])},$BEFORE_EXECCOMMAND:function(t,e,n,i){},$ON_EXECCOMMAND:function(t,e,n){"FILE_LOAD"===t&&this.$file.click()},$AFTER_EXECCOMMAND:function(t,e,n,i){}});n(41),n(42),n(43),n(44)}]);