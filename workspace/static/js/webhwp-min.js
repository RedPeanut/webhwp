(function(modules){"use strict";var resolve,getRequire,wmRequire,notFoundError,findFile,extensions={".js":[],".json":[],".css":[],".html":[]},envRequire=typeof require==="function"?require:null;notFoundError=function(path){var error=new Error("Could not find module '"+path+"'");error.code="MODULE_NOT_FOUND";return error};findFile=function(scope,name,extName){var i,ext;if(typeof scope[name+extName]==="function")return name+extName;for(i=0;ext=extensions[extName][i];++i){if(typeof scope[name+ext]==="function")return name+ext}return null};resolve=function(scope,tree,path,fullPath,state,id){var name,dir,exports,module,fn,found,ext;path=path.split("/");name=path.pop();if(name==="."||name===".."){path.push(name);name=""}while((dir=path.shift())!=null){if(!dir||dir===".")continue;if(dir===".."){scope=tree.pop();id=id.slice(0,id.lastIndexOf("/"))}else{tree.push(scope);scope=scope[dir];id+="/"+dir}if(!scope)throw notFoundError(fullPath)}if(name&&typeof scope[name]!=="function"){found=findFile(scope,name,".js");if(!found)found=findFile(scope,name,".json");if(!found)found=findFile(scope,name,".css");if(!found)found=findFile(scope,name,".html");if(found){name=found}else if(state!==2&&typeof scope[name]==="object"){tree.push(scope);scope=scope[name];id+="/"+name;name=""}}if(!name){if(state!==1&&scope[":mainpath:"]){return resolve(scope,tree,scope[":mainpath:"],fullPath,1,id)}return resolve(scope,tree,"index",fullPath,2,id)}fn=scope[name];if(!fn)throw notFoundError(fullPath);if(fn.hasOwnProperty("module"))return fn.module.exports;exports={};fn.module=module={exports:exports,id:id+"/"+name};fn.call(exports,exports,module,getRequire(scope,tree,id));return module.exports};wmRequire=function(scope,tree,fullPath,id){var name,path=fullPath,t=fullPath.charAt(0),state=0;if(t==="/"){path=path.slice(1);scope=modules["/"];if(!scope){if(envRequire)return envRequire(fullPath);throw notFoundError(fullPath)}id="/";tree=[]}else if(t!=="."){name=path.indexOf("@")===0?path.split("/",2).join("/"):path.split("/",1)[0];scope=modules[name];if(!scope){if(envRequire)return envRequire(fullPath);throw notFoundError(fullPath)}id=name;tree=[];path=path.slice(name.length+1);if(!path){path=scope[":mainpath:"];if(path){state=1}else{path="index";state=2}}}return resolve(scope,tree,path,fullPath,state,id)};getRequire=function(scope,tree,id){var localRequire=function(path){return wmRequire(scope,[].concat(tree),path,id)};if(envRequire)localRequire.fromParentEnvironment=envRequire;return localRequire};return getRequire(modules,[],"")})({per:{":mainpath:":"per.js","per.js":function(exports,module,require){(function(exportFunction){function toFunc(valOrFunc,bindThis){if(typeof valOrFunc!=="function"){return Array.isArray(valOrFunc)?function(emit){return valOrFunc.some(emit)}:function(emit){return emit(valOrFunc)}}if(bindThis){return function(emit,value){valOrFunc.call(bindThis,emit,value)}}return valOrFunc}function Per(valOrFunc,bindThis){this.forEach=toFunc(valOrFunc,bindThis)}function blank(emit,value){emit(value)}function create(valOrFunc,bindThis){if(arguments.length===0){return new Per(blank)}if(valOrFunc&&valOrFunc instanceof Per){return valOrFunc}return new Per(valOrFunc,bindThis)}Per.prototype.per=function(valOrFunc,bindThis){var first=this.forEach;var second=toFunc(valOrFunc&&valOrFunc.forEach||valOrFunc,bindThis);return create(function(emit,value){return first(function(firstVal){return second(emit,firstVal)},value)})};function lambda(expression){return typeof expression==="string"?new Function("x","return "+expression):expression}Per.prototype.map=function(mapFunc){mapFunc=lambda(mapFunc);return this.per(function(emit,value){return emit(mapFunc(value))})};Per.prototype.filter=function(predicate){predicate=lambda(predicate);return this.per(function(emit,value){if(predicate(value)){return emit(value)}})};Per.prototype.concat=function(second,secondThis){if(second instanceof Per){second=second.forEach}else{second=toFunc(second,secondThis)}var first=this.forEach;return create(function(emit,value){first(emit,value);second(emit,value)})};Per.prototype.skip=function(count){return this.per(function(emit,value){if(count>0){count--;return false}return emit(value)})};Per.prototype.take=function(count){return this.per(function(emit,value){if(count<=0){return true}count--;return emit(value)})};Per.prototype.listen=function(untilFunc){return this.per(function(emit,value){if(untilFunc(value)){return true}return emit(value)})};Per.prototype.flatten=function(){return this.per(function(emit,array){return!Array.isArray(array)?emit(array):array.some(function(value){return emit(value)})})};Per.prototype.reduce=function(reducer,seed){var result=seed,started=arguments.length==2;return this.per(function(emit,value){result=started?reducer(result,value):value;emit(result);started=true})};Per.prototype.multicast=function(destinations){if(arguments.length!==1){destinations=Array.prototype.slice.call(arguments,0)}destinations=destinations.map(function(destination){return typeof destination==="function"?destination:destination instanceof Per?destination.forEach:ignore});return this.listen(function(value){var quit=true;destinations.forEach(function(destination){if(!destination(ignore,value)){quit=false}});return quit})};function optionalLimit(limit){return typeof limit!="number"?Number.MAX_VALUE:limit}Per.prototype.into=function(ar,limit){if(!Array.isArray(ar)){throw new Error("into expects an array")}limit=optionalLimit(limit);return this.listen(function(value){if(limit<=0){return true}ar.push(value);limit--})};function setOrCall(obj,name){var prop=obj[name];if(typeof prop==="function"){return prop}return function(val){obj[name]=val}}Per.prototype.monitor=function(data){var n=0;var count=setOrCall(data,"count"),first=setOrCall(data,"first"),last=setOrCall(data,"last"),limit=data.limit;if(typeof limit!="number"){limit=Number.MAX_VALUE}if(limit<1){return this}return this.listen(function(value){if(n===0){first(value)}n++;count(n);last(value);if(n>=limit){return true}})};function ignore(){}Per.prototype.submit=function(value){return this.forEach(ignore,value)};Per.prototype.all=function(){var results=[];this.into(results).submit();return results};Per.prototype.first=function(){var results={limit:1};this.monitor(results).submit();return results.count>0?results.first:void 0};Per.prototype.last=function(){var results={};this.monitor(results).submit();return results.count>0?results.last:void 0};function truthy(value){return!!value}Per.prototype.truthy=function(){return this.filter(truthy)};function min(l,r){return Math.min(l,r)}Per.prototype.min=function(){return this.reduce(min,Number.MAX_VALUE)};function max(l,r){return Math.max(l,r)}Per.prototype.max=function(){return this.reduce(max,Number.MIN_VALUE)};function sum(l,r){return l+r}Per.prototype.sum=function(){return this.reduce(sum,0)};function and(l,r){return!!(l&&r)}Per.prototype.and=function(){return this.reduce(and,true)};function or(l,r){return!!(l||r)}Per.prototype.or=function(){return this.reduce(or,false)};function not(v){return!v}Per.prototype.not=function(){return this.map(not)};create.pulse=function(ms){var counter=0;return create(function(emit){function step(){if(emit(counter++)!==true){setTimeout(step,ms)}}step()})};exportFunction(create)})(function(per){if(typeof exports==="undefined"){this["per"]=per}else{module.exports=per}})}},webhwp:{workspace:{src:{bundle:{"base.js":function(exports,module,require){require("../common/base/hp_SE2M_Menubar.js");require("../fundamental/editing/hp_SE_EditingAreaManager.js");require("../fundamental/editing/hp_SE_EditingArea.js");require("../fundamental/base/hp_SE2M_ExecCommand.js");require("../util/hp_Utils.js");require("../util/hp_StringConverterManager.js");require("../util/hp_SE2M_Utils.js")},"carota.js":function(exports,module,require){var node=require("../carota/node");var editor=require("../carota/editor");var doc=require("../carota/doc");var dom=require("../carota/dom");var runs=require("../carota/runs");var html=require("../carota/html");var frame=require("../carota/frame");var text=require("../carota/text");var rect=require("../carota/rect");var bundle={node:node,editor:editor,doc:doc,dom:dom,runs:runs,html:html,frame:frame,text:text,rect:rect};module.exports=bundle;if(typeof window!=="undefined"&&window.document){if(window.carota){throw new Error("Something else is called carota!")}window.carota=bundle}},"husky-range.js":function(exports,module,require){require("../husky_framework/HuskyCore.js");require("../husky_framework/HuskyRange.js");require("../husky_framework/hp_CorePlugin.js");require("../husky_framework/hp_HuskyRangeManager.js")},"hwp.js":function(exports,module,require){var doc=require("../hwp/doc");var frame=require("../hwp/frame");var hwp=require("../hwp/hwp");var bundle={doc:doc,frame:frame,hwp:hwp};module.exports=bundle;if(typeof window!=="undefined"&&window.document){if(window.hwp){throw new Error("Something else is called hwp!")}window.hwp=bundle}},"index.js":function(exports,module,require){require("./husky-range");require("./base");require("./carota");require("./hwp")}},carota:{"characters.js":function(exports,module,require){var runs=require("./runs");var compatible=function(a,b){if(a._runs!==b._runs){throw new Error("Characters for different documents")}};var prototype={equals:function(other){compatible(this,other);return this._run===other._run&&this._offset===other._offset},cut:function(upTo){compatible(this,upTo);var self=this;return function(eachRun){for(var runIndex=self._run;runIndex<=upTo._run;runIndex++){var run=self._runs[runIndex];if(run){var start=runIndex===self._run?self._offset:0;var stop=runIndex===upTo._run?upTo._offset:runs.getTextLength(run.text);if(start<stop){runs.getSubText(function(piece){var pieceRun=Object.create(run);pieceRun.text=piece;eachRun(pieceRun)},run.text,start,stop-start)}}}}}};function character(runArray,run,offset){return Object.create(prototype,{_runs:{value:runArray},_run:{value:run},_offset:{value:offset},char:{value:run>=runArray.length?null:runs.getTextChar(runArray[run].text,offset)}})}function firstNonEmpty(runArray,n){for(;n<runArray.length;n++){if(runs.getTextLength(runArray[n].text)!=0){return character(runArray,n,0)}}return character(runArray,runArray.length,0)}module.exports=function(runArray){return function(emit){var c=firstNonEmpty(runArray,0);while(!emit(c)&&c.char!==null){c=c._offset+1<runs.getTextLength(runArray[c._run].text)?character(runArray,c._run,c._offset+1):firstNonEmpty(runArray,c._run+1)}}}},"codes.js":function(exports,module,require){var text=require("./text");var frame=require("./frame");var node=require("./node");var rect=require("./rect");var util=require("./util");var inlineNodePrototype=node.derive({parent:function(){return this._parent},draw:function(ctx){this.inline.draw(ctx,this.left,this.baseline,this.measured.width,this.measured.ascent,this.measured.descent,this.formatting)},position:function(left,baseline,bounds){this.left=left;this.baseline=baseline;if(bounds){this._bounds=bounds}},bounds:function(){return this._bounds||rect(this.left,this.baseline-this.measured.ascent,this.measured.width,this.measured.ascent+this.measured.descent)},byCoordinate:function(x,y){if(x<=this.bounds().center().x){return this}return this.next()}});var inlineNode=function(inline,parent,ordinal,length,formatting){if(!inline.draw||!inline.measure){throw new Error}return Object.create(inlineNodePrototype,{inline:{value:inline},_parent:{value:parent},ordinal:{value:ordinal},length:{value:length},formatting:{value:formatting},measured:{value:inline.measure(formatting)}})};var codes={};codes.number=function(obj,number){var formattedNumber=number+1+".";return{measure:function(formatting){return text.measure(formattedNumber,formatting)},draw:function(ctx,x,y,width,ascent,descent,formatting){text.draw(ctx,formattedNumber,formatting,x,y,width,ascent,descent)}}};var listTerminator=function(obj){return util.derive(obj,{eof:true,measure:function(formatting){return{width:18,ascent:0,descent:0}},draw:function(ctx,x,y){}})};codes.listNext=codes.listEnd=listTerminator;codes.listStart=function(obj,data,allCodes){return util.derive(obj,{block:function(left,top,width,ordinal,parent,formatting){var list=node.generic("list",parent,left,top),itemNode,itemFrame,itemMarker;var indent=50,spacing=10;var startItem=function(code,formatting){itemNode=node.generic("item",list);var marker=allCodes(code.marker||{$:"number"},list.children().length);itemMarker=inlineNode(marker,itemNode,ordinal,1,formatting);itemMarker.block=true;itemFrame=frame(left+indent,top,width-indent,ordinal+1,itemNode,function(terminatorCode){return terminatorCode.$==="listEnd"},itemMarker.measured.ascent)};startItem(obj,formatting);return function(inputWord){if(itemFrame){itemFrame(function(finishedFrame){ordinal=finishedFrame.ordinal+finishedFrame.length;var frameBounds=finishedFrame.bounds();var firstLine=finishedFrame.first();var markerLeft=left+indent-spacing-itemMarker.measured.width;var markerBounds=rect(left,top,indent,frameBounds.h);if("baseline"in firstLine){itemMarker.position(markerLeft,firstLine.baseline,markerBounds)}else{itemMarker.position(markerLeft,top+itemMarker.measured.ascent,markerBounds)}top=frameBounds.t+frameBounds.h;itemNode.children().push(itemMarker);itemNode.children().push(finishedFrame);itemNode.finalize();list.children().push(itemNode);itemNode=itemFrame=itemMarker=null},inputWord)}else{ordinal++}if(!itemFrame){var i=inputWord.code();if(i){if(i.$=="listEnd"){list.finalize();return list}if(i.$=="listNext"){startItem(i,inputWord.codeFormatting())}}}}}})};module.exports=exports=function(obj,number,allCodes){var impl=codes[obj.$];return impl&&impl(obj,number,allCodes)};exports.editFilter=function(doc){var balance=0;if(!doc.words.some(function(word,i){var code=word.code();if(code){switch(code.$){case"listStart":balance++;break;case"listNext":if(balance===0){doc.spliceWordsWithRuns(i,1,[util.derive(word.codeFormatting(),{text:{$:"listStart",marker:code.marker}})]);return true}break;case"listEnd":if(balance===0){doc.spliceWordsWithRuns(i,1,[])}balance--;break}}})){if(balance>0){var ending=[];while(balance>0){balance--;ending.push({text:{$:"listEnd"}})}doc.spliceWordsWithRuns(doc.words.length-1,0,ending)}}}},"doc.js":function(exports,module,require){var per=require("per");var characters=require("./characters");var split=require("./split");var word=require("./word");var node=require("./node");var runs=require("./runs");var range=require("./range");var util=require("./util");var frame=require("./frame");var codes=require("./codes");var rect=require("./rect");var makeEditCommand=function(doc,start,count,words){var selStart=doc.selection.start,selEnd=doc.selection.end;return function(log){doc._wordOrdinals=[];var oldWords=Array.prototype.splice.apply(doc.words,[start,count].concat(words));log(makeEditCommand(doc,start,words.length,oldWords));doc._nextSelection={start:selStart,end:selEnd}}};var makeTransaction=function(perform){var commands=[];var log=function(command){commands.push(command);log.length=commands.length};perform(log);return function(outerLog){outerLog(makeTransaction(function(innerLog){while(commands.length){commands.pop()(innerLog)}}))}};var isBreaker=function(word){if(word.isNewLine()){return true}var code=word.code();return!!(code&&(code.block||code.eof))};var prototype=node.derive({load:function(runs,takeFocus){var self=this;this.undo=[];this.redo=[];this._wordOrdinals=[];this.words=per(characters(runs)).per(split(self.codes)).map(function(w){return word(w,self.codes)}).all();this.layout();this.contentChanged.fire();this.select(0,0,takeFocus)},layout:function(left,top,width,height){this.frame=null;try{this._left=left||0;this._top=top||0;this._width=width||0;this.frame=per(this.words).per(frame(this._left,this._top,this._width,0,this)).first()}catch(x){console.error(x)}if(!this.frame){console.error("A bug somewhere has produced an invalid state - rolling back");this.performUndo()}else if(this._nextSelection){var next=this._nextSelection;delete this._nextSelection;this.select(next.start,next.end)}},range:function(start,end){return range(this,start,end)},documentRange:function(){return this.range(0,this.frame.length-1)},selectedRange:function(){return this.range(this.selection.start,this.selection.end)},save:function(){return this.documentRange().save()},paragraphRange:function(start,end){var i;var startInfo=this.wordContainingOrdinal(start);start=0;if(startInfo&&!isBreaker(startInfo.word)){for(i=startInfo.index;i>0;i--){if(isBreaker(this.words[i-1])){start=this.wordOrdinal(i);break}}}var endInfo=this.wordContainingOrdinal(end);end=this.frame.length-1;if(endInfo&&!isBreaker(endInfo.word)){for(i=endInfo.index;i<this.words.length;i++){if(isBreaker(this.words[i])){end=this.wordOrdinal(i);break}}}return this.range(start,end)},insert:function(text,takeFocus){this.select(this.selection.end+this.selectedRange().setText(text),null,takeFocus)},modifyInsertFormatting:function(attribute,value){this.nextInsertFormatting[attribute]=value;this.notifySelectionChanged()},applyInsertFormatting:function(text){var formatting=this.nextInsertFormatting;var insertFormattingProperties=Object.keys(formatting);if(insertFormattingProperties.length){text.forEach(function(run){insertFormattingProperties.forEach(function(property){run[property]=formatting[property]})})}},wordOrdinal:function(index){if(index<this.words.length){var cached=this._wordOrdinals.length;if(cached<index+1){var o=cached>0?this._wordOrdinals[cached-1]:0;for(var n=cached;n<=index;n++){this._wordOrdinals[n]=o;o+=this.words[n].length}}return this._wordOrdinals[index]}},wordContainingOrdinal:function(ordinal){var result;var pos=0;this.words.some(function(word,i){if(ordinal>=pos&&ordinal<pos+word.length){result={word:word,ordinal:pos,index:i,offset:ordinal-pos};return true}pos+=word.length});return result},runs:function(emit,range){var startDetails=this.wordContainingOrdinal(Math.max(0,range.start)),endDetails=this.wordContainingOrdinal(Math.min(range.end,this.frame.length-1));if(startDetails.index===endDetails.index){startDetails.word.runs(emit,{start:startDetails.offset,end:endDetails.offset})}else{startDetails.word.runs(emit,{start:startDetails.offset});for(var n=startDetails.index+1;n<endDetails.index;n++){this.words[n].runs(emit)}endDetails.word.runs(emit,{end:endDetails.offset})}},spliceWordsWithRuns:function(wordIndex,count,runs){var self=this;var newWords=per(characters(runs)).per(split(self.codes)).truthy().map(function(w){return word(w,self.codes)}).all();var runFilters=false;if("_filtersRunning"in self){self._filtersRunning++}else{for(var n=0;n<count;n++){if(this.words[wordIndex+n].code()){runFilters=true}}if(!runFilters){runFilters=newWords.some(function(word){return!!word.code()})}}this.transaction(function(log){makeEditCommand(self,wordIndex,count,newWords)(log);if(runFilters){self._filtersRunning=0;try{for(;;){var spliceCount=self._filtersRunning;if(!self.editFilters.some(function(filter){filter(self);return spliceCount!==self._filtersRunning})){break}}}finally{delete self._filtersRunning}}})},splice:function(start,end,text){if(typeof text==="string"){var sample=Math.max(0,start-1);var sampleRun=per({start:sample,end:sample+1}).per(this.runs,this).first();text=[sampleRun?Object.create(sampleRun,{text:{value:text}}):{text:text}]}else if(!Array.isArray(text)){text=[{text:text}]}this.applyInsertFormatting(text);var startWord=this.wordContainingOrdinal(start),endWord=this.wordContainingOrdinal(end);var prefix;if(start===startWord.ordinal){if(startWord.index>0&&!isBreaker(this.words[startWord.index-1])){startWord.index--;var previousWord=this.words[startWord.index];prefix=per({}).per(previousWord.runs,previousWord).all()}else{prefix=[]}}else{prefix=per({end:startWord.offset}).per(startWord.word.runs,startWord.word).all()}var suffix;if(end===endWord.ordinal){if(end===this.frame.length-1||isBreaker(endWord.word)){suffix=[];endWord.index--}else{suffix=per({}).per(endWord.word.runs,endWord.word).all()}}else{suffix=per({start:endWord.offset}).per(endWord.word.runs,endWord.word).all()}var oldLength=this.frame.length;this.spliceWordsWithRuns(startWord.index,endWord.index-startWord.index+1,per(prefix).concat(text).concat(suffix).per(runs.consolidate()).all());return this.frame?this.frame.length-oldLength:0},registerEditFilter:function(filter){this.editFilters.push(filter)},width:function(width){if(arguments.length===0)return this._width;this._width=width;this.layout()},children:function(){return[this.frame]},toggleCaret:function(){var old=this.caretVisible;if(this.selection.start===this.selection.end){if(this.selectionJustChanged){this.selectionJustChanged=false}else{this.caretVisible=!this.caretVisible}}return this.caretVisible!==old},getCaretCoords:function(ordinal){var node=this.byOrdinal(ordinal),b;if(node){if(node.block&&ordinal>0){var nodeBefore=this.byOrdinal(ordinal-1);if(nodeBefore.newLine){var newLineBounds=nodeBefore.bounds();var lineBounds=nodeBefore.parent().parent().bounds();b=rect(lineBounds.l,lineBounds.b,1,newLineBounds.h)}else{b=nodeBefore.bounds();b=rect(b.r,b.t,1,b.h)}}else{b=node.bounds();if(b.h){b=rect(b.l,b.t,1,b.h)}else{b=rect(b.l,b.t,b.w,1)}}return b}},byCoordinate:function(x,y){var ordinal=this.frame.byCoordinate(x,y).ordinal;var caret=this.getCaretCoords(ordinal);while(caret.b<=y&&ordinal<this.frame.length-1){ordinal++;caret=this.getCaretCoords(ordinal)}while(caret.t>=y&&ordinal>0){ordinal--;caret=this.getCaretCoords(ordinal)}return this.byOrdinal(ordinal)},drawSelection:function(ctx,hasFocus){if(this.selection.end===this.selection.start){if(this.selectionJustChanged||hasFocus&&this.caretVisible){var caret=this.getCaretCoords(this.selection.start);if(caret){ctx.save();ctx.fillStyle="black";caret.fill(ctx);ctx.restore()}}}else{ctx.save();ctx.fillStyle=hasFocus?"rgba(0, 100, 200, 0.3)":"rgba(160, 160, 160, 0.3)";this.selectedRange().parts(function(part){part.bounds(true).fill(ctx)});ctx.restore()}},notifySelectionChanged:function(takeFocus){var cachedFormatting=null;var self=this;var getFormatting=function(){if(!cachedFormatting){cachedFormatting=self.selectedRange().getFormatting()}return cachedFormatting};this.selectionChanged.fire(getFormatting,takeFocus)},select:function(ordinal,ordinalEnd,takeFocus){if(!this.frame){return}this.selection.start=Math.max(0,ordinal);this.selection.end=Math.min(typeof ordinalEnd==="number"?ordinalEnd:this.selection.start,this.frame.length-1);this.selectionJustChanged=true;this.caretVisible=true;this.nextInsertFormatting={};this.notifySelectionChanged(takeFocus)},performUndo:function(redo){var fromStack=redo?this.redo:this.undo,toStack=redo?this.undo:this.redo,oldCommand=fromStack.pop();if(oldCommand){oldCommand(function(newCommand){toStack.push(newCommand)});this.layout();this.contentChanged.fire()}},canUndo:function(redo){return redo?!!this.redo.length:!!this.undo.length},transaction:function(perform){if(this._currentTransaction){perform(this._currentTransaction)}else{var self=this;while(this.undo.length>50){self.undo.shift()}this.redo.length=0;var changed=false;this.undo.push(makeTransaction(function(log){self._currentTransaction=log;try{perform(log)}finally{changed=log.length>0;self._currentTransaction=null}}));if(changed){self.layout();self.contentChanged.fire()}}},type:"document"});exports=module.exports=function(){var doc=Object.create(prototype);doc._left=0;doc._top=0;doc._width=0;doc.selection={start:0,end:0};doc.caretVisible=true;doc.customCodes=function(code,data,allCodes){};doc.codes=function(code,data){var instance=codes(code,data,doc.codes);return instance||doc.customCodes(code,data,doc.codes)};doc.selectionChanged=util.event();doc.contentChanged=util.event();doc.editFilters=[codes.editFilter];doc.load([]);return doc}},"dom.js":function(exports,module,require){exports.isAttached=function(element){var ancestor=element;while(ancestor.parentNode){ancestor=ancestor.parentNode}return!!ancestor.body};exports.clear=function(element){while(element.firstChild){element.removeChild(element.firstChild)}};exports.setText=function(element,text){exports.clear(element);element.appendChild(document.createTextNode(text))};exports.handleEvent=function(element,name,handler){element.addEventListener(name,function(ev){if(handler(ev)===false){ev.preventDefault()}})};exports.handleMouseEvent=function(element,name,handler){exports.handleEvent(element,name,function(ev){var rect=element.getBoundingClientRect();return handler(ev,ev.clientX-rect.left,ev.clientY-rect.top)})};exports.effectiveStyle=function(element,name){return document.defaultView.getComputedStyle(element).getPropertyValue(name)}},"editor.js":function(exports,module,require){var per=require("per");var carotaDoc=require("./doc");var dom=require("./dom");var rect=require("./rect");setInterval(function(){var editors=document.querySelectorAll(".carotaEditorCanvas");var ev=document.createEvent("Event");ev.initEvent("carotaEditorSharedTimer",true,true);for(var n=0;n<editors.length;n++){editors[n].dispatchEvent(ev)}},200);exports.create=function(element){if(dom.effectiveStyle(element,"position")!=="absolute"){element.style.position="relative"}element.innerHTML='<div class="carotaSpacer">'+'<canvas width="100" height="100" class="carotaEditorCanvas" style="position: absolute;"></canvas>'+"</div>"+'<div class="carotaTextArea" style="overflow: hidden; position: absolute; height: 0;">'+'<textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" '+'style="position: absolute; padding: 0px; width: 1000px; height: 1em; '+'outline: none; font-size: 4px;"></textarea>';"</div>";var canvas=element.querySelector("canvas"),spacer=element.querySelector(".carotaSpacer"),textAreaDiv=element.querySelector(".carotaTextArea"),textArea=element.querySelector("textarea"),doc=carotaDoc(),keyboardSelect=0,keyboardX=null,nextKeyboardX=null,selectDragStart=null,focusChar=null,textAreaContent="",richClipboard=null,plainClipboard=null;var toggles={66:"bold",73:"italic",85:"underline",83:"strikeout"};var exhausted=function(ordinal,direction){return direction<0?ordinal<=0:ordinal>=doc.frame.length-1};var differentLine=function(caret1,caret2){return caret1.b<=caret2.t||caret2.b<=caret1.t};var changeLine=function(ordinal,direction){var originalCaret=doc.getCaretCoords(ordinal),newCaret;nextKeyboardX=keyboardX!==null?keyboardX:originalCaret.l;while(!exhausted(ordinal,direction)){ordinal+=direction;newCaret=doc.getCaretCoords(ordinal);if(differentLine(newCaret,originalCaret)){break}}originalCaret=newCaret;while(!exhausted(ordinal,direction)){if(direction>0&&newCaret.l>=nextKeyboardX||direction<0&&newCaret.l<=nextKeyboardX){break}ordinal+=direction;newCaret=doc.getCaretCoords(ordinal);if(differentLine(newCaret,originalCaret)){ordinal-=direction;break}}return ordinal};var endOfline=function(ordinal,direction){var originalCaret=doc.getCaretCoords(ordinal),newCaret;while(!exhausted(ordinal,direction)){ordinal+=direction;newCaret=doc.getCaretCoords(ordinal);if(differentLine(newCaret,originalCaret)){ordinal-=direction;break}}return ordinal};var handleKey=function(key,selecting,ctrlKey){var start=doc.selection.start,end=doc.selection.end,length=doc.frame.length-1,handled=false;nextKeyboardX=null;if(!selecting){keyboardSelect=0}else if(!keyboardSelect){switch(key){case 37:case 38:case 36:case 33:keyboardSelect=-1;break;case 39:case 40:case 35:case 34:keyboardSelect=1;break}}var ordinal=keyboardSelect===1?end:start;var changingCaret=false;switch(key){case 37:if(!selecting&&start!=end){ordinal=start}else{if(ordinal>0){if(ctrlKey){var wordInfo=doc.wordContainingOrdinal(ordinal);if(wordInfo.ordinal===ordinal){ordinal=wordInfo.index>0?doc.wordOrdinal(wordInfo.index-1):0}else{ordinal=wordInfo.ordinal}}else{ordinal--}}}changingCaret=true;break;case 39:if(!selecting&&start!=end){ordinal=end}else{if(ordinal<length){if(ctrlKey){var wordInfo=doc.wordContainingOrdinal(ordinal);ordinal=wordInfo.ordinal+wordInfo.word.length}else{ordinal++}}}changingCaret=true;break;case 40:ordinal=changeLine(ordinal,1);changingCaret=true;break;case 38:ordinal=changeLine(ordinal,-1);changingCaret=true;break;case 36:ordinal=endOfline(ordinal,-1);changingCaret=true;break;case 35:ordinal=endOfline(ordinal,1);changingCaret=true;break;case 33:ordinal=0;changingCaret=true;break;case 34:ordinal=length;changingCaret=true;break;case 8:if(start===end&&start>0){doc.range(start-1,start).clear();focusChar=start-1;doc.select(focusChar,focusChar);handled=true}break;case 46:if(start===end&&start<length){doc.range(start,start+1).clear();handled=true}break;case 90:if(ctrlKey){handled=true;doc.performUndo()}break;case 89:if(ctrlKey){handled=true;doc.performUndo(true)}break;case 65:if(ctrlKey){handled=true;doc.select(0,length)}break;case 67:case 88:if(ctrlKey){richClipboard=doc.selectedRange().save();plainClipboard=doc.selectedRange().plainText()}break}var toggle=toggles[key];if(ctrlKey&&toggle){var selRange=doc.selectedRange();selRange.setFormatting(toggle,selRange.getFormatting()[toggle]!==true);paint();handled=true}if(changingCaret){switch(keyboardSelect){case 0:start=end=ordinal;break;case-1:start=ordinal;break;case 1:end=ordinal;break}if(start===end){keyboardSelect=0}else{if(start>end){keyboardSelect=-keyboardSelect;var t=end;end=start;start=t}}focusChar=ordinal;doc.select(start,end);handled=true}keyboardX=nextKeyboardX;return handled};dom.handleEvent(textArea,"keydown",function(ev){if(handleKey(ev.keyCode,ev.shiftKey,ev.ctrlKey)){return false}console.log(ev.which)});var verticalAlignment="top";doc.setVerticalAlignment=function(va){verticalAlignment=va;paint()};function getVerticalOffset(){var docHeight=doc.frame.bounds().h;if(docHeight<element.clientHeight){switch(verticalAlignment){case"middle":return(element.clientHeight-docHeight)/2;case"bottom":return element.clientHeight-docHeight}}return 0}var paint=function(){var availableWidth=element.clientWidth*1;if(doc.width()!==availableWidth){doc.width(availableWidth)}var docHeight=doc.frame.bounds().h;var dpr=Math.max(1,window.devicePixelRatio||1);var logicalWidth=Math.max(doc.frame.actualWidth(),element.clientWidth),logicalHeight=element.clientHeight;canvas.width=dpr*logicalWidth;canvas.height=dpr*logicalHeight;canvas.style.width=logicalWidth+"px";canvas.style.height=logicalHeight+"px";canvas.style.top=element.scrollTop+"px";spacer.style.width=logicalWidth+"px";spacer.style.height=Math.max(docHeight,element.clientHeight)+"px";if(docHeight<element.clientHeight-50&&doc.frame.actualWidth()<=availableWidth){element.style.overflow="hidden"}else{element.style.overflow="auto"}var ctx=canvas.getContext("2d");ctx.scale(dpr,dpr);ctx.clearRect(0,0,logicalWidth,logicalHeight);ctx.translate(0,getVerticalOffset()-element.scrollTop);doc.draw(ctx,rect(0,element.scrollTop,logicalWidth,logicalHeight));doc.drawSelection(ctx,selectDragStart||document.activeElement===textArea)};dom.handleEvent(element,"scroll",paint);dom.handleEvent(textArea,"input",function(){var newText=textArea.value;if(textAreaContent!=newText){textAreaContent="";textArea.value="";if(newText===plainClipboard){newText=richClipboard}doc.insert(newText)}});var updateTextArea=function(){focusChar=focusChar===null?doc.selection.end:focusChar;var endChar=doc.byOrdinal(focusChar);focusChar=null;if(endChar){var bounds=endChar.bounds();textAreaDiv.style.left=bounds.l+"px";textAreaDiv.style.top=bounds.t+"px";textArea.focus();var scrollDownBy=Math.max(0,bounds.t+bounds.h-(element.scrollTop+element.clientHeight));if(scrollDownBy){element.scrollTop+=scrollDownBy}var scrollUpBy=Math.max(0,element.scrollTop-bounds.t);if(scrollUpBy){element.scrollTop-=scrollUpBy}var scrollRightBy=Math.max(0,bounds.l-(element.scrollLeft+element.clientWidth));if(scrollRightBy){element.scrollLeft+=scrollRightBy}var scrollLeftBy=Math.max(0,element.scrollLeft-bounds.l);if(scrollLeftBy){element.scrollLeft-=scrollLeftBy}}textAreaContent=doc.selectedRange().plainText();textArea.value=textAreaContent;textArea.select();setTimeout(function(){textArea.focus()},10)};doc.selectionChanged(function(getformatting,takeFocus){paint();if(!selectDragStart){if(takeFocus!==false){updateTextArea()}}});function registerMouseEvent(name,handler){dom.handleMouseEvent(spacer,name,function(ev,x,y){handler(doc.byCoordinate(x,y-getVerticalOffset()))})}registerMouseEvent("mousedown",function(node){selectDragStart=node.ordinal;doc.select(node.ordinal,node.ordinal);keyboardX=null});registerMouseEvent("dblclick",function(node){node=node.parent();if(node){doc.select(node.ordinal,node.ordinal+(node.word?node.word.text.length:node.length))}});registerMouseEvent("mousemove",function(node){if(selectDragStart!==null){if(node){focusChar=node.ordinal;if(selectDragStart>node.ordinal){doc.select(node.ordinal,selectDragStart)}else{doc.select(selectDragStart,node.ordinal)}}}});registerMouseEvent("mouseup",function(node){selectDragStart=null;keyboardX=null;updateTextArea();textArea.focus()});var nextCaretToggle=(new Date).getTime(),focused=false,cachedWidth=element.clientWidth,cachedHeight=element.clientHeight;var update=function(){var requirePaint=false;var newFocused=document.activeElement===textArea;if(focused!==newFocused){focused=newFocused;requirePaint=true}var now=(new Date).getTime();if(now>nextCaretToggle){nextCaretToggle=now+500;if(doc.toggleCaret()){requirePaint=true}}if(element.clientWidth!==cachedWidth||element.clientHeight!==cachedHeight){requirePaint=true;cachedWidth=element.clientWidth;cachedHeight=element.clientHeight}if(requirePaint){paint()}};dom.handleEvent(canvas,"carotaEditorSharedTimer",update);update();doc.sendKey=handleKey;return doc}},"frame.js":function(exports,module,require){var node=require("./node");var wrap=require("./wrap");var rect=require("./rect");var prototype=node.derive({bounds:function(){if(!this._bounds){var left=0,top=0,right=0,bottom=0;if(this.lines.length){var first=this.lines[0].bounds();left=first.l;top=first.t;this.lines.forEach(function(line){var b=line.bounds();right=Math.max(right,b.l+b.w);bottom=Math.max(bottom,b.t+b.h)})}this._bounds=rect(left,top,right-left,this.height||bottom-top)}return this._bounds},actualWidth:function(){if(!this._actualWidth){var result=0;this.lines.forEach(function(line){if(typeof line.actualWidth==="number"){result=Math.max(result,line.actualWidth)}});this._actualWidth=result}return this._actualWidth},children:function(){return this.lines},parent:function(){return this._parent},draw:function(ctx,viewPort){var top=viewPort?viewPort.t:0;var bottom=viewPort?viewPort.t+viewPort.h:Number.MAX_VALUE;this.lines.some(function(line){var b=line.bounds();if(b.t+b.h<top){return false}if(b.t>bottom){return true}line.draw(ctx,viewPort)})},type:"frame"});exports=module.exports=function(left,top,width,ordinal,parent,includeTerminator,initialAscent,initialDescent){var lines=[];var frame=Object.create(prototype,{lines:{value:lines},_parent:{value:parent},ordinal:{value:ordinal}});var wrapper=wrap(left,top,width,ordinal,frame,includeTerminator,initialAscent,initialDescent);var length=0,height=0;return function(emit,word){if(wrapper(function(line){if(typeof line==="number"){height=line}else{length=line.ordinal+line.length-ordinal;lines.push(line)}},word)){Object.defineProperty(frame,"length",{value:length});Object.defineProperty(frame,"height",{value:height});emit(frame);return true}}}},"html.js":function(exports,module,require){var runs=require("./runs");var per=require("per");var tag=function(name,formattingProperty){return function(node,formatting){if(node.nodeName===name){formatting[formattingProperty]=true}}};var value=function(type,styleProperty,formattingProperty,transformValue){return function(node,formatting){var val=node[type]&&node[type][styleProperty];if(val){if(transformValue){val=transformValue(val)}formatting[formattingProperty]=val}}};var attrValue=function(styleProperty,formattingProperty,transformValue){return value("attributes",styleProperty,formattingProperty,transformValue)};var styleValue=function(styleProperty,formattingProperty,transformValue){return value("style",styleProperty,formattingProperty,transformValue)};var styleFlag=function(styleProperty,styleValue,formattingProperty){return function(node,formatting){if(node.style&&node.style[styleProperty]===styleValue){formatting[formattingProperty]=true}}};var obsoleteFontSizes=[6,7,9,10,12,16,20,30];var aligns={left:true,center:true,right:true,justify:true};var checkAlign=function(value){return aligns[value]?value:"left"};var fontName=function(name){var s=name.split(/\s*,\s*/g);if(s.length==0){return name}name=s[0];var raw=name.match(/^"(.*)"$/);if(raw){return raw[1].trim()}raw=name.match(/^'(.*)'$/);if(raw){return raw[1].trim()}return name};var headings={H1:30,H2:20,H3:16,H4:14,H5:12};var handlers=[tag("B","bold"),tag("STRONG","bold"),tag("I","italic"),tag("EM","italic"),tag("U","underline"),tag("S","strikeout"),tag("STRIKE","strikeout"),tag("DEL","strikeout"),styleFlag("fontWeight","bold","bold"),styleFlag("fontStyle","italic","italic"),styleFlag("textDecoration","underline","underline"),styleFlag("textDecoration","line-through","strikeout"),styleValue("color","color"),styleValue("fontFamily","font",fontName),styleValue("fontSize","size",function(size){var m=size.match(/^([\d\.]+)pt$/);return m?parseFloat(m[1]):10}),styleValue("textAlign","align",checkAlign),function(node,formatting){if(node.nodeName==="SUB"){formatting.script="sub"}},function(node,formatting){if(node.nodeName==="SUPER"){formatting.script="super"}},function(node,formatting){if(node.nodeName==="CODE"){formatting.font="monospace"}},function(node,formatting){var size=headings[node.nodeName];if(size){formatting.size=size}},attrValue("color","color"),attrValue("face","font",fontName),attrValue("align","align",checkAlign),attrValue("size","size",function(size){return obsoleteFontSizes[size]||10})];var newLines=["BR","P","H1","H2","H3","H4","H5"];var isNewLine={};newLines.forEach(function(name){isNewLine[name]=true});exports.parse=function(html,classes){var root=html;if(typeof root==="string"){root=document.createElement("div");root.innerHTML=html}var result=[],inSpace=true;var cons=per(runs.consolidate()).into(result);var emit=function(text,formatting){cons.submit(Object.create(formatting,{text:{value:text}}))};var dealWithSpaces=function(text,formatting){text=text.replace(/\n+\s*/g," ");var fullLength=text.length;text=text.replace(/^\s+/,"");if(inSpace){inSpace=false}else if(fullLength!==text.length){text=" "+text}fullLength=text.length;text=text.replace(/\s+$/,"");if(fullLength!==text.length){inSpace=true;text+=" "}emit(text,formatting)};function recurse(node,formatting){if(node.nodeType==3){dealWithSpaces(node.nodeValue,formatting)}else{formatting=Object.create(formatting);var classNames=node.attributes["class"];if(classNames){classNames.value.split(" ").forEach(function(cls){cls=classes[cls];if(cls){Object.keys(cls).forEach(function(key){formatting[key]=cls[key]})}})}handlers.forEach(function(handler){handler(node,formatting)});if(node.childNodes){for(var n=0;n<node.childNodes.length;n++){recurse(node.childNodes[n],formatting)}}if(isNewLine[node.nodeName]){emit("\n",formatting);inSpace=true}}}recurse(root,{});return result}},"line.js":function(exports,module,require){var positionedWord=require("./positionedword");var rect=require("./rect");var node=require("./node");var runs=require("./runs");var prototype=node.derive({bounds:function(minimal){if(minimal){var firstWord=this.first().bounds(),lastWord=this.last().bounds();return rect(firstWord.l,this.baseline-this.ascent,lastWord.l+lastWord.w-firstWord.l,this.ascent+this.descent)}return rect(this.left,this.baseline-this.ascent,this.width,this.ascent+this.descent)},parent:function(){return this.doc},children:function(){return this.positionedWords},type:"line"});module.exports=function(doc,left,width,baseline,ascent,descent,words,ordinal){var align=words[0].align();var line=Object.create(prototype,{doc:{value:doc},left:{value:left},width:{value:width},baseline:{value:baseline},ascent:{value:ascent},descent:{value:descent},ordinal:{value:ordinal},align:{value:align}});var actualWidth=0;words.forEach(function(word){actualWidth+=word.width});actualWidth-=words[words.length-1].space.width;var x=0,spacing=0;if(actualWidth<width){switch(align){case"right":x=width-actualWidth;break;case"center":x=(width-actualWidth)/2;break;case"justify":if(words.length>1&&!words[words.length-1].isNewLine()){spacing=(width-actualWidth)/(words.length-1)}break}}Object.defineProperty(line,"positionedWords",{value:words.map(function(word){var wordLeft=x;x+=word.width+spacing;var wordOrdinal=ordinal;ordinal+=word.text.length+word.space.length;return positionedWord(word,line,wordLeft,wordOrdinal,word.width+spacing)})});Object.defineProperty(line,"actualWidth",{value:actualWidth});Object.defineProperty(line,"length",{value:ordinal-line.ordinal});return line}},"node.js":function(exports,module,require){var per=require("per");var rect=require("./rect");var util=require("./util");exports.prototype={children:function(){return[]},parent:function(){return null},first:function(){return this.children()[0]},last:function(){return this.children()[this.children().length-1]},next:function(){var self=this;for(;;){var parent=self.parent();if(!parent){return null}var siblings=parent.children();var next=siblings[siblings.indexOf(self)+1];if(next){for(;;){var first=next.first();if(!first){break}next=first}return next}self=parent}},previous:function(){var parent=this.parent();if(!parent){return null}var siblings=parent.children();var prev=siblings[siblings.indexOf(this)-1];if(prev){return prev}var prevParent=parent.previous();return!prevParent?null:prevParent.last()},byOrdinal:function(index){var found=null;if(this.children().some(function(child){if(index>=child.ordinal&&index<child.ordinal+child.length){found=child.byOrdinal(index);if(found){return true}}})){return found}return this},byCoordinate:function(x,y){var found;this.children().some(function(child){var b=child.bounds();if(b.contains(x,y)){found=child.byCoordinate(x,y);if(found){return true}}});if(!found){found=this.last();while(found){var next=found.last();if(!next){break}found=next}var foundNext=found.next();if(foundNext&&foundNext.block){found=foundNext}}return found},draw:function(ctx,viewPort){this.children().forEach(function(child){child.draw(ctx,viewPort)})},parentOfType:function(type){var p=this.parent();return p&&(p.type===type?p:p.parentOfType(type))},bounds:function(){var l=this._left,t=this._top,r=0,b=0;this.children().forEach(function(child){var cb=child.bounds();l=Math.min(l,cb.l);t=Math.min(t,cb.t);r=Math.max(r,cb.l+cb.w);b=Math.max(b,cb.t+cb.h)});return rect(l,t,r-l,b-t)}};exports.derive=function(methods){return util.derive(exports.prototype,methods)};var generic=exports.derive({children:function(){return this._children},parent:function(){return this._parent},finalize:function(startDecrement,lengthIncrement){var start=Number.MAX_VALUE,end=0;this._children.forEach(function(child){start=Math.min(start,child.ordinal);end=Math.max(end,child.ordinal+child.length)});Object.defineProperty(this,"ordinal",{value:start-(startDecrement||0)});Object.defineProperty(this,"length",{value:(lengthIncrement||0)+end-start})}});exports.generic=function(type,parent,left,top){return Object.create(generic,{type:{value:type},_children:{value:[]},_parent:{value:parent},_left:{value:typeof left==="number"?left:Number.MAX_VALUE},_top:{value:typeof top==="number"?top:Number.MAX_VALUE}})}},"part.js":function(exports,module,require){var text=require("./text");var defaultInline={measure:function(formatting){var text=text.measure("?",formatting);return{width:text.width+4,ascent:text.width+2,descent:text.width+2}},draw:function(ctx,x,y,width,ascent,descent){ctx.fillStyle="silver";ctx.fillRect(x,y-ascent,width,ascent+descent);ctx.strokeRect(x,y-ascent,width,ascent+descent);ctx.fillStyle="black";ctx.fillText("?",x+2,y)}};var prototype={draw:function(ctx,x,y){if(typeof this.run.text==="string"){text.draw(ctx,this.run.text,this.run,x,y,this.width,this.ascent,this.descent)}else if(this.code&&this.code.draw){ctx.save();this.code.draw(ctx,x,y,this.width,this.ascent,this.descent,this.run);ctx.restore()}}};module.exports=function(run,codes){var m,isNewLine,code;if(typeof run.text==="string"){isNewLine=run.text.length===1&&run.text[0]==="\n";m=text.measure(isNewLine?text.nbsp:run.text,run)}else{code=codes(run.text)||defaultInline;m=code.measure?code.measure(run):{width:0,ascent:0,descent:0}}var part=Object.create(prototype,{run:{value:run},isNewLine:{value:isNewLine},width:{value:isNewLine?0:m.width},ascent:{value:m.ascent},descent:{value:m.descent}});if(code){Object.defineProperty(part,"code",{value:code})}return part}},"positionedword.js":function(exports,module,require){var rect=require("./rect");var part=require("./part");var text=require("./text");var node=require("./node");var word=require("./word");var runs=require("./runs");var newLineWidth=function(run){return text.measure(text.enter,run).width};var positionedChar=node.derive({bounds:function(){var wb=this.word.bounds();var width=this.word.word.isNewLine()?newLineWidth(this.word.word.run):this.width||this.part.width;return rect(wb.l+this.left,wb.t,width,wb.h)},parent:function(){return this.word},byOrdinal:function(){return this},byCoordinate:function(x,y){if(x<=this.bounds().center().x){return this}return this.next()},type:"character"});var prototype=node.derive({draw:function(ctx){this.word.draw(ctx,this.line.left+this.left,this.line.baseline)},bounds:function(){return rect(this.line.left+this.left,this.line.baseline-this.line.ascent,this.word.isNewLine()?newLineWidth(this.word.run):this.width,this.line.ascent+this.line.descent)},parts:function(eachPart){this.word.text.parts.some(eachPart)||this.word.space.parts.some(eachPart)},realiseCharacters:function(){if(!this._characters){var cache=[];var x=0,self=this,ordinal=this.ordinal,codes=this.parentOfType("document").codes;this.parts(function(wordPart){runs.pieceCharacters(function(char){var charRun=Object.create(wordPart.run);charRun.text=char;var p=part(charRun,codes);cache.push(Object.create(positionedChar,{left:{value:x},part:{value:p},word:{value:self},ordinal:{value:ordinal},length:{value:1}}));x+=p.width;ordinal++},wordPart.run.text)});var lastChar=cache[cache.length-1];if(lastChar){Object.defineProperty(lastChar,"width",{value:this.width-lastChar.left});if(this.word.isNewLine()||this.word.code()&&this.word.code().eof){Object.defineProperty(lastChar,"newLine",{value:true})}}this._characters=cache}},children:function(){this.realiseCharacters();return this._characters},parent:function(){return this.line},type:"word"});module.exports=function(word,line,left,ordinal,width){var pword=Object.create(prototype,{word:{value:word},line:{value:line},left:{value:left},width:{value:width},ordinal:{value:ordinal},length:{value:word.text.length+word.space.length}});return pword}},"range.js":function(exports,module,require){var per=require("per");var runs=require("./runs");function Range(doc,start,end){this.doc=doc;this.start=start;this.end=end;if(start>end){this.start=end;this.end=start}}Range.prototype.parts=function(emit,list){list=list||this.doc.children();var self=this;list.some(function(item){if(item.ordinal+item.length<=self.start){return false}if(item.ordinal>=self.end){return true}if(item.ordinal>=self.start&&item.ordinal+item.length<=self.end){emit(item)}else{self.parts(emit,item.children())}})};Range.prototype.clear=function(){return this.setText([])};Range.prototype.setText=function(text){return this.doc.splice(this.start,this.end,text)};Range.prototype.runs=function(emit){this.doc.runs(emit,this)};Range.prototype.plainText=function(){return per(this.runs,this).map(runs.getPlainText).all().join("")};Range.prototype.save=function(){return per(this.runs,this).per(runs.consolidate()).all()};Range.prototype.getFormatting=function(){var range=this;if(range.start===range.end){var pos=range.start;if(pos>0){pos--}range.start=pos;range.end=pos+1}return per(range.runs,range).reduce(runs.merge).last()||runs.defaultFormatting};Range.prototype.setFormatting=function(attribute,value){var range=this;if(attribute==="align"){range=range.doc.paragraphRange(range.start,range.end)}if(range.start===range.end){range.doc.modifyInsertFormatting(attribute,value)}else{var saved=range.save();var template={};template[attribute]=value;runs.format(saved,template);range.setText(saved)}};module.exports=function(doc,start,end){return new Range(doc,start,end)}},"rect.js":function(exports,module,require){var prototype={contains:function(x,y){return x>=this.l&&x<this.l+this.w&&y>=this.t&&y<this.t+this.h},stroke:function(ctx){ctx.strokeRect(this.l,this.t,this.w,this.h)},fill:function(ctx){ctx.fillRect(this.l,this.t,this.w,this.h)},offset:function(x,y){return rect(this.l+x,this.t+y,this.w,this.h)},equals:function(other){return this.l===other.l&&this.t===other.t&&this.w===other.w&&this.h===other.h},center:function(){return{x:this.l+this.w/2,y:this.t+this.h/2}}};var rect=module.exports=function(l,t,w,h){return Object.create(prototype,{l:{value:l},t:{value:t},w:{value:w},h:{value:h},r:{value:l+w},b:{value:t+h}})}},"runs.js":function(exports,module,require){exports.formattingKeys=["bold","italic","underline","strikeout","color","font","size","align","script"];exports.defaultFormatting={size:10,font:"sans-serif",color:"black",bold:false,italic:false,underline:false,strikeout:false,align:"left",script:"normal"};exports.sameFormatting=function(run1,run2){return exports.formattingKeys.every(function(key){return run1[key]===run2[key]})};exports.clone=function(run){var result={text:run.text};exports.formattingKeys.forEach(function(key){var val=run[key];if(val&&val!=exports.defaultFormatting[key]){result[key]=val}});return result};exports.multipleValues={};exports.merge=function(run1,run2){if(arguments.length===1){return Array.isArray(run1)?run1.reduce(exports.merge):run1}if(arguments.length>2){return exports.merge(Array.prototype.slice.call(arguments,0))}var merged={};exports.formattingKeys.forEach(function(key){if(key in run1||key in run2){if(run1[key]===run2[key]){merged[key]=run1[key]}else{merged[key]=exports.multipleValues}}});return merged};exports.format=function(run,template){if(Array.isArray(run)){run.forEach(function(r){exports.format(r,template)})}else{Object.keys(template).forEach(function(key){if(template[key]!==exports.multipleValues){run[key]=template[key]}})}};exports.consolidate=function(){var current;return function(emit,run){if(!current||!exports.sameFormatting(current,run)||typeof current.text!="string"||typeof run.text!="string"){current=exports.clone(run);emit(current)}else{current.text+=run.text}}};exports.getPlainText=function(run){if(typeof run.text==="string"){return run.text}if(Array.isArray(run.text)){var str=[];run.text.forEach(function(piece){str.push(exports.getPiecePlainText(piece))});return str.join("")}return"_"};exports.getPieceLength=function(piece){return piece.length||1};exports.getPiecePlainText=function(piece){return piece.length?piece:"_"};exports.getTextLength=function(text){if(typeof text==="string"){return text.length}if(Array.isArray(text)){var length=0;text.forEach(function(piece){length+=exports.getPieceLength(piece)});return length}return 1};exports.getSubText=function(emit,text,start,count){if(count===0){return}if(typeof text==="string"){emit(text.substr(start,count));return}if(Array.isArray(text)){var pos=0;text.some(function(piece){if(count<=0){return true}var pieceLength=exports.getPieceLength(piece);if(pos+pieceLength>start){if(pieceLength===1){emit(piece);count-=1}else{var str=piece.substr(Math.max(0,start-pos),count);emit(str);count-=str.length}}pos+=pieceLength});return}emit(text)};exports.getTextChar=function(text,offset){var result;exports.getSubText(function(c){result=c},text,offset,1);return result};exports.pieceCharacters=function(each,piece){if(typeof piece==="string"){for(var c=0;c<piece.length;c++){each(piece[c])}}else{each(piece)}}},"split.js":function(exports,module,require){module.exports=function(codes){var word=null,trailingSpaces=null,newLine=true;return function(emit,inputChar){var endOfWord;if(inputChar.char===null){endOfWord=true}else{if(newLine){endOfWord=true;newLine=false}if(typeof inputChar.char==="string"){switch(inputChar.char){case" ":if(!trailingSpaces){trailingSpaces=inputChar}break;case"\n":endOfWord=true;newLine=true;break;default:if(trailingSpaces){endOfWord=true}}}else{var code=codes(inputChar.char);if(code.block||code.eof){endOfWord=true;newLine=true}}}if(endOfWord){if(word&&!word.equals(inputChar)){if(emit({text:word,spaces:trailingSpaces||inputChar,end:inputChar})===false){return false}trailingSpaces=null}if(inputChar.char===null){emit(null)}word=inputChar}}}},"text.js":function(exports,module,require){var runs=require("./runs");var getFontString=exports.getFontString=function(run){var size=run&&run.size||runs.defaultFormatting.size;if(run){switch(run.script){case"super":case"sub":size*=.8;break}}return(run&&run.italic?"italic ":"")+(run&&run.bold?"bold ":"")+" "+size+"pt "+(run&&run.font||runs.defaultFormatting.font)};exports.applyRunStyle=function(ctx,run){ctx.fillStyle=run&&run.color||runs.defaultFormatting.color;ctx.font=getFontString(run)};exports.prepareContext=function(ctx){ctx.textAlign="left";ctx.textBaseline="alphabetic"};exports.getRunStyle=function(run){var parts=["font: ",getFontString(run),"; color: ",run&&run.color||runs.defaultFormatting.color];if(run){switch(run.script){case"super":parts.push("; vertical-align: super");break;case"sub":parts.push("; vertical-align: sub");break}}return parts.join("")};var nbsp=exports.nbsp=String.fromCharCode(160);var enter=exports.enter=nbsp;var measureText=exports.measureText=function(text,style){var span,block,div;span=document.createElement("span");block=document.createElement("div");div=document.createElement("div");block.style.display="inline-block";block.style.width="1px";block.style.height="0";div.style.visibility="hidden";div.style.position="absolute";div.style.top="0";div.style.left="0";div.style.width="500px";div.style.height="200px";div.appendChild(span);div.appendChild(block);document.body.appendChild(div);try{span.setAttribute("style",style);span.innerHTML="";span.appendChild(document.createTextNode(text.replace(/\s/g,nbsp)));var result={};block.style.verticalAlign="baseline";result.ascent=block.offsetTop-span.offsetTop;block.style.verticalAlign="bottom";result.height=block.offsetTop-span.offsetTop;result.descent=result.height-result.ascent;result.width=span.offsetWidth}finally{div.parentNode.removeChild(div);div=null}return result};var createCachedMeasureText=exports.createCachedMeasureText=function(){var cache={};return function(text,style){var key=style+"<>!&%"+text;var result=cache[key];if(!result){cache[key]=result=measureText(text,style)}return result}};exports.cachedMeasureText=createCachedMeasureText();exports.measure=function(str,formatting){return exports.cachedMeasureText(str,exports.getRunStyle(formatting))};exports.draw=function(ctx,str,formatting,left,baseline,width,ascent,descent){exports.prepareContext(ctx);exports.applyRunStyle(ctx,formatting);switch(formatting.script){case"super":baseline-=ascent*(1/3);break;case"sub":baseline+=descent/2;break}ctx.fillText(str==="\n"?exports.enter:str,left,baseline);if(formatting.underline){ctx.fillRect(left,1+baseline,width,1)}if(formatting.strikeout){ctx.fillRect(left,1+baseline-ascent/2,width,1)}}},"util.js":function(exports,module,require){exports.event=function(){var handlers=[];var subscribe=function(handler){handlers.push(handler)};subscribe.fire=function(){var args=Array.prototype.slice.call(arguments,0);handlers.forEach(function(handler){handler.apply(null,args)})};return subscribe};exports.derive=function(prototype,methods){var properties={};Object.keys(methods).forEach(function(name){properties[name]={value:methods[name]}});return Object.create(prototype,properties)}},"word.js":function(exports,module,require){var per=require("per");var part=require("./part");var runs=require("./runs");var prototype={isNewLine:function(){return this.text.parts.length==1&&this.text.parts[0].isNewLine},code:function(){return this.text.parts.length==1&&this.text.parts[0].code},codeFormatting:function(){return this.text.parts.length==1&&this.text.parts[0].run},draw:function(ctx,x,y){per(this.text.parts).concat(this.space.parts).forEach(function(part){part.draw(ctx,x,y);x+=part.width})},plainText:function(){return this.text.plainText+this.space.plainText},align:function(){var first=this.text.parts[0];return first?first.run.align:"left"},runs:function(emit,range){var start=range&&range.start||0,end=range&&range.end;if(typeof end!=="number"){end=Number.MAX_VALUE}[this.text,this.space].forEach(function(section){section.parts.some(function(part){if(start>=end||end<=0){return true}var run=part.run,text=run.text;if(typeof text==="string"){if(start<=0&&end>=text.length){emit(run)}else if(start<text.length){var pieceRun=Object.create(run);var firstChar=Math.max(0,start);pieceRun.text=text.substr(firstChar,Math.min(text.length,end-firstChar));emit(pieceRun)}start-=text.length;end-=text.length}else{if(start<=0&&end>=1){emit(run)}start--;end--}})})}};var section=function(runEmitter,codes){var s={parts:per(runEmitter).map(function(p){return part(p,codes)}).all(),ascent:0,descent:0,width:0,length:0,plainText:""};s.parts.forEach(function(p){s.ascent=Math.max(s.ascent,p.ascent);s.descent=Math.max(s.descent,p.descent);s.width+=p.width;s.length+=runs.getPieceLength(p.run.text);s.plainText+=runs.getPiecePlainText(p.run.text)});return s};module.exports=function(coords,codes){var text,space;if(!coords){text=[{text:"\n"}];space=[]}else{text=coords.text.cut(coords.spaces);space=coords.spaces.cut(coords.end)}text=section(text,codes);space=section(space,codes);var word=Object.create(prototype,{text:{value:text},space:{value:space},ascent:{value:Math.max(text.ascent,space.ascent)},descent:{value:Math.max(text.descent,space.descent)},width:{value:text.width+space.width,configurable:true},length:{value:text.length+space.length}});if(!coords){Object.defineProperty(word,"eof",{value:true})}return word}},"wrap.js":function(exports,module,require){var line=require("./line");module.exports=function(left,top,width,ordinal,parent,includeTerminator,initialAscent,initialDescent){var lineBuffer=[],lineWidth=0,maxAscent=initialAscent||0,maxDescent=initialDescent||0,quit,lastNewLineHeight=0,y=top;var store=function(word,emit){lineBuffer.push(word);lineWidth+=word.width;maxAscent=Math.max(maxAscent,word.ascent);maxDescent=Math.max(maxDescent,word.descent);if(word.isNewLine()){send(emit);lastNewLineHeight=word.ascent+word.descent}};var send=function(emit){if(quit||lineBuffer.length===0){return}var l=line(parent,left,width,y+maxAscent,maxAscent,maxDescent,lineBuffer,ordinal);ordinal+=l.length;quit=emit(l);y+=maxAscent+maxDescent;lineBuffer.length=0;lineWidth=maxAscent=maxDescent=0};var consumer=null;return function(emit,inputWord){if(consumer){lastNewLineHeight=0;var node=consumer(inputWord);if(node){consumer=null;ordinal+=node.length;y+=node.bounds().h;Object.defineProperty(node,"block",{value:true});emit(node)}}else{var code=inputWord.code();if(code&&code.block){if(lineBuffer.length){send(emit)}else{y+=lastNewLineHeight}consumer=code.block(left,y,width,ordinal,parent,inputWord.codeFormatting());lastNewLineHeight=0}else if(code&&code.eof||inputWord.eof){if(!code||includeTerminator&&includeTerminator(code)){store(inputWord,emit)}if(!lineBuffer.length){emit(y+lastNewLineHeight-top)}else{send(emit);emit(y-top)}quit=true}else{lastNewLineHeight=0;if(!lineBuffer.length){store(inputWord,emit)}else{if(lineWidth+inputWord.text.width>width){send(emit)}store(inputWord,emit)}}}return quit}}}},common:{base:{"hp_SE2M_Menubar.js":function(exports,module,require){nhn.husky.SE2M_Menubar=jindo.$Class({name:"SE2M_Menubar",menubarArea:null,menubarTitle:null,menubarItem:null,_assignHTMLElements:function(container){this.container=jindo.$(container)||document;this.menubarArea=jindo.$$.getSingle(".menu_bar",container);this.menus=jindo.$$(">[class*=menu_]",this.menubarArea);console.log("this.menus.length = "+this.menus.length);for(var i=0;i<this.menus.length;i++){if(new RegExp("menu_([^ ]+)").test(this.menus[i].className)){var menuName=RegExp.$1;var items=jindo.$$("[class*=item_]",this.menus[i]);console.log("items.length = "+items.length);for(var j=0;j<items.length;j++){if(new RegExp("item_([^ ]+)").test(items[j].className)){var itemName=RegExp.$1;this.items[menuName+"_"+itemName]=items[j]}}}}},$init:function(container,options){this._options=options||{};this.items={};this._assignHTMLElements(container)},$ON_MSG_APP_READY:function(){},$ON_REGISTER_MENU_EVENT:function(sName,sEvent,sCmd,aParams){var elButton;elButton=jindo.$Element(this.items[sName]);if(!elButton)return;this.oApp.registerBrowserEvent(elButton,sEvent,sCmd,aParams)}})}}},fundamental:{base:{"hp_SE2M_ExecCommand.js":function(exports,module,require){nhn.husky.SE2M_ExecCommand=jindo.$Class({name:"SE2M_ExecCommand",$init:function(elAppContainer){this.$file=$("input[type=file]");this.$file.on("change",function(){})},$BEFORE_MSG_APP_READY:function(){},$ON_MSG_APP_READY:function(){this.oApp.exec("REGISTER_MENU_EVENT",["FILE_LOAD","click","EXECCOMMAND",["FILE_LOAD",false,false]]);this.oApp.exec("REGISTER_MENU_EVENT",["FILE_DOWNLOAD","click","EXECCOMMAND",["FILE_DOWNLOAD",false,false]])},$BEFORE_EXECCOMMAND:function(sCommand,bUserInterface,vValue,htOptions){},$ON_EXECCOMMAND:function(sCommand,bUserInterface,vValue){switch(sCommand){case"FILE_LOAD":this.$file.click();break;case"FILE_DOWNLOAD":break}},$AFTER_EXECCOMMAND:function(sCommand,bUserInterface,vValue,htOptions){}})}},editing:{"hp_SE_EditingArea.js":function(exports,module,require){nhn.husky.SE_EditingArea=jindo.$Class({name:"SE_EditingArea",$init:function(appContainer){this.appContainer=appContainer;this.menuBar=appContainer.querySelector("#menuBar");this.toolBar=appContainer.querySelector("#toolBar");this.statusBar=appContainer.querySelector("#statusBar");var container=this.container=appContainer.querySelector(".container"),document=this.document=container.querySelector(".document"),ruler=this.ruler=container.querySelector(".ruler"),editingArea=this.editingArea=document.querySelector(".editing_area");this.scrollView=document.querySelector("#scrollView");this.scrollViewHorizontal=document.querySelector("#scrollViewHorizontal");this.scrollViewVertical=document.querySelector("#scrollViewVertical");this.editCanvas=editingArea.querySelector("#editCanvas");this.doc=hwp.doc();this.RATIO=3.78;this.documentWidth=Math.floor(210*this.RATIO);this.documentHeight=Math.floor(297*this.RATIO);this.documentMargin=20;this.paddingTop=Math.floor(20*this.RATIO);this.paddingBottom=Math.floor(15*this.RATIO);this.paddingLeft=Math.floor(30*this.RATIO);this.paddingRight=Math.floor(30*this.RATIO);this.paddingHead=Math.floor(15*this.RATIO);this.paddingTail=Math.floor(15*this.RATIO);this.offsetX=0;this.offsetY=0},$BEFORE_MSG_APP_READY:function(){},$ON_MSG_APP_READY:function(){this.oApp.registerBrowserEvent(this.scrollView,"scroll","EVENT_SCROLL_VIEW_SCROLL",[],null,10);this.oApp.registerBrowserEvent(window,"resize","EVENT_WINDOW_RESIZE",[],null,100)},$AFTER_MSG_APP_READY:function(){this.oApp.exec("EVENT_WINDOW_RESIZE")},$ON_EVENT_SCROLL_VIEW_SCROLL:function(){this.oApp.exec("EDITING_AREA_PAINT")},$ON_EVENT_WINDOW_RESIZE:function(){this.editingArea.style.width=100+"%";this.editingArea.style.height=this.appContainer.clientHeight-(this.menuBar.clientHeight+this.toolBar.clientHeight+this.ruler.clientHeight+this.statusBar.clientHeight)+"px";this.scrollView.style.width=this.editingArea.clientWidth+"px";this.scrollView.style.height=this.editingArea.clientHeight+"px";this.oApp.exec("EDITING_AREA_PAINT");this.oApp.exec("POSITION_CENTER")},$ON_PASTE_HTML:function(sHTML,oPSelection,htOption){var runs=carota.html.parse(sHTML,{});this.doc.load(runs);this.oApp.exec("EVENT_WINDOW_RESIZE")},$ON_POSITION_CENTER:function(){var editingAreaWidth=this.editingArea.clientWidth,editingAreaHeight=this.editingArea.clientHeight;if(this.documentWidth>editingAreaWidth){this.scrollView.scrollLeft=(this.documentWidth+this.documentMargin*2-editingAreaWidth)/2}},$ON_EDITING_AREA_PAINT:function(){console.log("$ON_EDITING_AREA_PAINT is called...");var editingAreaWidth=this.editingArea.clientWidth,editingAreaHeight=this.editingArea.clientHeight;this.offsetX=(editingAreaWidth-this.documentWidth)/2;this.offsetY=(editingAreaHeight-this.documentHeight)/2;if(this.offsetX<0)this.offsetX=0;if(this.offsetY<0)this.offsetY=0;this.offsetX+=this.documentMargin;this.offsetY+=this.documentMargin;var dpr=Math.max(1,window.devicePixelRatio||1);var canvasWidth=Math.max(this.documentWidth,editingAreaWidth),canvasHeight=Math.min(this.documentHeight,editingAreaHeight)-16;this.editCanvas.width=dpr*canvasWidth;this.editCanvas.height=dpr*canvasHeight;this.editCanvas.style.width=canvasWidth+"px";this.editCanvas.style.height=canvasHeight+"px";this.scrollViewHorizontal.style.width=canvasWidth+"px";this.scrollViewVertical.style.height=this.documentHeight+"px";var ctx=this.editCanvas.getContext("2d");ctx.scale(dpr,dpr);ctx.translate(-this.scrollView.scrollLeft,-this.scrollView.scrollTop);ctx.clearRect(0,0,canvasWidth,this.documentHeight);ctx.fillStyle="white";ctx.fillRect(this.offsetX,this.offsetY,this.documentWidth,this.documentHeight);this._drawPaddingMark(ctx);var availableWidth=this.documentWidth-(this.paddingLeft+this.paddingRight),availableHeight=this.documentHeight-(this.paddingTop+this.paddingHead+this.paddingBottom+this.paddingTail);this.doc.layout(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead,availableWidth)},_drawPaddingMark:function(ctx){ctx.beginPath();ctx.strokeStyle="#c5c5c5";ctx.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead);ctx.lineTo(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead-20);ctx.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead);ctx.lineTo(this.offsetX+this.paddingLeft-20,this.offsetY+this.paddingTop+this.paddingHead);ctx.moveTo(this.offsetX+this.documentWidth-this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead);ctx.lineTo(this.offsetX+this.documentWidth-this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead-20);ctx.moveTo(this.offsetX+this.documentWidth-this.paddingLeft,this.offsetY+this.paddingTop+this.paddingHead);ctx.lineTo(this.offsetX+this.documentWidth-this.paddingLeft+20,this.offsetY+this.paddingTop+this.paddingHead);ctx.moveTo(this.offsetX+this.documentWidth-this.paddingRight,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail);ctx.lineTo(this.offsetX+this.documentWidth-this.paddingRight,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail+20);ctx.moveTo(this.offsetX+this.documentWidth-this.paddingRight,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail);ctx.lineTo(this.offsetX+this.documentWidth-this.paddingRight+20,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail);ctx.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail);ctx.lineTo(this.offsetX+this.paddingLeft,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail+20);ctx.moveTo(this.offsetX+this.paddingLeft,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail);ctx.lineTo(this.offsetX+this.paddingLeft-20,this.offsetY+this.documentHeight-this.paddingBottom-this.paddingTail);ctx.stroke()},$ON_EDITING_AREA_UPDATE:function(){var requirePaint=false;if(requirePaint){paint()}}})},"hp_SE_EditingAreaManager.js":function(exports,module,require){nhn.husky.SE_EditingAreaManager=jindo.$Class({name:"SE_EditingAreaManager",oActivePlugin:null,elContentsField:null,bIsDirty:false,bAutoResize:false,$init:function(sDefaultEditingMode,elContentsField,oDimension,fOnBeforeUnload,elAppContainer){this.sDefaultEditingMode=sDefaultEditingMode;this.elContentsField=jindo.$(elContentsField);this.elEditingAreaContainer=jindo.$$.getSingle("div.container",elAppContainer);this.fOnBeforeUnload=fOnBeforeUnload;this.oEditingMode={};this.elContentsField.style.display="none"},_getSize:function(aSize,nMin){var i,nLen,aRxResult,nSize,sUnit,sDefaultUnit="px";nMin=parseInt(nMin,10);for(i=0,nLen=aSize.length;i<nLen;i++){if(!aSize[i]){continue}if(!isNaN(aSize[i])){nSize=parseInt(aSize[i],10);sUnit=sDefaultUnit;break}aRxResult=/([0-9]+)(.*)/i.exec(aSize[i]);if(!aRxResult||aRxResult.length<2||aRxResult[1]<=0){continue}nSize=parseInt(aRxResult[1],10);sUnit=aRxResult[2];if(!sUnit){sUnit=sDefaultUnit}if(nSize<nMin&&sUnit===sDefaultUnit){nSize=nMin}break}if(!sUnit){sUnit=sDefaultUnit}if(isNaN(nSize)||nSize<nMin&&sUnit===sDefaultUnit){nSize=nMin}return{nSize:nSize,sUnit:sUnit}},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["version",nhn.husky.SE_EditingAreaManager.version]);this.oApp.exec("ADD_APP_PROPERTY",["elEditingAreaContainer",this.elEditingAreaContainer]);this.oApp.exec("ADD_APP_PROPERTY",["welEditingAreaContainer",jindo.$Element(this.elEditingAreaContainer)]);this.oApp.exec("ADD_APP_PROPERTY",["getEditingAreaHeight",jindo.$Fn(this.getEditingAreaHeight,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getEditingAreaWidth",jindo.$Fn(this.getEditingAreaWidth,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getRawContents",jindo.$Fn(this.getRawContents,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getContents",jindo.$Fn(this.getContents,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getIR",jindo.$Fn(this.getIR,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["setContents",this.setContents]);this.oApp.exec("ADD_APP_PROPERTY",["setIR",this.setIR]);this.oApp.exec("ADD_APP_PROPERTY",["getEditingMode",jindo.$Fn(this.getEditingMode,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getWindow",jindo.$Fn(this.getWindow,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getDocument",jindo.$Fn(this.getDocument,this).bind()])},$ON_MSG_APP_READY:function(){this.htOptions=this.oApp.htOptions[this.name]||{};this.sDefaultEditingMode=this.htOptions["sDefaultEditingMode"]||this.sDefaultEditingMode;this.oApp.exec("REGISTER_CONVERTERS",[]);this.oApp.exec("CHANGE_EDITING_MODE",[this.sDefaultEditingMode,true]);this.oApp.exec("LOAD_CONTENTS_FIELD",[false]);if(this.fOnBeforeUnload!==false){if(this.fOnBeforeUnload){window.onbeforeunload=this.fOnBeforeUnload}else{window.onbeforeunload=jindo.$Fn(function(){if(this.getRawContents()!=this.sCurrentRawContents||this.bIsDirty){return this.oApp.$MSG("SE_EditingAreaManager.onExit")}},this).bind()}}},$AFTER_MSG_APP_READY:function(){this.oApp.exec("UPDATE_RAW_CONTENTS");if(!!this.oApp.htOptions[this.name]&&this.oApp.htOptions[this.name].bAutoResize){this.bAutoResize=this.oApp.htOptions[this.name].bAutoResize}if(this.oApp.oNavigator.msafari){this.bAutoResize=true}this.startAutoResize()},$ON_LOAD_CONTENTS_FIELD:function(bDontAddUndo){var sContentsFieldValue=this.elContentsField.value;sContentsFieldValue=sContentsFieldValue.replace(/^\s+/,"");this.oApp.exec("SET_CONTENTS",[sContentsFieldValue,bDontAddUndo])},$ON_UPDATE_CONTENTS_FIELD:function(){this.elContentsField.value=this.oApp.getContents();this.oApp.exec("UPDATE_RAW_CONTENTS")},$ON_UPDATE_RAW_CONTENTS:function(){this.sCurrentRawContents=this.oApp.getRawContents()},$BEFORE_CHANGE_EDITING_MODE:function(sMode){if(!this.oEditingMode[sMode]){return false}this.stopAutoResize();this._oPrevActivePlugin=this.oActivePlugin;this.oActivePlugin=this.oEditingMode[sMode]},$AFTER_CHANGE_EDITING_MODE:function(sMode,bNoFocus){if(this._oPrevActivePlugin){var sIR=this._oPrevActivePlugin.getIR();this.oApp.exec("SET_IR",[sIR]);this._setEditingAreaDimension()}this.startAutoResize();if(!bNoFocus){this.oApp.delayedExec("FOCUS",[],0)}},$ON_SET_IS_DIRTY:function(bIsDirty){this.bIsDirty=bIsDirty},$ON_FOCUS:function(isPopupOpening){if(!this.oActivePlugin||typeof this.oActivePlugin.setIR!="function"){return}if(!!this.iframeWindow&&this.iframeWindow.document.hasFocus&&!this.iframeWindow.document.hasFocus()&&this.oActivePlugin.sMode=="WYSIWYG"){this.iframeWindow.focus()}else{this.oActivePlugin.focus()}if(isPopupOpening&&this.oApp.bMobile){return}this.oActivePlugin.focus()},$ON_IE_FOCUS:function(){var oAgent=this.oApp.oNavigator;if(!oAgent.ie&&!oAgent.edge){return}this.oApp.exec("FOCUS")},$ON_SET_CONTENTS:function(sContents,bDontAddUndoHistory){this.setContents(sContents,bDontAddUndoHistory)},$BEFORE_SET_IR:function(sIR,bDontAddUndoHistory){bDontAddUndoHistory=bDontAddUndoHistory||false;if(!bDontAddUndoHistory){this.oApp.exec("RECORD_UNDO_ACTION",["BEFORE SET CONTENTS",{sSaveTarget:"BODY"}])}},$ON_SET_IR:function(sIR){if(!this.oActivePlugin||typeof this.oActivePlugin.setIR!="function"){return}this.oActivePlugin.setIR(sIR)},$AFTER_SET_IR:function(sIR,bDontAddUndoHistory){bDontAddUndoHistory=bDontAddUndoHistory||false;if(!bDontAddUndoHistory){this.oApp.exec("RECORD_UNDO_ACTION",["AFTER SET CONTENTS",{sSaveTarget:"BODY"}])}},$ON_REGISTER_EDITING_AREA:function(oEditingAreaPlugin){this.oEditingMode[oEditingAreaPlugin.sMode]=oEditingAreaPlugin;this._setEditingAreaDimension(oEditingAreaPlugin)},$ON_MSG_EDITING_AREA_RESIZE_STARTED:function(){this._fitElementInEditingArea(this.elEditingAreaContainer);this.oApp.exec("STOP_AUTORESIZE_EDITING_AREA");this.oApp.exec("SHOW_EDITING_AREA_COVER");this.elEditingAreaContainer.style.overflow="hidden";this.iStartingHeight=parseInt(this.elEditingAreaContainer.style.height,10)},$ON_STOP_AUTORESIZE_EDITING_AREA:function(){if(!this.bAutoResize){return}this.stopAutoResize();this.bAutoResize=false},startAutoResize:function(){if(!this.bAutoResize||!this.oActivePlugin||typeof this.oActivePlugin.startAutoResize!="function"){return}this.oActivePlugin.startAutoResize()},stopAutoResize:function(){if(!this.bAutoResize||!this.oActivePlugin||typeof this.oActivePlugin.stopAutoResize!="function"){return}this.oActivePlugin.stopAutoResize()},$ON_RESIZE_EDITING_AREA:function(ipNewWidth,ipNewHeight){if(ipNewWidth!==null&&typeof ipNewWidth!=="undefined"){this._resizeWidth(ipNewWidth,"px")}if(ipNewHeight!==null&&typeof ipNewHeight!=="undefined"){this._resizeHeight(ipNewHeight,"px")}this._setEditingAreaDimension()},_resizeWidth:function(ipNewWidth,sUnit){var iNewWidth=parseInt(ipNewWidth,10);if(iNewWidth<this.nMinWidth){iNewWidth=this.nMinWidth}if(ipNewWidth){this.elEditingAreaContainer.style.width=iNewWidth+sUnit}},_resizeHeight:function(ipNewHeight,sUnit){var iNewHeight=parseInt(ipNewHeight,10);if(iNewHeight<this.nMinHeight){iNewHeight=this.nMinHeight}if(ipNewHeight){this.elEditingAreaContainer.style.height=iNewHeight+sUnit}},$ON_RESIZE_EDITING_AREA_BY:function(ipWidthChange,ipHeightChange){var iWidthChange=parseInt(ipWidthChange,10);var iHeightChange=parseInt(ipHeightChange,10);var iWidth;var iHeight;if(ipWidthChange!==0&&this.elEditingAreaContainer.style.width.indexOf("%")===-1){iWidth=this.elEditingAreaContainer.style.width?parseInt(this.elEditingAreaContainer.style.width,10)+iWidthChange:null}if(iHeightChange!==0){iHeight=this.elEditingAreaContainer.style.height?this.iStartingHeight+iHeightChange:null}if(!ipWidthChange&&!iHeightChange){return}this.oApp.exec("RESIZE_EDITING_AREA",[iWidth,iHeight])},$ON_MSG_EDITING_AREA_RESIZE_ENDED:function(){this.oApp.exec("HIDE_EDITING_AREA_COVER");this.elEditingAreaContainer.style.overflow="";this._setEditingAreaDimension()},$ON_SHOW_EDITING_AREA_COVER:function(bDimmed){if(!this.elEditingAreaCover){this.elEditingAreaCover=document.createElement("DIV");this.elEditingAreaCover.style.cssText="position:absolute;top:0;left:0;z-index:100;background:#000000;filter:alpha(opacity=0);opacity:0.0;-moz-opacity:0.0;-khtml-opacity:0.0;height:100%;width:100%";this.elEditingAreaContainer.appendChild(this.elEditingAreaCover)}if(bDimmed){jindo.$Element(this.elEditingAreaCover).opacity(.4)}this.elEditingAreaCover.style.display="block"},$ON_HIDE_EDITING_AREA_COVER:function(){if(!this.elEditingAreaCover){return}this.elEditingAreaCover.style.display="none";jindo.$Element(this.elEditingAreaCover).opacity(0)},$ON_KEEP_WITHIN_EDITINGAREA:function(elLayer,nHeight){var nTop=parseInt(elLayer.style.top,10);if(nTop+elLayer.offsetHeight>this.oApp.elEditingAreaContainer.offsetHeight){if(typeof nHeight=="number"){elLayer.style.top=nTop-elLayer.offsetHeight-nHeight+"px"}else{elLayer.style.top=this.oApp.elEditingAreaContainer.offsetHeight-elLayer.offsetHeight+"px"}}var nLeft=parseInt(elLayer.style.left,10);if(nLeft+elLayer.offsetWidth>this.oApp.elEditingAreaContainer.offsetWidth){elLayer.style.left=this.oApp.elEditingAreaContainer.offsetWidth-elLayer.offsetWidth+"px"}},$ON_EVENT_EDITING_AREA_KEYDOWN:function(){this.oApp.exec("HIDE_ACTIVE_LAYER",[])},$ON_EVENT_EDITING_AREA_MOUSEDOWN:function(){this.oApp.exec("HIDE_ACTIVE_LAYER",[])},$ON_EVENT_EDITING_AREA_SCROLL:function(){this.oApp.exec("HIDE_ACTIVE_LAYER",[])},_setEditingAreaDimension:function(oEditingAreaPlugin){oEditingAreaPlugin=oEditingAreaPlugin||this.oActivePlugin;this._fitElementInEditingArea(oEditingAreaPlugin.elEditingArea)},_fitElementInEditingArea:function(el){el.style.height=this.elEditingAreaContainer.offsetHeight+"px"},attachDocumentEvents:function(doc){this.oApp.registerBrowserEvent(doc,"click","EVENT_EDITING_AREA_CLICK");this.oApp.registerBrowserEvent(doc,"dblclick","EVENT_EDITING_AREA_DBLCLICK");this.oApp.registerBrowserEvent(doc,"mousedown","EVENT_EDITING_AREA_MOUSEDOWN");this.oApp.registerBrowserEvent(doc,"mousemove","EVENT_EDITING_AREA_MOUSEMOVE");this.oApp.registerBrowserEvent(doc,"mouseup","EVENT_EDITING_AREA_MOUSEUP");this.oApp.registerBrowserEvent(doc,"mouseout","EVENT_EDITING_AREA_MOUSEOUT");this.oApp.registerBrowserEvent(doc,"mousewheel","EVENT_EDITING_AREA_MOUSEWHEEL");this.oApp.registerBrowserEvent(doc,"keydown","EVENT_EDITING_AREA_KEYDOWN");this.oApp.registerBrowserEvent(doc,"keypress","EVENT_EDITING_AREA_KEYPRESS");this.oApp.registerBrowserEvent(doc,"keyup","EVENT_EDITING_AREA_KEYUP");this.oApp.registerBrowserEvent(doc,"scroll","EVENT_EDITING_AREA_SCROLL")},$ON_GET_COVER_DIV:function(sAttr,oReturn){if(this.elEditingAreaCover){oReturn[sAttr]=this.elEditingAreaCover}},$ON_SHOW_LOADING_LAYER:function(){this.elLoadingLayer.style.display="block"},$ON_HIDE_LOADING_LAYER:function(){this.elLoadingLayer.style.display="none"},getIR:function(){if(!this.oActivePlugin){return""}return this.oActivePlugin.getIR()},setIR:function(sIR,bDontAddUndo){this.oApp.exec("SET_IR",[sIR,bDontAddUndo])},getRawContents:function(){if(!this.oActivePlugin){return""}return this.oActivePlugin.getRawContents()},getContents:function(){this._convertLastBrToNbsp();var sIR=this.oApp.getIR();var sContents;if(this.oApp.applyConverter){sContents=this.oApp.applyConverter("IR_TO_DB",sIR,this.oApp.getDocument())}else{sContents=sIR}sContents=this._cleanContents(sContents);return sContents},_convertLastBrToNbsp:function(){var elBody=this.oApp.getDocument().body,aBr,elBr,elBrContainer,elImgContainer,elNextToImgContainer,elUndesiredContainer,aImg,elImg,nImgWidth,elImgParent,nParentWidth,bConvertBrToNbsp,oNbsp=document.createTextNode(" "),oNbspClone,elBrParent;aBr=jindo.$$("br:last-child",elBody,{oneTimeOffCache:true});for(var i=0,len=aBr.length;i<len;i++){elImg=null;elBrParent=null;elBr=aBr[i];elImgContainer=this._findNextSiblingRecursive(elBr,{isReverse:true});if(!(elImgContainer&&elImgContainer.nodeType===1)){continue}elBrContainer=elImgContainer.nextSibling;elUndesiredContainer=this._findNextSiblingRecursive(elBrContainer);if(elUndesiredContainer){continue}if(elImgContainer.tagName.toUpperCase()==="IMG"){elImg=elImgContainer}else{aImg=jindo.$$("img:last-child",elImgContainer,{oneTimeOffCache:true});if(aImg.length>0){elImg=aImg[aImg.length-1]}}if(elImg){elNextToImgContainer=this._findNextSiblingRecursive(elImg);if(elNextToImgContainer==elBrContainer){elImgParent=elImg.parentNode;if(!elImgParent){continue}nImgWidth=jindo.$Element(elImg).width(),elImgParent=elImg.parentNode,nParentWidth=jindo.$Element(elImgParent).width();bConvertBrToNbsp=!(nImgWidth===nParentWidth)}else{bConvertBrToNbsp=true}}else{bConvertBrToNbsp=true}elBrParent=elBr.parentNode;if(bConvertBrToNbsp){oNbspClone=oNbsp.cloneNode(false);elBrParent.replaceChild(oNbspClone,elBr)}else{this._recursiveRemoveChild(elBr)}}},_findNextSiblingRecursive:function(el,htOption){var elTarget=el,elSibling,isReverse=htOption&&htOption.isReverse?true:false,rxContainer=new RegExp("^(TD|BODY)$","i");while(!elSibling){if(isReverse){elSibling=elTarget.previousSibling}else{elSibling=elTarget.nextSibling}elTarget=elTarget.parentNode;if(rxContainer.test(elTarget.tagName)){elSibling=null;break}}return elSibling},_recursiveRemoveChild:function(el){var elParent=el.parentNode,elChild=el,aChild;do{elParent.removeChild(elChild)}while((aChild=elParent.childNodes)&&aChild.length==0&&(elChild=elParent)&&(elParent=elParent.parentNode))},_cleanContents:function(sContents){return sContents.replace(new RegExp("(<img [^>]*>)"+unescape("%uFEFF")+"","ig"),"$1")},setContents:function(sContents,bDontAddUndo){var sIR;if(this.oApp.applyConverter){sIR=this.oApp.applyConverter("DB_TO_IR",sContents,this.oApp.getDocument())}else{sIR=sContents}this.oApp.exec("SET_IR",[sIR,bDontAddUndo])},getEditingMode:function(){return this.oActivePlugin.sMode},getEditingAreaWidth:function(){return this.elEditingAreaContainer.offsetWidth},getEditingAreaHeight:function(){return this.elEditingAreaContainer.offsetHeight},getWindow:function(){return window},getDocument:function(){return document}})}}},husky_framework:{"HuskyCore.js":function(exports,module,require){if(typeof window.nhn=="undefined"){window.nhn={}}if(!nhn.husky){nhn.husky={}}(function(){var _rxMsgHandler=/^\$(LOCAL|BEFORE|ON|AFTER)_/,_rxMsgAppReady=/^\$(BEFORE|ON|AFTER)_MSG_APP_READY$/,_aHuskyCores=[],_htLoadedFile={};nhn.husky.HuskyCore=jindo.$Class({name:"HuskyCore",aCallerStack:null,bMobile:jindo.$Agent().navigator().mobile||jindo.$Agent().navigator().msafari,$init:function(htOptions){this.htOptions=htOptions||{};_aHuskyCores.push(this);this.messageQueue=[];this.oMessageMap={};this.oDisabledMessage={};this.oLazyMessage={};this.aPlugins=[];this.appStatus=nhn.husky.APP_STATUS.NOT_READY;this.aCallerStack=[];this._fnWaitForPluginReady=jindo.$Fn(this._waitForPluginReady,this).bind();this.registerPlugin(this)},exec:function(msg,args,oEvent){if(this.appStatus==nhn.husky.APP_STATUS.NOT_READY){this.messageQueue[this.messageQueue.length]={msg:msg,args:args,event:oEvent};return true}this.exec=this._doExec;this.exec(msg,args,oEvent)},absorbedExec:function(msg,args,nAbsorb,oEvent){var fExec=jindo.$Fn(this.exec,this).bind(msg,args,oEvent);if(this["timerId_"+msg]!=null){clearTimeout(this["timerId_"+msg]);this["timerId_"+msg]=setTimeout(fExec,nAbsorb)}else this["timerId_"+msg]=setTimeout(fExec,nAbsorb)},delayedExec:function(msg,args,nDelay,oEvent){var fExec=jindo.$Fn(this.exec,this).bind(msg,args,oEvent);setTimeout(fExec,nDelay)},_doExec:function(msg,args,oEvent){var bContinue=false;if(this.oLazyMessage[msg]){var htLazyInfo=this.oLazyMessage[msg];this._loadLazyFiles(msg,args,oEvent,htLazyInfo.aFilenames,0);return false}if(!this.oDisabledMessage[msg]){var allArgs=[];if(args&&args.length){var iLen=args.length;for(var i=0;i<iLen;i++){allArgs[i]=args[i]}}if(oEvent){allArgs[allArgs.length]=oEvent}bContinue=this._execMsgStep("BEFORE",msg,allArgs);if(bContinue){bContinue=this._execMsgStep("ON",msg,allArgs)}if(bContinue){bContinue=this._execMsgStep("AFTER",msg,allArgs)}}return bContinue},registerPlugin:function(oPlugin){if(!oPlugin){throw"An error occured in registerPlugin(): invalid plug-in"}oPlugin.nIdx=this.aPlugins.length;oPlugin.oApp=this;this.aPlugins[oPlugin.nIdx]=oPlugin;if(oPlugin.status!=nhn.husky.PLUGIN_STATUS.NOT_READY){oPlugin.status=nhn.husky.PLUGIN_STATUS.READY}if(this.appStatus!=nhn.husky.APP_STATUS.NOT_READY){for(var funcName in oPlugin){if(_rxMsgHandler.test(funcName)){this.addToMessageMap(funcName,oPlugin)}}}this.exec("MSG_PLUGIN_REGISTERED",[oPlugin]);return oPlugin.nIdx},disableMessage:function(sMessage,bDisable){this.oDisabledMessage[sMessage]=bDisable},registerBrowserEvent:function(obj,sEvent,sMessage,aParams,nDelay,nAbsorb){aParams=aParams||[];var func=nAbsorb?jindo.$Fn(this.delayedExec,this).bind(sMessage,aParams,nAbsorb):nDelay?jindo.$Fn(this.delayedExec,this).bind(sMessage,aParams,nDelay):jindo.$Fn(this.exec,this).bind(sMessage,aParams);if(nAbsorb)func=jindo.$Fn(this.absorbedExec,this).bind(sMessage,aParams,nAbsorb);else if(nDelay)func=jindo.$Fn(this.delayedExec,this).bind(sMessage,aParams,nDelay);else func=jindo.$Fn(this.exec,this).bind(sMessage,aParams);return jindo.$Fn(func,this).attach(obj,sEvent)},run:function(htOptions){this.htRunOptions=htOptions||{};this._changeAppStatus(nhn.husky.APP_STATUS.WAITING_FOR_PLUGINS_READY);var iQueueLength=this.messageQueue.length;for(var i=0;i<iQueueLength;i++){var curMsgAndArgs=this.messageQueue[i];this.exec(curMsgAndArgs.msg,curMsgAndArgs.args,curMsgAndArgs.event)}this._fnWaitForPluginReady()},acceptLocalBeforeFirstAgain:function(oPlugin,bAccept){oPlugin._husky_bRun=!bAccept},createMessageMap:function(sMsgHandler){this.oMessageMap[sMsgHandler]=[];var nLen=this.aPlugins.length;for(var i=0;i<nLen;i++){this._doAddToMessageMap(sMsgHandler,this.aPlugins[i])}},addToMessageMap:function(sMsgHandler,oPlugin){if(!this.oMessageMap[sMsgHandler]){return}this._doAddToMessageMap(sMsgHandler,oPlugin)},_changeAppStatus:function(appStatus){this.appStatus=appStatus;if(this.appStatus==nhn.husky.APP_STATUS.READY){this.exec("MSG_APP_READY")}},_execMsgStep:function(sMsgStep,sMsg,args){return this._execMsgHandler("$"+sMsgStep+"_"+sMsg,args)},_execMsgHandler:function(sMsgHandler,args){var i;if(!this.oMessageMap[sMsgHandler]){this.createMessageMap(sMsgHandler)}var aPlugins=this.oMessageMap[sMsgHandler];var iNumOfPlugins=aPlugins.length;if(iNumOfPlugins===0){return true}var bResult=true;if(_rxMsgAppReady.test(sMsgHandler)){for(i=0;i<iNumOfPlugins;i++){if(this._execHandler(aPlugins[i],sMsgHandler,args)===false){bResult=false;break}}}else{for(i=0;i<iNumOfPlugins;i++){if(!aPlugins[i]._husky_bRun){aPlugins[i]._husky_bRun=true;if(typeof aPlugins[i].$LOCAL_BEFORE_FIRST=="function"&&this._execHandler(aPlugins[i],"$LOCAL_BEFORE_FIRST",[sMsgHandler,args])===false){continue}}if(typeof aPlugins[i].$LOCAL_BEFORE_ALL=="function"){if(this._execHandler(aPlugins[i],"$LOCAL_BEFORE_ALL",[sMsgHandler,args])===false){continue}}if(this._execHandler(aPlugins[i],sMsgHandler,args)===false){bResult=false;break}}}return bResult},_execHandler:function(oPlugin,sHandler,args){this.aCallerStack.push(oPlugin);var bResult=oPlugin[sHandler].apply(oPlugin,args);this.aCallerStack.pop();return bResult},_doAddToMessageMap:function(sMsgHandler,oPlugin){if(typeof oPlugin[sMsgHandler]!="function"){return}var aMap=this.oMessageMap[sMsgHandler];for(var i=0,iLen=aMap.length;i<iLen;i++){if(this.oMessageMap[sMsgHandler][i]==oPlugin){return}}this.oMessageMap[sMsgHandler][i]=oPlugin},_waitForPluginReady:function(){var bAllReady=true;for(var i=0;i<this.aPlugins.length;i++){if(this.aPlugins[i].status==nhn.husky.PLUGIN_STATUS.NOT_READY){bAllReady=false;break}}if(bAllReady){this._changeAppStatus(nhn.husky.APP_STATUS.READY)}else{setTimeout(this._fnWaitForPluginReady,100)}},_loadLazyFiles:function(sMsg,aArgs,oEvent,aFilenames,nIdx){var nLen=aFilenames.length;if(nLen<=nIdx){this.oLazyMessage[sMsg]=null;this.oApp.exec(sMsg,aArgs,oEvent);return}var sFilename=aFilenames[nIdx];if(_htLoadedFile[sFilename]){this._loadLazyFiles(sMsg,aArgs,oEvent,aFilenames,nIdx+1)}else{jindo.LazyLoading.load(nhn.husky.SE2M_Configuration.LazyLoad.sJsBaseURI+"/"+sFilename,jindo.$Fn(function(sMsg,aArgs,oEvent,aFilenames,nIdx){var sFilename=aFilenames[nIdx];_htLoadedFile[sFilename]=1;this._loadLazyFiles(sMsg,aArgs,oEvent,aFilenames,nIdx+1)},this).bind(sMsg,aArgs,oEvent,aFilenames,nIdx),"utf-8")}},registerLazyMessage:function(aMsgs,aFilenames){aMsgs=aMsgs||[];aFilenames=aFilenames||[];for(var i=0,sMsg,htLazyInfo;sMsg=aMsgs[i];i++){htLazyInfo=this.oLazyMessage[sMsg];if(htLazyInfo){htLazyInfo.aFilenames=htLazyInfo.aFilenames.concat(aFilenames)}else{this.oLazyMessage[sMsg]={sMsg:sMsg,aFilenames:aFilenames}}}}});nhn.husky.HuskyCore.reset=function(){_aHuskyCores=[];_htLoadedFile={}};nhn.husky.HuskyCore.addLoadedFile=function(sFilename){_htLoadedFile[sFilename]=1};nhn.husky.HuskyCore.mixin=function(oClass,htMixin,bOverride){var aPlugins=[],i,j,k,oHuskyCore,oPlugin;for(i=0;oHuskyCore=_aHuskyCores[i];i++){for(j=0;oPlugin=oHuskyCore.aPlugins[j];j++){if(oPlugin instanceof oClass){aPlugins.push(oPlugin);if(typeof oPlugin["$LOCAL_BEFORE_FIRST"]!=="function"){oPlugin.oApp.acceptLocalBeforeFirstAgain(oPlugin,true)}}else if(oPlugin._$superClass===oClass){if(typeof oPlugin["$LOCAL_BEFORE_FIRST"]!=="function"){oPlugin.oApp.acceptLocalBeforeFirstAgain(oPlugin,true)}for(k in htMixin){if(bOverride||!Object.prototype.hasOwnProperty.call(oPlugin,k)){oPlugin[k]=htMixin[k];if(_rxMsgHandler.test(k)){oPlugin.oApp.addToMessageMap(k,oPlugin)}}}}}}for(k in htMixin){if(bOverride||!Object.prototype.hasOwnProperty.call(oClass.prototype,k)){oClass.prototype[k]=htMixin[k];if(_rxMsgHandler.test(k)){for(j=0;oPlugin=aPlugins[j];j++){oPlugin.oApp.addToMessageMap(k,oPlugin)}}}}};nhn.husky.APP_STATUS={NOT_READY:0,WAITING_FOR_PLUGINS_READY:1,READY:2};nhn.husky.PLUGIN_STATUS={NOT_READY:0,READY:1}})()},"HuskyRange.js":function(exports,module,require){if(typeof window.nhn=="undefined"){window.nhn={}}nhn.CurrentSelection_IE=function(){this.getCommonAncestorContainer=function(){try{this._oSelection=this._document.selection;if(this._oSelection.type=="Control"){return this._oSelection.createRange().item(0)}else{return this._oSelection.createRangeCollection().item(0).parentElement()}}catch(e){return this._document.body}};this.isCollapsed=function(){this._oSelection=this._document.selection;return this._oSelection.type=="None"}};nhn.CurrentSelection_FF=function(){this.getCommonAncestorContainer=function(){return this._getSelection().commonAncestorContainer};this.isCollapsed=function(){var oSelection=this._window.getSelection();if(oSelection.rangeCount<1){return true}return oSelection.getRangeAt(0).collapsed};this._getSelection=function(){try{return this._window.getSelection().getRangeAt(0)}catch(e){return this._document.createRange()}}};nhn.CurrentSelection=new(jindo.$Class({$init:function(){var oAgentInfo=jindo.$Agent().navigator();if(oAgentInfo.ie&&document.selection){nhn.CurrentSelection_IE.apply(this)}else{nhn.CurrentSelection_FF.apply(this)}},setWindow:function(oWin){this._window=oWin;this._document=oWin.document}}));nhn.W3CDOMRange=jindo.$Class({$init:function(win){this.reset(win)},reset:function(win){this._window=win;this._document=this._window.document;this.collapsed=true;this.commonAncestorContainer=this._document.body;this.endContainer=this._document.body;this.endOffset=0;this.startContainer=this._document.body;this.startOffset=0;this.oBrowserSelection=new nhn.BrowserSelection(this._window);this.selectionLoaded=this.oBrowserSelection.selectionLoaded},cloneContents:function(){var oClonedContents=this._document.createDocumentFragment();var oTmpContainer=this._document.createDocumentFragment();var aNodes=this._getNodesInRange();if(aNodes.length<1){return oClonedContents}var oClonedContainers=this._constructClonedTree(aNodes,oTmpContainer);var oTopContainer=oTmpContainer.firstChild;if(oTopContainer){var elCurNode=oTopContainer.firstChild;var elNextNode;while(elCurNode){elNextNode=elCurNode.nextSibling;oClonedContents.appendChild(elCurNode);elCurNode=elNextNode}}oClonedContainers=this._splitTextEndNodes({oStartContainer:oClonedContainers.oStartContainer,iStartOffset:this.startOffset,oEndContainer:oClonedContainers.oEndContainer,iEndOffset:this.endOffset});if(oClonedContainers.oStartContainer&&oClonedContainers.oStartContainer.previousSibling){nhn.DOMFix.parentNode(oClonedContainers.oStartContainer).removeChild(oClonedContainers.oStartContainer.previousSibling)}if(oClonedContainers.oEndContainer&&oClonedContainers.oEndContainer.nextSibling){nhn.DOMFix.parentNode(oClonedContainers.oEndContainer).removeChild(oClonedContainers.oEndContainer.nextSibling)}return oClonedContents},_constructClonedTree:function(aNodes,oClonedParentNode){var oClonedStartContainer=null;var oClonedEndContainer=null;var oStartContainer=this.startContainer;var oEndContainer=this.endContainer;var _recurConstructClonedTree=function(aAllNodes,iCurIdx,oClonedParentNode){if(iCurIdx<0){return iCurIdx}var iChildIdx=iCurIdx-1;var oCurNodeCloneWithChildren=aAllNodes[iCurIdx].cloneNode(false);if(aAllNodes[iCurIdx]==oStartContainer){oClonedStartContainer=oCurNodeCloneWithChildren}if(aAllNodes[iCurIdx]==oEndContainer){oClonedEndContainer=oCurNodeCloneWithChildren}while(iChildIdx>=0&&nhn.DOMFix.parentNode(aAllNodes[iChildIdx])==aAllNodes[iCurIdx]){iChildIdx=this._recurConstructClonedTree(aAllNodes,iChildIdx,oCurNodeCloneWithChildren)}oClonedParentNode.insertBefore(oCurNodeCloneWithChildren,oClonedParentNode.firstChild);return iChildIdx};this._recurConstructClonedTree=_recurConstructClonedTree;aNodes[aNodes.length]=nhn.DOMFix.parentNode(aNodes[aNodes.length-1]);this._recurConstructClonedTree(aNodes,aNodes.length-1,oClonedParentNode);return{oStartContainer:oClonedStartContainer,oEndContainer:oClonedEndContainer}},cloneRange:function(){return this._copyRange(new nhn.W3CDOMRange(this._window))},_copyRange:function(oClonedRange){oClonedRange.collapsed=this.collapsed;oClonedRange.commonAncestorContainer=this.commonAncestorContainer;oClonedRange.endContainer=this.endContainer;oClonedRange.endOffset=this.endOffset;oClonedRange.startContainer=this.startContainer;oClonedRange.startOffset=this.startOffset;oClonedRange._document=this._document;return oClonedRange},collapse:function(toStart){if(toStart){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this._updateRangeInfo()},compareBoundaryPoints:function(how,sourceRange){switch(how){case nhn.W3CDOMRange.START_TO_START:return this._compareEndPoint(this.startContainer,this.startOffset,sourceRange.startContainer,sourceRange.startOffset);case nhn.W3CDOMRange.START_TO_END:return this._compareEndPoint(this.endContainer,this.endOffset,sourceRange.startContainer,sourceRange.startOffset);case nhn.W3CDOMRange.END_TO_END:return this._compareEndPoint(this.endContainer,this.endOffset,sourceRange.endContainer,sourceRange.endOffset);case nhn.W3CDOMRange.END_TO_START:return this._compareEndPoint(this.startContainer,this.startOffset,sourceRange.endContainer,sourceRange.endOffset)}},_findBody:function(oNode){if(!oNode){return null}while(oNode){if(oNode.tagName=="BODY"){return oNode}oNode=nhn.DOMFix.parentNode(oNode)}return null},_compareEndPoint:function(oContainerA,iOffsetA,oContainerB,iOffsetB){return this.oBrowserSelection.compareEndPoints(oContainerA,iOffsetA,oContainerB,iOffsetB)},_getCommonAncestorContainer:function(oNode1,oNode2){oNode1=oNode1||this.startContainer;oNode2=oNode2||this.endContainer;var oComparingNode=oNode2;while(oNode1){while(oComparingNode){if(oNode1==oComparingNode){return oNode1}oComparingNode=nhn.DOMFix.parentNode(oComparingNode)}oComparingNode=oNode2;oNode1=nhn.DOMFix.parentNode(oNode1)}return this._document.body},deleteContents:function(){if(this.collapsed){return}this._splitTextEndNodesOfTheRange();var aNodes=this._getNodesInRange();if(aNodes.length<1){return}var oPrevNode=aNodes[0].previousSibling;while(oPrevNode&&this._isBlankTextNode(oPrevNode)){oPrevNode=oPrevNode.previousSibling}var oNewStartContainer,iNewOffset=-1;if(!oPrevNode){oNewStartContainer=nhn.DOMFix.parentNode(aNodes[0]);iNewOffset=0}for(var i=0;i<aNodes.length;i++){var oNode=aNodes[i];if(!oNode.firstChild||this._isAllChildBlankText(oNode)){if(oNewStartContainer==oNode){iNewOffset=this._getPosIdx(oNewStartContainer);oNewStartContainer=nhn.DOMFix.parentNode(oNode)}oNode.parentNode.removeChild(oNode)}else{if(oNewStartContainer==oNode&&iNewOffset===0){iNewOffset=this._getPosIdx(oNewStartContainer);oNewStartContainer=nhn.DOMFix.parentNode(oNode)}}}if(!oPrevNode){this.setStart(oNewStartContainer,iNewOffset,true,true)}else{if(oPrevNode.tagName=="BODY"){this.setStartBefore(oPrevNode,true)}else{this.setStartAfter(oPrevNode,true)}}this.collapse(true)},extractContents:function(){var oClonedContents=this.cloneContents();this.deleteContents();return oClonedContents},getInsertBeforeNodes:function(){var oFirstNode=null;var oParentContainer;if(this.startContainer.nodeType=="3"){oParentContainer=nhn.DOMFix.parentNode(this.startContainer);if(this.startContainer.nodeValue.length<=this.startOffset){oFirstNode=this.startContainer.nextSibling}else{oFirstNode=this.startContainer.splitText(this.startOffset)}}else{oParentContainer=this.startContainer;oFirstNode=nhn.DOMFix.childNodes(this.startContainer)[this.startOffset]}if(!oFirstNode||!nhn.DOMFix.parentNode(oFirstNode)){oFirstNode=null}return{elParent:oParentContainer,elBefore:oFirstNode}},insertNode:function(newNode){var oInsertBefore=this.getInsertBeforeNodes();oInsertBefore.elParent.insertBefore(newNode,oInsertBefore.elBefore);this.setStartBefore(newNode)},selectNode:function(refNode){this.reset(this._window);this.setStartBefore(refNode);this.setEndAfter(refNode)},selectNodeContents:function(refNode){this.reset(this._window);this.setStart(refNode,0,true);this.setEnd(refNode,nhn.DOMFix.childNodes(refNode).length)},_endsNodeValidation:function(oNode,iOffset){if(!oNode||this._findBody(oNode)!=this._document.body){throw new Error("INVALID_NODE_TYPE_ERR oNode is not part of current document")}if(oNode.nodeType==3){if(iOffset>oNode.nodeValue.length){iOffset=oNode.nodeValue.length}}else{if(iOffset>nhn.DOMFix.childNodes(oNode).length){iOffset=nhn.DOMFix.childNodes(oNode).length}}return iOffset},setEnd:function(refNode,offset,bSafe,bNoUpdate){if(!bSafe){offset=this._endsNodeValidation(refNode,offset)}this.endContainer=refNode;this.endOffset=offset;if(!bNoUpdate){if(!this.startContainer||this._compareEndPoint(this.startContainer,this.startOffset,this.endContainer,this.endOffset)!=-1){this.collapse(false)}else{this._updateRangeInfo()}}},setEndAfter:function(refNode,bNoUpdate){if(!refNode){throw new Error("INVALID_NODE_TYPE_ERR in setEndAfter")}if(refNode.tagName=="BODY"){this.setEnd(refNode,nhn.DOMFix.childNodes(refNode).length,true,bNoUpdate);return}this.setEnd(nhn.DOMFix.parentNode(refNode),this._getPosIdx(refNode)+1,true,bNoUpdate)},setEndBefore:function(refNode,bNoUpdate){if(!refNode){throw new Error("INVALID_NODE_TYPE_ERR in setEndBefore")}if(refNode.tagName=="BODY"){this.setEnd(refNode,0,true,bNoUpdate);return}this.setEnd(nhn.DOMFix.parentNode(refNode),this._getPosIdx(refNode),true,bNoUpdate)},setStart:function(refNode,offset,bSafe,bNoUpdate){if(!bSafe){offset=this._endsNodeValidation(refNode,offset)}this.startContainer=refNode;this.startOffset=offset;if(!bNoUpdate){if(!this.endContainer||this._compareEndPoint(this.startContainer,this.startOffset,this.endContainer,this.endOffset)!=-1){this.collapse(true)}else{this._updateRangeInfo()}}},setStartAfter:function(refNode,bNoUpdate){if(!refNode){throw new Error("INVALID_NODE_TYPE_ERR in setStartAfter")}if(refNode.tagName=="BODY"){this.setStart(refNode,nhn.DOMFix.childNodes(refNode).length,true,bNoUpdate);return}this.setStart(nhn.DOMFix.parentNode(refNode),this._getPosIdx(refNode)+1,true,bNoUpdate)},setStartBefore:function(refNode,bNoUpdate){if(!refNode){throw new Error("INVALID_NODE_TYPE_ERR in setStartBefore")}if(refNode.tagName=="BODY"){this.setStart(refNode,0,true,bNoUpdate);return}this.setStart(nhn.DOMFix.parentNode(refNode),this._getPosIdx(refNode),true,bNoUpdate)},surroundContents:function(newParent){newParent.appendChild(this.extractContents());this.insertNode(newParent);this.selectNode(newParent)},toString:function(){var oTmpContainer=this._document.createElement("DIV");oTmpContainer.appendChild(this.cloneContents());return oTmpContainer.textContent||oTmpContainer.innerText||""},fixCommonAncestorContainer:function(){if(!jindo.$Agent().navigator().ie){return}this.commonAncestorContainer=this._getCommonAncestorContainer()},_isBlankTextNode:function(oNode){if(oNode.nodeType==3&&oNode.nodeValue==""){return true}return false},_isAllChildBlankText:function(elNode){for(var i=0,nLen=elNode.childNodes.length;i<nLen;i++){if(!this._isBlankTextNode(elNode.childNodes[i])){return false}}return true},_getPosIdx:function(refNode){var idx=0;for(var node=refNode.previousSibling;node;node=node.previousSibling){idx++}return idx},_updateRangeInfo:function(){if(!this.startContainer){this.reset(this._window);return}this.collapsed=this.oBrowserSelection.isCollapsed(this)||this.startContainer===this.endContainer&&this.startOffset===this.endOffset;this.commonAncestorContainer=this.oBrowserSelection.getCommonAncestorContainer(this)},_isCollapsed:function(oStartContainer,iStartOffset,oEndContainer,iEndOffset){var bCollapsed=false;if(oStartContainer==oEndContainer&&iStartOffset==iEndOffset){bCollapsed=true}else{var oActualStartNode=this._getActualStartNode(oStartContainer,iStartOffset);var oActualEndNode=this._getActualEndNode(oEndContainer,iEndOffset);oActualStartNode=this._getNextNode(this._getPrevNode(oActualStartNode));oActualEndNode=this._getPrevNode(this._getNextNode(oActualEndNode));if(oActualStartNode&&oActualEndNode&&oActualEndNode.tagName!="BODY"&&(this._getNextNode(oActualEndNode)==oActualStartNode||oActualEndNode==oActualStartNode&&this._isBlankTextNode(oActualEndNode))){bCollapsed=true}}return bCollapsed},_splitTextEndNodesOfTheRange:function(){var oEndPoints=this._splitTextEndNodes({oStartContainer:this.startContainer,iStartOffset:this.startOffset,oEndContainer:this.endContainer,iEndOffset:this.endOffset});this.startContainer=oEndPoints.oStartContainer;this.startOffset=oEndPoints.iStartOffset;this.endContainer=oEndPoints.oEndContainer;this.endOffset=oEndPoints.iEndOffset},_splitTextEndNodes:function(oEndPoints){oEndPoints=this._splitStartTextNode(oEndPoints);oEndPoints=this._splitEndTextNode(oEndPoints);return oEndPoints},_splitStartTextNode:function(oEndPoints){var oStartContainer=oEndPoints.oStartContainer;var iStartOffset=oEndPoints.iStartOffset;var oEndContainer=oEndPoints.oEndContainer;var iEndOffset=oEndPoints.iEndOffset;if(!oStartContainer){return oEndPoints}if(oStartContainer.nodeType!=3){return oEndPoints}if(iStartOffset===0){return oEndPoints}if(oStartContainer.nodeValue.length<=iStartOffset){return oEndPoints}var oLastPart=oStartContainer.splitText(iStartOffset);if(oStartContainer==oEndContainer){iEndOffset-=iStartOffset;oEndContainer=oLastPart}oStartContainer=oLastPart;iStartOffset=0;return{oStartContainer:oStartContainer,iStartOffset:iStartOffset,oEndContainer:oEndContainer,iEndOffset:iEndOffset}},_splitEndTextNode:function(oEndPoints){var oStartContainer=oEndPoints.oStartContainer;var iStartOffset=oEndPoints.iStartOffset;var oEndContainer=oEndPoints.oEndContainer;var iEndOffset=oEndPoints.iEndOffset;if(!oEndContainer){return oEndPoints}if(oEndContainer.nodeType!=3){return oEndPoints}if(iEndOffset>=oEndContainer.nodeValue.length){return oEndPoints}if(iEndOffset===0){return oEndPoints}oEndContainer.splitText(iEndOffset);return{oStartContainer:oStartContainer,iStartOffset:iStartOffset,oEndContainer:oEndContainer,iEndOffset:iEndOffset}},_getNodesInRange:function(){if(this.collapsed){return[]}var oStartNode=this._getActualStartNode(this.startContainer,this.startOffset);var oEndNode=this._getActualEndNode(this.endContainer,this.endOffset);return this._getNodesBetween(oStartNode,oEndNode)},_getActualStartNode:function(oStartContainer,iStartOffset){var oStartNode=oStartContainer;if(oStartContainer.nodeType==3){if(iStartOffset>=oStartContainer.nodeValue.length){oStartNode=this._getNextNode(oStartContainer);if(oStartNode.tagName=="BODY"){oStartNode=null}}else{oStartNode=oStartContainer}}else{if(iStartOffset<nhn.DOMFix.childNodes(oStartContainer).length){oStartNode=nhn.DOMFix.childNodes(oStartContainer)[iStartOffset]}else{oStartNode=this._getNextNode(oStartContainer);if(oStartNode.tagName=="BODY"){oStartNode=null}}}return oStartNode},_getActualEndNode:function(oEndContainer,iEndOffset){var oEndNode=oEndContainer;if(iEndOffset===0){oEndNode=this._getPrevNode(oEndContainer);if(oEndNode.tagName=="BODY"){oEndNode=null}}else if(oEndContainer.nodeType==3){oEndNode=oEndContainer}else{oEndNode=nhn.DOMFix.childNodes(oEndContainer)[iEndOffset-1]}return oEndNode},_getNextNode:function(oNode){if(!oNode||oNode.tagName=="BODY"){return this._document.body}if(oNode.nextSibling){return oNode.nextSibling}return this._getNextNode(nhn.DOMFix.parentNode(oNode))},_getPrevNode:function(oNode){if(!oNode||oNode.tagName=="BODY"){return this._document.body}if(oNode.previousSibling){return oNode.previousSibling}return this._getPrevNode(nhn.DOMFix.parentNode(oNode))},_getNodesBetween:function(oStartNode,oEndNode){var aNodesBetween=[];this._nNodesBetweenLen=0;if(!oStartNode||!oEndNode){return aNodesBetween}try{this._recurGetNextNodesUntil(oStartNode,oEndNode,aNodesBetween)}catch(e){return[]}return aNodesBetween},_recurGetNextNodesUntil:function(oNode,oEndNode,aNodesBetween){if(!oNode){return false}if(!this._recurGetChildNodesUntil(oNode,oEndNode,aNodesBetween)){return false}var oNextToChk=oNode.nextSibling;while(!oNextToChk){if(!(oNode=nhn.DOMFix.parentNode(oNode))){return false}aNodesBetween[this._nNodesBetweenLen++]=oNode;if(oNode==oEndNode){return false}oNextToChk=oNode.nextSibling}return this._recurGetNextNodesUntil(oNextToChk,oEndNode,aNodesBetween)},_recurGetChildNodesUntil:function(oNode,oEndNode,aNodesBetween){if(!oNode){return false}var bEndFound=false;var oCurNode=oNode;if(oCurNode.firstChild){oCurNode=oCurNode.firstChild;while(oCurNode){if(!this._recurGetChildNodesUntil(oCurNode,oEndNode,aNodesBetween)){bEndFound=true;break}oCurNode=oCurNode.nextSibling}}aNodesBetween[this._nNodesBetweenLen++]=oNode;if(bEndFound){return false}if(oNode==oEndNode){return false}return true}});nhn.W3CDOMRange.START_TO_START=0;nhn.W3CDOMRange.START_TO_END=1;nhn.W3CDOMRange.END_TO_END=2;nhn.W3CDOMRange.END_TO_START=3;nhn.HuskyRange=jindo.$Class({_rxCursorHolder:/^(?:\uFEFF|\u00A0|\u200B|<br>)$/i,_rxTextAlign:/text-align:[^"';]*;?/i,setWindow:function(win){this.reset(win||window)},$init:function(win){this.HUSKY_BOOMARK_START_ID_PREFIX="husky_bookmark_start_";this.HUSKY_BOOMARK_END_ID_PREFIX="husky_bookmark_end_";this.sBlockElement="P|DIV|LI|H[1-6]|PRE";this.sBlockContainer="BODY|TABLE|TH|TR|TD|UL|OL|BLOCKQUOTE|FORM";this.rxBlockElement=new RegExp("^("+this.sBlockElement+")$");this.rxBlockContainer=new RegExp("^("+this.sBlockContainer+")$");this.rxLineBreaker=new RegExp("^("+this.sBlockElement+"|"+this.sBlockContainer+")$");this.rxHasBlock=new RegExp("(?:<(?:"+this.sBlockElement+"|"+this.sBlockContainer+").*?>|style=[\"']?[^>]*?(?:display\\s?:\\s?block)[^>]*?[\"']?)","i");this.setWindow(win)},select:function(){try{this.oBrowserSelection.selectRange(this)}catch(e){}},setFromSelection:function(iNum){this.setRange(this.oBrowserSelection.getRangeAt(iNum),true)},setRange:function(oW3CRange,bSafe){this.reset(this._window);this.setStart(oW3CRange.startContainer,oW3CRange.startOffset,bSafe,true);this.setEnd(oW3CRange.endContainer,oW3CRange.endOffset,bSafe)},setEndNodes:function(oSNode,oENode){this.reset(this._window);this.setEndAfter(oENode,true);this.setStartBefore(oSNode)},splitTextAtBothEnds:function(){this._splitTextEndNodesOfTheRange()},getStartNode:function(){if(this.collapsed){if(this.startContainer.nodeType==3){if(this.startOffset===0){return null}if(this.startContainer.nodeValue.length<=this.startOffset){return null}return this.startContainer}return null}if(this.startContainer.nodeType==3){if(this.startOffset>=this.startContainer.nodeValue.length){return this._getNextNode(this.startContainer)}return this.startContainer}else{if(this.startOffset>=nhn.DOMFix.childNodes(this.startContainer).length){return this._getNextNode(this.startContainer)}return nhn.DOMFix.childNodes(this.startContainer)[this.startOffset]}},getEndNode:function(){if(this.collapsed){return this.getStartNode()}if(this.endContainer.nodeType==3){if(this.endOffset===0){return this._getPrevNode(this.endContainer)}return this.endContainer}else{if(this.endOffset===0){return this._getPrevNode(this.endContainer)}return nhn.DOMFix.childNodes(this.endContainer)[this.endOffset-1]}},getNodeAroundRange:function(bBefore,bStrict){if(!this.collapsed){return this.getStartNode()}if(this.startContainer&&this.startContainer.nodeType==3){return this.startContainer}var oBeforeRange,oAfterRange,oResult;if(this.startOffset>=nhn.DOMFix.childNodes(this.startContainer).length){oAfterRange=this._getNextNode(this.startContainer)}else{oAfterRange=nhn.DOMFix.childNodes(this.startContainer)[this.startOffset]}if(this.endOffset===0){oBeforeRange=this._getPrevNode(this.endContainer)}else{oBeforeRange=nhn.DOMFix.childNodes(this.endContainer)[this.endOffset-1]}if(bBefore){oResult=oBeforeRange;if(!oResult&&!bStrict){oResult=oAfterRange}}else{oResult=oAfterRange;if(!oResult&&!bStrict){oResult=oBeforeRange}}return oResult},_getXPath:function(elNode){var sXPath="";while(elNode&&elNode.nodeType==1){sXPath="/"+elNode.tagName+"["+this._getPosIdx4XPath(elNode)+"]"+sXPath;elNode=nhn.DOMFix.parentNode(elNode)}return sXPath},_getPosIdx4XPath:function(refNode){var idx=0;for(var node=refNode.previousSibling;node;node=node.previousSibling){if(node.tagName==refNode.tagName){idx++}}return idx},_evaluateXPath:function(sXPath,oDoc){sXPath=sXPath.substring(1,sXPath.length-1);var aXPath=sXPath.split(/\//);var elNode=oDoc.body;for(var i=2;i<aXPath.length&&elNode;i++){aXPath[i].match(/([^[]+)\[(\d+)/i);var sTagName=RegExp.$1;var nIdx=RegExp.$2;var aAllNodes=nhn.DOMFix.childNodes(elNode);var aNodes=[];var nLength=aAllNodes.length;var nCount=0;for(var ii=0;ii<nLength;ii++){if(aAllNodes[ii].tagName==sTagName){aNodes[nCount++]=aAllNodes[ii]}}if(aNodes.length<nIdx){elNode=null}else{elNode=aNodes[nIdx]}}return elNode},_evaluateXPathBookmark:function(oBookmark){var sXPath=oBookmark["sXPath"];var nTextNodeIdx=oBookmark["nTextNodeIdx"];var nOffset=oBookmark["nOffset"];var elContainer=this._evaluateXPath(sXPath,this._document);if(nTextNodeIdx>-1&&elContainer){var aChildNodes=nhn.DOMFix.childNodes(elContainer);var elNode=null;var nIdx=nTextNodeIdx;var nOffsetLeft=nOffset;while((elNode=aChildNodes[nIdx])&&elNode.nodeType==3&&elNode.nodeValue.length<nOffsetLeft){nOffsetLeft-=elNode.nodeValue.length;nIdx++}elContainer=nhn.DOMFix.childNodes(elContainer)[nIdx];nOffset=nOffsetLeft}if(!elContainer){elContainer=this._document.body;nOffset=0}return{elContainer:elContainer,nOffset:nOffset}},getXPathBookmark:function(){var nTextNodeIdx1=-1;var htEndPt1={elContainer:this.startContainer,nOffset:this.startOffset};var elNode1=this.startContainer;if(elNode1.nodeType==3){htEndPt1=this._getFixedStartTextNode();nTextNodeIdx1=this._getPosIdx(htEndPt1.elContainer);elNode1=nhn.DOMFix.parentNode(elNode1)}var sXPathNode1=this._getXPath(elNode1);var oBookmark1={sXPath:sXPathNode1,nTextNodeIdx:nTextNodeIdx1,nOffset:htEndPt1.nOffset};var oBookmark2;if(this.collapsed){oBookmark2={sXPath:sXPathNode1,nTextNodeIdx:nTextNodeIdx1,nOffset:htEndPt1.nOffset}}else{var nTextNodeIdx2=-1;var htEndPt2={elContainer:this.endContainer,nOffset:this.endOffset};var elNode2=this.endContainer;if(elNode2.nodeType==3){htEndPt2=this._getFixedEndTextNode();nTextNodeIdx2=this._getPosIdx(htEndPt2.elContainer);elNode2=nhn.DOMFix.parentNode(elNode2)}var sXPathNode2=this._getXPath(elNode2);oBookmark2={sXPath:sXPathNode2,nTextNodeIdx:nTextNodeIdx2,nOffset:htEndPt2.nOffset}}return[oBookmark1,oBookmark2]},moveToXPathBookmark:function(aBookmark){if(!aBookmark){return false}var oBookmarkInfo1=this._evaluateXPathBookmark(aBookmark[0]);var oBookmarkInfo2=this._evaluateXPathBookmark(aBookmark[1]);if(!oBookmarkInfo1["elContainer"]||!oBookmarkInfo2["elContainer"]){return}this.startContainer=oBookmarkInfo1["elContainer"];this.startOffset=oBookmarkInfo1["nOffset"];this.endContainer=oBookmarkInfo2["elContainer"];this.endOffset=oBookmarkInfo2["nOffset"];return true},_getFixedTextContainer:function(elNode,nOffset){while(elNode&&elNode.nodeType==3&&elNode.previousSibling&&elNode.previousSibling.nodeType==3){nOffset+=elNode.previousSibling.nodeValue.length;elNode=elNode.previousSibling}return{elContainer:elNode,nOffset:nOffset}},_getFixedStartTextNode:function(){return this._getFixedTextContainer(this.startContainer,this.startOffset)},_getFixedEndTextNode:function(){return this._getFixedTextContainer(this.endContainer,this.endOffset)},placeStringBookmark:function(){if(this.collapsed||jindo.$Agent().navigator().ie||jindo.$Agent().navigator().firefox){return this.placeStringBookmark_NonWebkit()}else{return this.placeStringBookmark_Webkit()}},placeStringBookmark_NonWebkit:function(){var sTmpId=(new Date).getTime();var oInsertionPoint=this.cloneRange();oInsertionPoint.collapseToEnd();var oEndMarker=this._document.createElement("SPAN");oEndMarker.id=this.HUSKY_BOOMARK_END_ID_PREFIX+sTmpId;oInsertionPoint.insertNode(oEndMarker);oInsertionPoint=this.cloneRange();oInsertionPoint.collapseToStart();var oStartMarker=this._document.createElement("SPAN");oStartMarker.id=this.HUSKY_BOOMARK_START_ID_PREFIX+sTmpId;oInsertionPoint.insertNode(oStartMarker);if(jindo.$Agent().navigator().ie){try{oStartMarker.innerHTML=unescape("%uFEFF")}catch(e){}try{oEndMarker.innerHTML=unescape("%uFEFF")}catch(e){}}this.moveToBookmark(sTmpId);return sTmpId},placeStringBookmark_Webkit:function(){var sTmpId=(new Date).getTime();var elInsertBefore,elInsertParent;var oInsertionPoint=this.cloneRange();oInsertionPoint.collapseToEnd();elInsertBefore=this._document.createTextNode("");oInsertionPoint.insertNode(elInsertBefore);elInsertParent=elInsertBefore.parentNode;if(elInsertBefore.previousSibling&&elInsertBefore.previousSibling.tagName=="TD"){elInsertParent=elInsertBefore.previousSibling;elInsertBefore=null}var oEndMarker=this._document.createElement("SPAN");oEndMarker.id=this.HUSKY_BOOMARK_END_ID_PREFIX+sTmpId;elInsertParent.insertBefore(oEndMarker,elInsertBefore);oInsertionPoint=this.cloneRange();oInsertionPoint.collapseToStart();elInsertBefore=this._document.createTextNode("");oInsertionPoint.insertNode(elInsertBefore);elInsertParent=elInsertBefore.parentNode;if(elInsertBefore.nextSibling&&elInsertBefore.nextSibling.tagName=="TD"){elInsertParent=elInsertBefore.nextSibling;elInsertBefore=elInsertParent.firstChild}var oStartMarker=this._document.createElement("SPAN");oStartMarker.id=this.HUSKY_BOOMARK_START_ID_PREFIX+sTmpId;elInsertParent.insertBefore(oStartMarker,elInsertBefore);this.moveToBookmark(sTmpId);return sTmpId},cloneRange:function(){return this._copyRange(new nhn.HuskyRange(this._window))},moveToBookmark:function(vBookmark){if(typeof vBookmark!="object"){return this.moveToStringBookmark(vBookmark)}else{return this.moveToXPathBookmark(vBookmark)}},getStringBookmark:function(sBookmarkID,bEndBookmark){if(bEndBookmark){return this._document.getElementById(this.HUSKY_BOOMARK_END_ID_PREFIX+sBookmarkID)}else{return this._document.getElementById(this.HUSKY_BOOMARK_START_ID_PREFIX+sBookmarkID)}},moveToStringBookmark:function(sBookmarkID,bIncludeBookmark){var oStartMarker=this.getStringBookmark(sBookmarkID);var oEndMarker=this.getStringBookmark(sBookmarkID,true);if(!oStartMarker||!oEndMarker){return false}this.reset(this._window);if(bIncludeBookmark){this.setEndAfter(oEndMarker);this.setStartBefore(oStartMarker)}else{this.setEndBefore(oEndMarker);this.setStartAfter(oStartMarker)}return true},removeStringBookmark:function(sBookmarkID){this._removeAll(this.HUSKY_BOOMARK_START_ID_PREFIX+sBookmarkID);this._removeAll(this.HUSKY_BOOMARK_END_ID_PREFIX+sBookmarkID)},_removeAll:function(sID){var elNode;while(elNode=this._document.getElementById(sID)){elNode.parentNode.removeChild(elNode)}},collapseToStart:function(){this.collapse(true)},collapseToEnd:function(){this.collapse(false)},createAndInsertNode:function(sTagName){var tmpNode=this._document.createElement(sTagName);this.insertNode(tmpNode);return tmpNode},getNodes:function(bSplitTextEndNodes,fnFilter){if(bSplitTextEndNodes){this._splitTextEndNodesOfTheRange()}var aAllNodes=this._getNodesInRange();var aFilteredNodes=[];if(!fnFilter){return aAllNodes}for(var i=0;i<aAllNodes.length;i++){if(fnFilter(aAllNodes[i])){aFilteredNodes[aFilteredNodes.length]=aAllNodes[i]}}return aFilteredNodes},getTextNodes:function(bSplitTextEndNodes){var txtFilter=function(oNode){if(oNode.nodeType==3&&oNode.nodeValue!="\n"&&oNode.nodeValue!=""){return true}else{return false}};return this.getNodes(bSplitTextEndNodes,txtFilter)},surroundContentsWithNewNode:function(sTagName){var oNewParent=this._document.createElement(sTagName);this.surroundContents(oNewParent);return oNewParent},isRangeinRange:function(oAnoterRange,bIncludePartlySelected){var startToStart=this.compareBoundaryPoints(this.W3CDOMRange.START_TO_START,oAnoterRange);var startToEnd=this.compareBoundaryPoints(this.W3CDOMRange.START_TO_END,oAnoterRange);var endToStart=this.compareBoundaryPoints(this.W3CDOMRange.ND_TO_START,oAnoterRange);var endToEnd=this.compareBoundaryPoints(this.W3CDOMRange.END_TO_END,oAnoterRange);if(startToStart<=0&&endToEnd>=0){return true}if(bIncludePartlySelected){if(startToEnd==1){return false}if(endToStart==-1){return false}return true}return false},isNodeInRange:function(oNode,bIncludePartlySelected,bContentOnly){var oTmpRange=new nhn.HuskyRange(this._window);if(bContentOnly&&oNode.firstChild){oTmpRange.setStartBefore(oNode.firstChild);oTmpRange.setEndAfter(oNode.lastChild)}else{oTmpRange.selectNode(oNode)}return this.isRangeInRange(oTmpRange,bIncludePartlySelected)},pasteText:function(sText){this.pasteHTML(sText.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/"/g,"&quot;"))},pasteHTML:function(sHTML,bBlock){var oTmpDiv=this._document.createElement("DIV");oTmpDiv.innerHTML=sHTML;if(!oTmpDiv.firstChild){this.deleteContents();return}var clone=this.cloneRange();var sBM=clone.placeStringBookmark();var oLineInfo=clone.getLineInfo(),oStart=oLineInfo.oStart,oEnd=oLineInfo.oEnd;if(oStart.oLineBreaker&&oStart.oLineBreaker.nodeName==="P"&&(bBlock||clone.rxHasBlock.test(sHTML))){var oParentNode=oStart.oLineBreaker.parentNode,oNextSibling=oStart.oLineBreaker.nextSibling;clone.deleteContents();if(oStart.oLineBreaker===oEnd.oLineBreaker){var elBM=clone.getStringBookmark(sBM);clone.setEndNodes(elBM,oEnd.oLineBreaker);var oNextContents=clone.extractContents(),oNextFirst=oNextContents.firstChild;if(oNextSibling){oParentNode.insertBefore(oNextContents,oNextSibling)}else{oParentNode.appendChild(oNextContents)}oNextSibling=oNextFirst}oTmpDiv.style.cssText=oStart.oLineBreaker.style.cssText.replace(this._rxTextAlign,"");oTmpDiv.align=oStart.oLineBreaker.align;if(oNextSibling){oParentNode.insertBefore(oTmpDiv,oNextSibling)}else{oParentNode.appendChild(oTmpDiv)}clone.removeStringBookmark(sBM);this._removeEmptyP(this._getPrevElement(oTmpDiv));var elNextLine=this._getNextElement(oTmpDiv);if(elNextLine){var elAfterNext=this._getNextElement(elNextLine);if(elAfterNext&&this._removeEmptyP(elNextLine)){elNextLine=elAfterNext}}else{elNextLine=this._document.createElement("P");elNextLine.style.cssText=oStart.oLineBreaker.style.cssText;elNextLine.align=oStart.oLineBreaker.align;oParentNode.appendChild(elNextLine)}if(elNextLine.innerHTML===""){elNextLine.innerHTML=jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version>8?"​":"\ufeff"}this.selectNodeContents(elNextLine);this.collapseToStart();if(jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version<9){sBM=this.placeStringBookmark();this.removeStringBookmark(sBM)}}else{var oFirstNode=oTmpDiv.firstChild;var oLastNode=oTmpDiv.lastChild;this.collapseToStart();while(oTmpDiv.lastChild){this.insertNode(oTmpDiv.lastChild)}this.setEndNodes(oFirstNode,oLastNode);clone.moveToBookmark(sBM);clone.deleteContents();clone.removeStringBookmark(sBM)}},_removeEmptyP:function(el){if(el&&el.nodeName==="P"){var sInner=el.innerHTML;if(sInner===""||this._rxCursorHolder.test(sInner)){el.parentNode.removeChild(el);return true}}},_getSiblingElement:function(oNode,bPrev){if(!oNode){return null}var oSibling=oNode[bPrev?"previousSibling":"nextSibling"];if(oSibling&&oSibling.nodeType===1){return oSibling}else{return arguments.callee(oSibling,bPrev)}},_getPrevElement:function(oNode){return this._getSiblingElement(oNode,true)},_getNextElement:function(oNode){return this._getSiblingElement(oNode,false)},toString:function(){this.toString=nhn.W3CDOMRange.prototype.toString;return this.toString()},toHTMLString:function(){var oTmpContainer=this._document.createElement("DIV");oTmpContainer.appendChild(this.cloneContents());return oTmpContainer.innerHTML},findAncestorByTagName:function(sTagName){var oNode=this.commonAncestorContainer;while(oNode&&oNode.tagName!=sTagName){oNode=nhn.DOMFix.parentNode(oNode)}return oNode},selectNodeContents:function(oNode){if(!oNode){return}var oFirstNode=oNode.firstChild?oNode.firstChild:oNode;var oLastNode=oNode.lastChild?oNode.lastChild:oNode;this.reset(this._window);if(oFirstNode.nodeType==3){this.setStart(oFirstNode,0,true)}else{this.setStartBefore(oFirstNode)}if(oLastNode.nodeType==3){this.setEnd(oLastNode,oLastNode.nodeValue.length,true)}else{this.setEndAfter(oLastNode)}},_hasTextDecoration:function(oNode,sValue){if(!oNode||!oNode.style){return false}if(oNode.style.textDecoration.indexOf(sValue)>-1){return true}if(sValue==="underline"&&oNode.tagName==="U"){return true}if(sValue==="line-through"&&(oNode.tagName==="S"||oNode.tagName==="STRIKE")){return true}return false},_setTextDecoration:function(oNode,sValue){if(jindo.$Agent().navigator().firefox){oNode.style.textDecoration=oNode.style.textDecoration?oNode.style.textDecoration+" "+sValue:sValue}else{if(sValue==="underline"){oNode.innerHTML="<U>"+oNode.innerHTML+"</U>"}else if(sValue==="line-through"){oNode.innerHTML="<STRIKE>"+oNode.innerHTML+"</STRIKE>"}}},_checkTextDecoration:function(oNode){if(oNode.tagName!=="SPAN"){return}var bUnderline=false,bLineThrough=false,oParentNode=null,oChildNode=oNode.firstChild;while(oChildNode){if(oChildNode.nodeType===1){bUnderline=bUnderline||oChildNode.tagName==="U";bLineThrough=bLineThrough||oChildNode.tagName==="S"||oChildNode.tagName==="STRIKE"}if(bUnderline&&bLineThrough){return}oChildNode=oChildNode.nextSibling}oParentNode=nhn.DOMFix.parentNode(oNode);while(oParentNode&&oParentNode.tagName!=="BODY"){if(oParentNode.nodeType!==1){oParentNode=nhn.DOMFix.parentNode(oParentNode);continue}if(!bUnderline&&this._hasTextDecoration(oParentNode,"underline")){bUnderline=true;this._setTextDecoration(oNode,"underline")}if(!bLineThrough&&this._hasTextDecoration(oParentNode,"line-through")){bLineThrough=true;this._setTextDecoration(oNode,"line-through")}if(bUnderline&&bLineThrough){return}oParentNode=nhn.DOMFix.parentNode(oParentNode)}},styleRange:function(oStyle,oAttribute,sNewSpanMarker,bIncludeLI,bCheckTextDecoration){var aStyleParents=this.aStyleParents=this._getStyleParentNodes(sNewSpanMarker,bIncludeLI);if(aStyleParents.length<1){return}var sName,sValue,x;for(var i=0;i<aStyleParents.length;i++){for(x in oStyle){sName=x;sValue=oStyle[sName];if(typeof sValue!="string"){continue}if(bCheckTextDecoration&&oStyle.color){this._checkTextDecoration(aStyleParents[i])}aStyleParents[i].style[sName]=sValue}if(!oAttribute){continue}for(x in oAttribute){sName=x;sValue=oAttribute[sName];if(typeof sValue!="string"){continue}if(sName=="class"){jindo.$Element(aStyleParents[i]).addClass(sValue)}else{aStyleParents[i].setAttribute(sName,sValue)}}}this.reset(this._window);this.setStartBefore(aStyleParents[0]);this.setEndAfter(aStyleParents[aStyleParents.length-1])},expandBothEnds:function(){this.expandStart();this.expandEnd()},expandStart:function(){if(this.startContainer.nodeType==3&&this.startOffset!==0){return}var elActualStartNode=this._getActualStartNode(this.startContainer,this.startOffset);elActualStartNode=this._getPrevNode(elActualStartNode);if(elActualStartNode.tagName=="BODY"){this.setStartBefore(elActualStartNode)}else{this.setStartAfter(elActualStartNode)}},expandEnd:function(){if(this.endContainer.nodeType==3&&this.endOffset<this.endContainer.nodeValue.length){return}var elActualEndNode=this._getActualEndNode(this.endContainer,this.endOffset);elActualEndNode=this._getNextNode(elActualEndNode);if(elActualEndNode.tagName=="BODY"){this.setEndAfter(elActualEndNode)}else{this.setEndBefore(elActualEndNode)}},_getStyleParentNodes:function(sNewSpanMarker,bIncludeLI){this._splitTextEndNodesOfTheRange();var oSNode=this.getStartNode();var oENode=this.getEndNode();var aAllNodes=this._getNodesInRange();var aResult=[];var nResult=0;var oNode,oSpan;var nInitialLength=aAllNodes.length;var arAllBottomNodes=jindo.$A(aAllNodes).filter(function(v){return!v.firstChild||bIncludeLI&&v.tagName=="LI"});var elTmpNode=this.commonAncestorContainer;if(bIncludeLI){while(elTmpNode){if(elTmpNode.tagName=="LI"){if(this._isFullyContained(elTmpNode,arAllBottomNodes)){aResult[nResult++]=elTmpNode}break}elTmpNode=elTmpNode.parentNode}}for(var i=0;i<nInitialLength;i++){oNode=aAllNodes[i];if(!oNode){continue}if(bIncludeLI&&oNode.tagName=="LI"&&this._isFullyContained(oNode,arAllBottomNodes)){aResult[nResult++]=oNode;continue}if(oNode.nodeType!=3){continue}if(oNode.nodeValue==""||oNode.nodeValue.match(/^(\r|\n)+$/)){continue}var oParentNode=nhn.DOMFix.parentNode(oNode);if(oParentNode.tagName=="SPAN"){if(this._isFullyContained(oParentNode,arAllBottomNodes,oNode)){aResult[nResult++]=oParentNode;continue}}else{var oParentSingleSpan=this._findParentSingleSpan(oParentNode);if(oParentSingleSpan){aResult[nResult++]=oParentSingleSpan;continue}}oSpan=this._document.createElement("SPAN");oParentNode.insertBefore(oSpan,oNode);oSpan.appendChild(oNode);aResult[nResult++]=oSpan;if(sNewSpanMarker){oSpan.setAttribute(sNewSpanMarker,"true")}}this.setStartBefore(oSNode);this.setEndAfter(oENode);return aResult},_findParentSingleSpan:function(oNode){if(!oNode){return null}for(var i=0,nCnt=0,sValue,oChild,aChildNodes=oNode.childNodes;oChild=aChildNodes[i];i++){sValue=oChild.nodeValue;if(this._rxCursorHolder.test(sValue)){continue}else{nCnt++}if(nCnt>1){return null}}if(oNode.nodeName==="SPAN"){return oNode}else{return this._findParentSingleSpan(oNode.parentNode)}},_isFullyContained:function(elContainer,waAllNodes,oNode){var nSIdx,nEIdx;var oTmpNode=this._getVeryFirstRealChild(elContainer);if(oNode&&oTmpNode==oNode){nSIdx=1}else{nSIdx=waAllNodes.indexOf(oTmpNode)}if(nSIdx!=-1){oTmpNode=this._getVeryLastRealChild(elContainer);if(oNode&&oTmpNode==oNode){nEIdx=1}else{nEIdx=waAllNodes.indexOf(oTmpNode)}}return nSIdx!=-1&&nEIdx!=-1},_getVeryFirstChild:function(oNode){if(oNode.firstChild){return this._getVeryFirstChild(oNode.firstChild)}return oNode},_getVeryLastChild:function(oNode){if(oNode.lastChild){return this._getVeryLastChild(oNode.lastChild)}return oNode},_getFirstRealChild:function(oNode){var oFirstNode=oNode.firstChild;while(oFirstNode&&oFirstNode.nodeType==3&&oFirstNode.nodeValue==""){oFirstNode=oFirstNode.nextSibling}return oFirstNode},_getLastRealChild:function(oNode){var oLastNode=oNode.lastChild;while(oLastNode&&oLastNode.nodeType==3&&oLastNode.nodeValue==""){oLastNode=oLastNode.previousSibling}return oLastNode},_getVeryFirstRealChild:function(oNode){var oFirstNode=this._getFirstRealChild(oNode);if(oFirstNode){return this._getVeryFirstRealChild(oFirstNode)}return oNode},_getVeryLastRealChild:function(oNode){var oLastNode=this._getLastRealChild(oNode);if(oLastNode){return this._getVeryLastChild(oLastNode)}return oNode},_getLineStartInfo:function(node){var frontEndFinal=null;var frontEnd=node;var lineBreaker=node;var bParentBreak=false;var rxLineBreaker=this.rxLineBreaker;function getLineStart(node){if(!node){return}if(frontEndFinal){return}if(rxLineBreaker.test(node.tagName)){lineBreaker=node;frontEndFinal=frontEnd;bParentBreak=true;return}else{frontEnd=node}getFrontEnd(node.previousSibling);if(frontEndFinal){return}getLineStart(nhn.DOMFix.parentNode(node))}function getFrontEnd(node){if(!node){return}if(frontEndFinal){return}if(rxLineBreaker.test(node.tagName)){lineBreaker=node;frontEndFinal=frontEnd;bParentBreak=false;return}frontEnd=node;if(!frontEndFinal){getFrontEnd(node.previousSibling)}}if(rxLineBreaker.test(node.tagName)){frontEndFinal=node}else{getLineStart(node)}return{oNode:frontEndFinal,oLineBreaker:lineBreaker,bParentBreak:bParentBreak}},_getLineEndInfo:function(node){var backEndFinal=null;var backEnd=node;var lineBreaker=node;var bParentBreak=false;var rxLineBreaker=this.rxLineBreaker;function getLineEnd(node){if(!node){return}if(backEndFinal){return}if(rxLineBreaker.test(node.tagName)){lineBreaker=node;backEndFinal=backEnd;bParentBreak=true;return}else{backEnd=node}getBackEnd(node.nextSibling);if(backEndFinal){return}getLineEnd(nhn.DOMFix.parentNode(node))}function getBackEnd(node){if(!node){return}if(backEndFinal){return}if(rxLineBreaker.test(node.tagName)){lineBreaker=node;backEndFinal=backEnd;bParentBreak=false;return}backEnd=node;if(!backEndFinal){getBackEnd(node.nextSibling)}}if(rxLineBreaker.test(node.tagName)){backEndFinal=node}else{getLineEnd(node)}return{oNode:backEndFinal,oLineBreaker:lineBreaker,bParentBreak:bParentBreak}},getLineInfo:function(bAfter){bAfter=bAfter||false;var oSNode=this.getStartNode();var oENode=this.getEndNode();if(!oSNode){oSNode=this.getNodeAroundRange(!bAfter,true)}if(!oENode){oENode=this.getNodeAroundRange(!bAfter,true)}var oStart=this._getLineStartInfo(oSNode);var oStartNode=oStart.oNode;var oEnd=this._getLineEndInfo(oENode);var oEndNode=oEnd.oNode;if(oSNode!=oStartNode||oENode!=oEndNode){var iRelativeStartPos=this._compareEndPoint(nhn.DOMFix.parentNode(oStartNode),this._getPosIdx(oStartNode),this.endContainer,this.endOffset);var iRelativeEndPos=this._compareEndPoint(nhn.DOMFix.parentNode(oEndNode),this._getPosIdx(oEndNode)+1,this.startContainer,this.startOffset);if(!(iRelativeStartPos<=0&&iRelativeEndPos>=0)){oSNode=this.getNodeAroundRange(false,true);oENode=this.getNodeAroundRange(false,true);oStart=this._getLineStartInfo(oSNode);oEnd=this._getLineEndInfo(oENode)}}return{oStart:oStart,oEnd:oEnd}},_findSingleChild:function(oNode){if(!oNode){return null}var oSingleChild=null;for(var i=0,nCnt=0,sValue,oChild,aChildNodes=oNode.childNodes;oChild=aChildNodes[i];i++){sValue=oChild.nodeValue;if(this._rxCursorHolder.test(sValue)){continue}else{oSingleChild=oChild;nCnt++}if(nCnt>1){return null}}return oSingleChild},_hasCursorHolderOnly:function(oNode){if(!oNode||oNode.nodeType!==1){return false}if(this._rxCursorHolder.test(oNode.innerHTML)){return true}else{return this._hasCursorHolderOnly(this._findSingleChild(oNode))}}}).extend(nhn.W3CDOMRange);nhn.BrowserSelection=function(win){this.init=function(win){this._window=win||window;this._document=this._window.document};this.init(win);if(this._document.createRange){nhn.BrowserSelectionImpl_FF.apply(this)}else{nhn.BrowserSelectionImpl_IE.apply(this)}this.selectRange=function(oRng){this.selectNone();this.addRange(oRng)};this.selectionLoaded=true;if(!this._oSelection){this.selectionLoaded=false}};nhn.BrowserSelectionImpl_FF=function(){this._oSelection=this._window.getSelection();this.getRangeAt=function(iNum){iNum=iNum||0;try{var oFFRange=this._oSelection.getRangeAt(iNum)}catch(e){return new nhn.W3CDOMRange(this._window)}return this._FFRange2W3CRange(oFFRange)};this.addRange=function(oW3CRange){var oFFRange=this._W3CRange2FFRange(oW3CRange);this._oSelection.addRange(oFFRange)};this.selectNone=function(){this._oSelection.removeAllRanges()};this.getCommonAncestorContainer=function(oW3CRange){var oFFRange=this._W3CRange2FFRange(oW3CRange);return oFFRange.commonAncestorContainer};this.isCollapsed=function(oW3CRange){var oFFRange=this._W3CRange2FFRange(oW3CRange);return oFFRange.collapsed};this.compareEndPoints=function(elContainerA,nOffsetA,elContainerB,nOffsetB){var oFFRangeA=this._document.createRange();var oFFRangeB=this._document.createRange();oFFRangeA.setStart(elContainerA,nOffsetA);oFFRangeB.setStart(elContainerB,nOffsetB);oFFRangeA.collapse(true);oFFRangeB.collapse(true);try{return oFFRangeA.compareBoundaryPoints(1,oFFRangeB)}catch(e){return 1}};this._FFRange2W3CRange=function(oFFRange){var oW3CRange=new nhn.W3CDOMRange(this._window);oW3CRange.setStart(oFFRange.startContainer,oFFRange.startOffset,true);oW3CRange.setEnd(oFFRange.endContainer,oFFRange.endOffset,true);return oW3CRange};this._W3CRange2FFRange=function(oW3CRange){var oFFRange=this._document.createRange();oFFRange.setStart(oW3CRange.startContainer,oW3CRange.startOffset);oFFRange.setEnd(oW3CRange.endContainer,oW3CRange.endOffset);return oFFRange}};nhn.BrowserSelectionImpl_IE=function(){this._oSelection=this._document.selection;this.oLastRange={oBrowserRange:null,elStartContainer:null,nStartOffset:-1,elEndContainer:null,nEndOffset:-1};this._updateLastRange=function(oBrowserRange,oW3CRange){this.oLastRange.oBrowserRange=oBrowserRange;this.oLastRange.elStartContainer=oW3CRange.startContainer;this.oLastRange.nStartOffset=oW3CRange.startOffset;this.oLastRange.elEndContainer=oW3CRange.endContainer;this.oLastRange.nEndOffset=oW3CRange.endOffset};this.getRangeAt=function(iNum){iNum=iNum||0;var oW3CRange,oBrowserRange,oSelectedNode;if(this._oSelection.type=="Control"){oW3CRange=new nhn.W3CDOMRange(this._window);oSelectedNode=this._oSelection.createRange().item(iNum);if(!oSelectedNode||oSelectedNode.ownerDocument!=this._document){return oW3CRange}oW3CRange.selectNode(oSelectedNode);return oW3CRange}else{oBrowserRange=this._oSelection.createRange();oSelectedNode=oBrowserRange.parentElement();if(!oSelectedNode||oSelectedNode.ownerDocument!=this._document){oW3CRange=new nhn.W3CDOMRange(this._window);return oW3CRange}oW3CRange=this._IERange2W3CRange(oBrowserRange);return oW3CRange}};this.addRange=function(oW3CRange){var oIERange=this._W3CRange2IERange(oW3CRange);oIERange.select()};this.selectNone=function(){this._oSelection.empty()};this.getCommonAncestorContainer=function(oW3CRange){return this._W3CRange2IERange(oW3CRange).parentElement()};this.isCollapsed=function(oW3CRange){var oRange=this._W3CRange2IERange(oW3CRange);var oRange2=oRange.duplicate();oRange2.collapse();return oRange.isEqual(oRange2)};this.compareEndPoints=function(elContainerA,nOffsetA,elContainerB,nOffsetB){var oIERangeA,oIERangeB;if(elContainerA===this.oLastRange.elStartContainer&&nOffsetA===this.oLastRange.nStartOffset){oIERangeA=this.oLastRange.oBrowserRange.duplicate();oIERangeA.collapse(true)}else{if(elContainerA===this.oLastRange.elEndContainer&&nOffsetA===this.oLastRange.nEndOffset){oIERangeA=this.oLastRange.oBrowserRange.duplicate();oIERangeA.collapse(false)}else{oIERangeA=this._getIERangeAt(elContainerA,nOffsetA)}}if(elContainerB===this.oLastRange.elStartContainer&&nOffsetB===this.oLastRange.nStartOffset){oIERangeB=this.oLastRange.oBrowserRange.duplicate();oIERangeB.collapse(true)}else{if(elContainerB===this.oLastRange.elEndContainer&&nOffsetB===this.oLastRange.nEndOffset){oIERangeB=this.oLastRange.oBrowserRange.duplicate();oIERangeB.collapse(false)}else{oIERangeB=this._getIERangeAt(elContainerB,nOffsetB)}}return oIERangeA.compareEndPoints("StartToStart",oIERangeB)};this._W3CRange2IERange=function(oW3CRange){if(this.oLastRange.elStartContainer===oW3CRange.startContainer&&this.oLastRange.nStartOffset===oW3CRange.startOffset&&this.oLastRange.elEndContainer===oW3CRange.endContainer&&this.oLastRange.nEndOffset===oW3CRange.endOffset){return this.oLastRange.oBrowserRange}var oStartIERange=this._getIERangeAt(oW3CRange.startContainer,oW3CRange.startOffset);var oEndIERange=this._getIERangeAt(oW3CRange.endContainer,oW3CRange.endOffset);oStartIERange.setEndPoint("EndToEnd",oEndIERange);this._updateLastRange(oStartIERange,oW3CRange);return oStartIERange};this._getIERangeAt=function(oW3CContainer,iW3COffset){var oIERange=this._document.body.createTextRange();var oEndPointInfoForIERange=this._getSelectableNodeAndOffsetForIE(oW3CContainer,iW3COffset);var oSelectableNode=oEndPointInfoForIERange.oSelectableNodeForIE;var iIEOffset=oEndPointInfoForIERange.iOffsetForIE;oIERange.moveToElementText(oSelectableNode);oIERange.collapse(oEndPointInfoForIERange.bCollapseToStart);oIERange.moveStart("character",iIEOffset);return oIERange};this._getSelectableNodeAndOffsetForIE=function(oW3CContainer,iW3COffset){var oNonTextNode=null;var aChildNodes=null;var iNumOfLeftNodesToCount=0;if(oW3CContainer.nodeType==3){oNonTextNode=nhn.DOMFix.parentNode(oW3CContainer);aChildNodes=nhn.DOMFix.childNodes(oNonTextNode);iNumOfLeftNodesToCount=aChildNodes.length}else{oNonTextNode=oW3CContainer;aChildNodes=nhn.DOMFix.childNodes(oNonTextNode);iNumOfLeftNodesToCount=iW3COffset<aChildNodes.length?iW3COffset:aChildNodes.length}var oNodeTester=null;var iResultOffset=0;var bCollapseToStart=true;for(var i=0;i<iNumOfLeftNodesToCount;i++){oNodeTester=aChildNodes[i];if(oNodeTester.nodeType==3){if(oNodeTester==oW3CContainer){break}iResultOffset+=oNodeTester.nodeValue.length}else{oNonTextNode=oNodeTester;iResultOffset=0;bCollapseToStart=false}}if(oW3CContainer.nodeType==3){iResultOffset+=iW3COffset}return{oSelectableNodeForIE:oNonTextNode,iOffsetForIE:iResultOffset,bCollapseToStart:bCollapseToStart}};this._IERange2W3CRange=function(oIERange){var oW3CRange=new nhn.W3CDOMRange(this._window);var oIEPointRange=null;var oPosition=null;oIEPointRange=oIERange.duplicate();oIEPointRange.collapse(true);oPosition=this._getW3CContainerAndOffset(oIEPointRange,true);oW3CRange.setStart(oPosition.oContainer,oPosition.iOffset,true,true);var oCollapsedChecker=oIERange.duplicate();oCollapsedChecker.collapse(true);if(oCollapsedChecker.isEqual(oIERange)){oW3CRange.collapse(true)}else{oIEPointRange=oIERange.duplicate();oIEPointRange.collapse(false);oPosition=this._getW3CContainerAndOffset(oIEPointRange);oW3CRange.setEnd(oPosition.oContainer,oPosition.iOffset,true)}this._updateLastRange(oIERange,oW3CRange);return oW3CRange};this._getW3CContainerAndOffset=function(oIEPointRange,bStartPt){var oRgOrigPoint=oIEPointRange;var oContainer=oRgOrigPoint.parentElement();var offset=-1;var oRgTester=this._document.body.createTextRange();var aChildNodes=nhn.DOMFix.childNodes(oContainer);var oPrevNonTextNode=null;var pointRangeIdx=0;for(var i=0;i<aChildNodes.length;i++){if(aChildNodes[i].nodeType==3){continue}oRgTester.moveToElementText(aChildNodes[i]);if(oRgTester.compareEndPoints("StartToStart",oIEPointRange)>=0){break}oPrevNonTextNode=aChildNodes[i]}pointRangeIdx=i;if(pointRangeIdx!==0&&aChildNodes[pointRangeIdx-1].nodeType==3){var oRgTextStart=this._document.body.createTextRange();var oCurTextNode=null;if(oPrevNonTextNode){oRgTextStart.moveToElementText(oPrevNonTextNode);oRgTextStart.collapse(false);oCurTextNode=oPrevNonTextNode.nextSibling}else{oRgTextStart.moveToElementText(oContainer);oRgTextStart.collapse(true);oCurTextNode=oContainer.firstChild}var oRgTextsUpToThePoint=oRgOrigPoint.duplicate();oRgTextsUpToThePoint.setEndPoint("StartToStart",oRgTextStart);var textCount=oRgTextsUpToThePoint.text.replace(/[\r\n]/g,"").length;while(textCount>oCurTextNode.nodeValue.length&&oCurTextNode.nextSibling){textCount-=oCurTextNode.nodeValue.length;oCurTextNode=oCurTextNode.nextSibling}oCurTextNode.nodeValue;if(bStartPt&&oCurTextNode.nextSibling&&oCurTextNode.nextSibling.nodeType==3&&textCount==oCurTextNode.nodeValue.length){textCount-=oCurTextNode.nodeValue.length;oCurTextNode=oCurTextNode.nextSibling}oContainer=oCurTextNode;offset=textCount}else{oContainer=oRgOrigPoint.parentElement();offset=pointRangeIdx}return{oContainer:oContainer,iOffset:offset}}};nhn.DOMFix=new(jindo.$Class({$init:function(){if(jindo.$Agent().navigator().ie||jindo.$Agent().navigator().opera){this.childNodes=this._childNodes_Fix;this.parentNode=this._parentNode_Fix}else{this.childNodes=this._childNodes_Native;this.parentNode=this._parentNode_Native}},_parentNode_Native:function(elNode){return elNode.parentNode},_parentNode_Fix:function(elNode){if(!elNode){return elNode}while(elNode.previousSibling){elNode=elNode.previousSibling}return elNode.parentNode},_childNodes_Native:function(elNode){return elNode.childNodes},_childNodes_Fix:function(elNode){var aResult=null;var nCount=0;if(elNode){aResult=[];elNode=elNode.firstChild;while(elNode){aResult[nCount++]=elNode;elNode=elNode.nextSibling}}return aResult}}))},"hp_CorePlugin.js":function(exports,module,require){nhn.husky.CorePlugin=jindo.$Class({name:"CorePlugin",$AFTER_MSG_APP_READY:function(){this.oApp.exec("EXEC_ON_READY_FUNCTION",[])},$ON_ADD_APP_PROPERTY:function(sPropertyName,oProperty){this.oApp[sPropertyName]=oProperty},$ON_REGISTER_BROWSER_EVENT:function(obj,sEvent,sMsg,aParams,nDelay){this.oApp.registerBrowserEvent(obj,sEvent,sMsg,aParams,nDelay)},$ON_DISABLE_MESSAGE:function(sMsg){this.oApp.disableMessage(sMsg,true)},$ON_ENABLE_MESSAGE:function(sMsg){this.oApp.disableMessage(sMsg,false)},$ON_EXEC_ON_READY_FUNCTION:function(){if(typeof this.oApp.htRunOptions.fnOnAppReady=="function"){this.oApp.htRunOptions.fnOnAppReady()}}})},"hp_HuskyRangeManager.js":function(exports,module,require){nhn.husky.HuskyRangeManager=jindo.$Class({name:"HuskyRangeManager",oWindow:null,$init:function(win){this.oWindow=win||window},$BEFORE_MSG_APP_READY:function(){if(this.oWindow&&this.oWindow.tagName=="IFRAME"){this.oWindow=this.oWindow.contentWindow;nhn.CurrentSelection.setWindow(this.oWindow)}this.oApp.exec("ADD_APP_PROPERTY",["getSelection",jindo.$Fn(this.getSelection,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["getEmptySelection",jindo.$Fn(this.getEmptySelection,this).bind()])},$ON_SET_EDITING_WINDOW:function(oWindow){this.oWindow=oWindow},getEmptySelection:function(oWindow){var oHuskyRange=new nhn.HuskyRange(oWindow||this.oWindow);return oHuskyRange},getSelection:function(oWindow){this.oApp.exec("RESTORE_IE_SELECTION",[]);var oHuskyRange=this.getEmptySelection(oWindow);try{oHuskyRange.setFromSelection()}catch(e){}return oHuskyRange}})}},hwp:{"doc.js":function(exports,module,require){var node=require("./node");var prototype=node.derive({load:function(runs,takeFocus){var self=this;this._paragraphs=[];this.layout()},layout:function(left,top,width,height){this.frame=null;try{this._left=left||0;this._top=top||0;this._width=width||0;this._paragraphs=[]}catch(x){console.error(x)}},children:function(){return this._paragraphs}});exports=module.exports=function(){var doc=Object.create(prototype);doc._left=0;doc._top=0;doc._width=0;doc._paragraphs=[];doc.load([]);return doc}},"frame.js":function(exports,module,require){var node=require("./node");var prototype=node.derive({children:function(){return this._paragraphs},draw:function(ctx,viewPort){this.children().forEach(function(child){child.draw(ctx,viewPort)})}});exports=module.exports=function(left,top,width,parent){var paragraphs=[];var frame=Object.create(prototype,{_paragraphs:{value:paragraphs},_parent:{value:parent}});return frame}},"hwp.js":function(exports,module,require){var docInfo=[];var faceNames=[];var borderFills=[];var charShapes=[];exports.load=function(stream){};exports.parse=function(body){var root=body}},"node.js":function(exports,module,require){var rect=require("./rect");var util=require("./util");exports.prototype={children:function(){return[]},parent:function(){return null},first:function(){return this.children()[0]},last:function(){return this.children()[this.children().length-1]},next:function(){var self=this;for(;;){var parent=self.parent();if(!parent){return null}var siblings=parent.children();var next=siblings[siblings.indexOf(self)+1];if(next){for(;;){var first=next.first();if(!first){break}next=first}return next}self=parent}},previous:function(){var parent=this.parent();if(!parent){return null}var siblings=parent.children();var prev=siblings[siblings.indexOf(this)-1];if(prev){return prev}var prevParent=parent.previous();return!prevParent?null:prevParent.last()},byOrdinal:function(index){var found=null;if(this.children().some(function(child){if(index>=child.ordinal&&index<child.ordinal+child.length){found=child.byOrdinal(index);if(found){return true}}})){return found}return this},byCoordinate:function(x,y){var found;this.children().some(function(child){var b=child.bounds();if(b.contains(x,y)){found=child.byCoordinate(x,y);if(found){return true}}});if(!found){found=this.last();while(found){var next=found.last();if(!next){break}found=next}var foundNext=found.next();if(foundNext&&foundNext.block){found=foundNext}}return found},draw:function(ctx,viewPort){this.children().forEach(function(child){child.draw(ctx,viewPort)})},parentOfType:function(type){var p=this.parent();return p&&(p.type===type?p:p.parentOfType(type))},bounds:function(){var l=this._left,t=this._top,r=0,b=0;this.children().forEach(function(child){var cb=child.bounds();l=Math.min(l,cb.l);t=Math.min(t,cb.t);r=Math.max(r,cb.l+cb.w);b=Math.max(b,cb.t+cb.h)});return rect(l,t,r-l,b-t)}};exports.derive=function(methods){return util.derive(exports.prototype,methods)};var generic=exports.derive({children:function(){return this._children},parent:function(){return this._parent},finalize:function(startDecrement,lengthIncrement){var start=Number.MAX_VALUE,end=0;this._children.forEach(function(child){start=Math.min(start,child.ordinal);end=Math.max(end,child.ordinal+child.length)});Object.defineProperty(this,"ordinal",{value:start-(startDecrement||0)});Object.defineProperty(this,"length",{value:(lengthIncrement||0)+end-start})}});exports.generic=function(type,parent,left,top){return Object.create(generic,{type:{value:type},_children:{value:[]},_parent:{value:parent},_left:{value:typeof left==="number"?left:Number.MAX_VALUE},_top:{value:typeof top==="number"?top:Number.MAX_VALUE}})}},"rect.js":function(exports,module,require){var prototype={contains:function(x,y){return x>=this.l&&x<this.l+this.w&&y>=this.t&&y<this.t+this.h},stroke:function(ctx){ctx.strokeRect(this.l,this.t,this.w,this.h)},fill:function(ctx){ctx.fillRect(this.l,this.t,this.w,this.h)},offset:function(x,y){return rect(this.l+x,this.t+y,this.w,this.h)},equals:function(other){return this.l===other.l&&this.t===other.t&&this.w===other.w&&this.h===other.h},center:function(){return{x:this.l+this.w/2,y:this.t+this.h/2}}};var rect=module.exports=function(l,t,w,h){return Object.create(prototype,{l:{value:l},t:{value:t},w:{value:w},h:{value:h},r:{value:l+w},b:{value:t+h}})}},"util.js":function(exports,module,require){exports.event=function(){var handlers=[];var subscribe=function(handler){handlers.push(handler)};subscribe.fire=function(){var args=Array.prototype.slice.call(arguments,0);handlers.forEach(function(handler){handler.apply(null,args)})};return subscribe};exports.derive=function(prototype,methods){var properties={};Object.keys(methods).forEach(function(name){properties[name]={value:methods[name]}});return Object.create(prototype,properties)}}},util:{"hp_SE2M_Utils.js":function(exports,module,require){if(typeof window.nhn=="undefined"){window.nhn={}}if(!nhn.husky){nhn.husky={}}(function(){var ua=navigator.userAgent,oAgent=jindo.$Agent(),browser=oAgent.navigator(),os=oAgent.os();var aMatch=ua.match(/(SHW-|Chrome|Safari)/gi)||"";if(aMatch.length===2&&aMatch[0]==="SHW-"&&aMatch[1]==="Safari"){browser.bGalaxyBrowser=true}else if(ua.indexOf("LG-V500")>-1&&ua.indexOf("Version/4.0")>-1){browser.bGPadBrowser=true}if(typeof os.ios==="undefined"){os.ios=ua.indexOf("iPad")>-1||ua.indexOf("iPhone")>-1;if(os.ios){aMatch=ua.match(/(iPhone )?OS ([\d|_]+)/);if(aMatch!=null&&aMatch[2]!=undefined){os.version=String(aMatch[2]).split("_").join(".")}}}})();nhn.husky.SE2M_UtilPlugin=jindo.$Class({name:"SE2M_UtilPlugin",$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["oAgent",jindo.$Agent()]);this.oApp.exec("ADD_APP_PROPERTY",["oNavigator",jindo.$Agent().navigator()]);this.oApp.exec("ADD_APP_PROPERTY",["oUtils",this])},$ON_REGISTER_HOTKEY:function(sHotkey,sCMD,aArgs,elTarget){this.oApp.exec("ADD_HOTKEY",[sHotkey,sCMD,aArgs,elTarget||this.oApp.getWYSIWYGDocument()])},$ON_SE2_ATTACH_HOVER_EVENTS:function(aElms){this.oApp.exec("ATTACH_HOVER_EVENTS",[aElms,{fnElmToSrc:this._elm2Src,fnElmToTarget:this._elm2Target}])},_elm2Src:function(el){if(el.tagName=="LI"&&el.firstChild&&el.firstChild.tagName=="BUTTON"){return el.firstChild}else{return el}},_elm2Target:function(el){if(el.tagName=="BUTTON"&&el.parentNode.tagName=="LI"){return el.parentNode}else{return el}},getScrollXY:function(){var scrollX,scrollY;var oAppWindow=this.oApp.getWYSIWYGWindow();if(typeof oAppWindow.scrollX=="undefined"){scrollX=oAppWindow.document.documentElement.scrollLeft;scrollY=oAppWindow.document.documentElement.scrollTop}else{scrollX=oAppWindow.scrollX;scrollY=oAppWindow.scrollY}return{x:scrollX,y:scrollY}}});nhn.husky.SE2M_Utils={sURLPattern:"(http|https|ftp|mailto):(?:\\/\\/)?((:?\\w|-)+(:?\\.(:?\\w|-)+)+)([^ <>]+)?",rxDateFormat:/^(?:\d{4}\.)?\d{1,2}\.\d{1,2}$/,_rxTable:/^(?:CAPTION|TBODY|THEAD|TFOOT|TR|TD|TH|COLGROUP|COL)$/i,_rxSpaceOnly:/^\s+$/,_rxFontStart:/<font(?:\s+[^>]*)?>/i,_rxFontStrip:/<\/?font(?:\s+[^>]*)?>/gi,_bUnderIE8:jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version<9,_htFontSize:{1:"7pt",2:"10pt",3:"12pt",4:"13.5pt",5:"18pt",6:"24pt",7:"36pt"},isInvalidNodeInTable:function(oNode){if(oNode&&!this._rxTable.test(oNode.nodeName)){var oTmpNode;if((oTmpNode=oNode.previousSibling)&&this._rxTable.test(oTmpNode.nodeName)){return true}if((oTmpNode=oNode.nextSibling)&&this._rxTable.test(oTmpNode.nodeName)){return true}}return false},removeInvalidNodeInTable:function(oNode){if(this.isInvalidNodeInTable(oNode)&&oNode.parentNode){oNode.parentNode.removeChild(oNode)}},removeInvalidFont:function(el){if(!el){return}this._removeInvalidFontInTable(el);this._removeEmptyFont(el)},_removeInvalidFontInTable:function(el){var aelFonts=jindo.$$("table font",el);for(var i=0,elFont;elFont=aelFonts[i];i++){this.removeInvalidNodeInTable(elFont)}},_removeEmptyFont:function(el){var aelFonts=jindo.$$("font",el);for(var i=0,elFont,sInner;elFont=aelFonts[i];i++){sInner=elFont.innerHTML||"";sInner=sInner.replace(this._rxSpaceOnly,"");if(!sInner){elFont.parentNode.removeChild(elFont)}}},convertFontToSpan:function(el){if(!el){return}var oDoc=el.ownerDocument||document;var aelTarget=jindo.$$("font",el);for(var i=0,elTarget,elSpan,sAttrValue;elTarget=aelTarget[i];i++){elSpan=elTarget.parentNode;if(elSpan.tagName!=="SPAN"||elSpan.childNodes.length>1){elSpan=oDoc.createElement("SPAN");elTarget.parentNode.insertBefore(elSpan,elTarget)}sAttrValue=elTarget.getAttribute("face");if(sAttrValue){elSpan.style.fontFamily=sAttrValue}sAttrValue=this._htFontSize[elTarget.getAttribute("size")];if(sAttrValue){elSpan.style.fontSize=sAttrValue}sAttrValue=elTarget.getAttribute("color");if(sAttrValue){elSpan.style.color=sAttrValue}this._switchFontInnerToSpan(elTarget,elSpan);if(elTarget.parentNode){elTarget.parentNode.removeChild(elTarget)}}if(i>0&&this._bUnderIE8){el.innerHTML=el.innerHTML.replace(this._rxFontStrip,"")}},_switchFontInnerToSpan:function(elFont,elSpan){var sInnerHTML=elFont.innerHTML;if(this._rxFontStart.test(sInnerHTML)||this._bUnderIE8){for(var elChild;elChild=elFont.firstChild;){elSpan.appendChild(elChild)}}else{elSpan.innerHTML=sInnerHTML}},stripTag:function(el){for(var elChild;elChild=el.firstChild;){el.parentNode.insertBefore(elChild,el)}el.parentNode.removeChild(el)},stripTags:function(el,sTagName){var aelTarget=jindo.$$(sTagName,el);for(var i=0,elTarget;elTarget=aelTarget[i];i++){this.stripTag(elTarget)}},reviseDateFormat:function(sDate){if(sDate&&sDate.replace){sDate=sDate.replace(this.rxDateFormat,"$&.")}return sDate},getCustomCSS:function(sStr,rxValue,sDivision){var ret=[];if("undefined"==typeof sStr||"undefined"==typeof rxValue||!sStr||!rxValue){return ret}var aMatch=sStr.match(rxValue);if(aMatch&&aMatch[0]&&aMatch[1]){if(sDivision){ret=aMatch[1].split(sDivision)}else{ret[0]=aMatch[1]}}return ret},toStringSamePropertiesOfArray:function(v,sKey,sSeperator){if(!v){return""}if(v instanceof Array){var a=[];for(var i=0;i<v.length;i++){a.push(v[i][sKey])}return a.join(",").replace(/,/g,sSeperator)}else{if(typeof v[sKey]=="undefined"){return""}if(typeof v[sKey]=="string"){return v[sKey]}}},makeArray:function(v){if(v===null||typeof v==="undefined"){return[]}if(v instanceof Array){return v}var a=[];a.push(v);return a},ellipsis:function(elText,elContainer,sStringTail,nLine){sStringTail=sStringTail||"...";if(typeof nLine=="undefined"){nLine=1}var welText=jindo.$Element(elText);var welContainer=jindo.$Element(elContainer);var sText=welText.html();var nLength=sText.length;var nCurrentHeight=welContainer.height();var nIndex=0;welText.html("A");var nHeight=welContainer.height();if(nCurrentHeight<nHeight*(nLine+.5)){return welText.html(sText)}nCurrentHeight=nHeight;while(nCurrentHeight<nHeight*(nLine+.5)){nIndex+=Math.max(Math.ceil((nLength-nIndex)/2),1);welText.html(sText.substring(0,nIndex)+sStringTail);nCurrentHeight=welContainer.height()}while(nCurrentHeight>nHeight*(nLine+.5)){nIndex--;welText.html(sText.substring(0,nIndex)+sStringTail);nCurrentHeight=welContainer.height()}},ellipsisByPixel:function(elText,sStringTail,nPixel,fCondition){sStringTail=sStringTail||"...";var welText=jindo.$Element(elText);var nCurrentWidth=welText.width();if(nCurrentWidth<nPixel){return}var sText=welText.html();var nLength=sText.length;var nIndex=0;if(typeof fCondition=="undefined"){var nWidth=welText.html("A").width();nCurrentWidth=nWidth;while(nCurrentWidth<nPixel){nIndex+=Math.max(Math.ceil((nLength-nIndex)/2),1);welText.html(sText.substring(0,nIndex)+sStringTail);nCurrentWidth=welText.width()}fCondition=function(){return true}}nIndex=welText.html().length-sStringTail.length;while(nCurrentWidth>nPixel){if(!fCondition()){break}nIndex--;welText.html(sText.substring(0,nIndex)+sStringTail);nCurrentWidth=welText.width()}},ellipsisElementsToDesinatedWidth:function(aElement,sStringTail,aMinWidth,fCondition){jindo.$A(aElement).forEach(function(el,i){if(!el){jindo.$A.Continue()}nhn.husky.SE2M_Utils.ellipsisByPixel(el,sStringTail,aMinWidth[i],fCondition)})},paddingZero:function(nNumber,nLength){var sResult=nNumber.toString();while(sResult.length<nLength){sResult="0"+sResult}return sResult},cutStringToByte:function(sString,nByte,sTail){if(sString===null||sString.length===0){return sString}sString=sString.replace(/  +/g," ");if(!sTail&&sTail!=""){sTail="..."}var maxByte=nByte;var n=0;var nLen=sString.length;for(var i=0;i<nLen;i++){n+=this.getCharByte(sString.charAt(i));if(n==maxByte){if(i==nLen-1){return sString}else{return sString.substring(0,i)+sTail}}else if(n>maxByte){return sString.substring(0,i)+sTail}}return sString},getCharByte:function(ch){if(ch===null||ch.length<1){return 0}var byteSize=0;var str=escape(ch);if(str.length==1){byteSize++}else if(str.indexOf("%u")!=-1){byteSize+=2}else if(str.indexOf("%")!=-1){byteSize+=str.length/3}return byteSize},getFilteredHashTable:function(htUnfiltered,vKey){if(!(vKey instanceof Array)){return arguments.callee.call(this,htUnfiltered,[vKey])}var waKey=jindo.$A(vKey);return jindo.$H(htUnfiltered).filter(function(vValue,sKey){if(waKey.has(sKey)&&vValue){return true}else{return false}}).$value()},isBlankNode:function(elNode){var isBlankTextNode=this.isBlankTextNode;var bEmptyContent=function(elNode){if(!elNode){return true}if(isBlankTextNode(elNode)){return true}if(elNode.tagName=="BR"){return true}if(elNode.innerHTML=="&nbsp;"||elNode.innerHTML==""){return true}return false};var bEmptyP=function(elNode){if(elNode.tagName=="IMG"||elNode.tagName=="IFRAME"){return false}if(bEmptyContent(elNode)){return true}if(elNode.tagName=="P"){for(var i=elNode.childNodes.length-1;i>=0;i--){var elTmp=elNode.childNodes[i];if(isBlankTextNode(elTmp)){elTmp.parentNode.removeChild(elTmp)}}if(elNode.childNodes.length==1){if(elNode.firstChild.tagName=="IMG"||elNode.firstChild.tagName=="IFRAME"){return false}if(bEmptyContent(elNode.firstChild)){return true}}}return false};if(bEmptyP(elNode)){return true}for(var i=0,nLen=elNode.childNodes.length;i<nLen;i++){var elTmp=elNode.childNodes[i];if(!bEmptyP(elTmp)){return false}}return true},isBlankTextNode:function(oNode){var sText;if(oNode.nodeType==3){sText=oNode.nodeValue;sText=sText.replace(unescape("%uFEFF"),"");if(sText==""){return true}}return false},isFirstChildOfNode:function(sTagName,sParentTagName,elNode){if(!elNode){return false}if(elNode.tagName==sParentTagName&&elNode.firstChild.tagName==sTagName){return true}return false},findAncestorByTagName:function(sTagName,elNode){while(elNode&&elNode.tagName!=sTagName){elNode=elNode.parentNode}return elNode},findAncestorByTagNameWithCount:function(sTagName,elNode){var nRecursiveCount=0;var htResult={};while(elNode&&elNode.tagName!=sTagName){elNode=elNode.parentNode;nRecursiveCount+=1}htResult={elNode:elNode,nRecursiveCount:nRecursiveCount};return htResult},findClosestAncestorAmongTagNames:function(aTagName,elNode){var rxTagNames=new RegExp("^("+aTagName.join("|")+")$","i");while(elNode&&!rxTagNames.test(elNode.tagName)){elNode=elNode.parentNode}return elNode},findClosestAncestorAmongTagNamesWithCount:function(aTagName,elNode){var nRecursiveCount=0;var htResult={};var rxTagNames=new RegExp("^("+aTagName.join("|")+")$","i");while(elNode&&!rxTagNames.test(elNode.tagName)){elNode=elNode.parentNode;nRecursiveCount+=1}htResult={elNode:elNode,nRecursiveCount:nRecursiveCount};return htResult},isNumber:function(n){return!isNaN(parseFloat(n))&&isFinite(n)},deleteProperty:function(oTarget,sProp){if(typeof oTarget!=="object"||typeof sProp!=="string"||typeof oTarget[sProp]==="undefined"){return}oTarget[sProp]=undefined;try{delete oTarget[sProp]}catch(e){}},loadCSS:function(url,fnCallback){var oDoc=document;var elHead=oDoc.getElementsByTagName("HEAD")[0];var elStyle=oDoc.createElement("LINK");elStyle.setAttribute("type","text/css");elStyle.setAttribute("rel","stylesheet");elStyle.setAttribute("href",url);if(fnCallback){if("onload"in elStyle){elStyle.onload=function(){fnCallback();this.onload=null}}else{elStyle.onreadystatechange=function(){if(elStyle.readyState!="complete"){return}if(elStyle.getAttribute("_complete")){return}elStyle.setAttribute("_complete",true);fnCallback()}}}elHead.appendChild(elStyle)},getUniqueId:function(sPrefix){return(sPrefix||"")+jindo.$Date().time()+(Math.random()*1e5).toFixed()},clone:function(oSrc,oChange){if("undefined"!=typeof oSrc&&!!oSrc&&(oSrc.constructor==Array||oSrc.constructor==Object)){var oCopy=oSrc.constructor==Array?[]:{};for(var property in oSrc){if("undefined"!=typeof oChange&&!!oChange[property]){oCopy[property]=arguments.callee(oChange[property])}else{oCopy[property]=arguments.callee(oSrc[property])}}return oCopy}return oSrc},getHtmlTagAttr:function(sHtmlTag,sAttr){var rx=new RegExp("\\s"+sAttr+"=('([^']*)'|\"([^\"]*)\"|([^\"' >]*))","i");var aResult=rx.exec(sHtmlTag);if(!aResult){return""}var sAttrTmp=aResult[1]||aResult[2]||aResult[3];if(sAttrTmp){sAttrTmp=sAttrTmp.replace(/["]/g,"")}return sAttrTmp},iframeAlignConverter:function(el,oDoc){var sTagName=el.tagName.toUpperCase();if(sTagName=="DIV"||sTagName=="P"){if(el.parentNode===null){return}var elWYSIWYGDoc=oDoc;var wel=jindo.$Element(el);var sHtml=wel.html();var sAlign=jindo.$Element(el).attr("align")||jindo.$Element(el).css("text-align");var welAfter=jindo.$Element(jindo.$("<div></div>",elWYSIWYGDoc));welAfter.html(sHtml).attr("align",sAlign);wel.replace(welAfter)}},getJsonDatafromXML:function(sXML){var o={};var re=/\s*<(\/?[\w:-]+)((?:\s+[\w:-]+\s*=\s*(?:"(?:\\"|[^"])*"|'(?:\\'|[^'])*'))*)\s*((?:\/>)|(?:><\/\1>|\s*))|\s*<!\[CDATA\[([\w\W]*?)\]\]>\s*|\s*>?([^<]*)/gi;var re2=/^[0-9]+(?:\.[0-9]+)?$/;var re3=/^\s+$/g;var ec={"&amp;":"&","&nbsp;":" ","&quot;":'"',"&lt;":"<","&gt;":">"};var fg={tags:["/"],stack:[o]};var es=function(s){if(typeof s=="undefined"){return""}return s.replace(/&[a-z]+;/g,function(m){return typeof ec[m]=="string"?ec[m]:m})};var at=function(s,c){s.replace(/([\w:-]+)\s*=\s*(?:"((?:\\"|[^"])*)"|'((?:\\'|[^'])*)')/g,function($0,$1,$2,$3){c[$1]=es(($2?$2.replace(/\\"/g,'"'):undefined)||($3?$3.replace(/\\'/g,"'"):undefined))})};var em=function(o){for(var x in o){if(Object.prototype.hasOwnProperty.call(o,x)){if(Object.prototype[x]){continue}return false}}return true};var cb=function($0,$1,$2,$3,$4,$5){var cur,cdata="";var idx=fg.stack.length-1;if(typeof $1=="string"&&$1){if($1.substr(0,1)!="/"){var has_attr=typeof $2=="string"&&$2;var closed=typeof $3=="string"&&$3;var newobj=!has_attr&&closed?"":{};cur=fg.stack[idx];if(typeof cur[$1]=="undefined"){cur[$1]=newobj;cur=fg.stack[idx+1]=cur[$1]}else if(cur[$1]instanceof Array){var len=cur[$1].length;cur[$1][len]=newobj;cur=fg.stack[idx+1]=cur[$1][len]}else{cur[$1]=[cur[$1],newobj];cur=fg.stack[idx+1]=cur[$1][1]}if(has_attr){at($2,cur)}fg.tags[idx+1]=$1;if(closed){fg.tags.length--;fg.stack.length--}}else{fg.tags.length--;fg.stack.length--}}else if(typeof $4=="string"&&$4){cdata=$4}else if(typeof $5=="string"&&$5.replace(re3,"")){cdata=es($5)}if(cdata.length>0){var par=fg.stack[idx-1];var tag=fg.tags[idx];if(re2.test(cdata)){}else if(cdata=="true"||cdata=="false"){cdata=new Boolean(cdata)}if(typeof par=="undefined"){return}if(par[tag]instanceof Array){var o=par[tag];if(typeof o[o.length-1]=="object"&&!em(o[o.length-1])){o[o.length-1].$cdata=cdata;o[o.length-1].toString=function(){return cdata}}else{o[o.length-1]=cdata}}else{if(typeof par[tag]=="object"&&!em(par[tag])){par[tag].$cdata=cdata;par[tag].toString=function(){return cdata}}else{par[tag]=cdata}}}};sXML=sXML.replace(/<(\?|!-)[^>]*>/g,"");sXML.replace(re,cb);return jindo.$Json(o)},replaceSpecialChar:function(sString){return typeof sString=="string"?sString.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},restoreSpecialChar:function(sString){return typeof sString=="string"?sString.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"):""}};nhn.husky.AutoResizer=jindo.$Class({welHiddenDiv:null,welCloneDiv:null,elContainer:null,$init:function(el,htOption){var aCopyStyle=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"],i=aCopyStyle.length,oCss={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",wordWrap:"break-word"};this.nMinHeight=htOption.nMinHeight;this.wfnCallback=htOption.wfnCallback;this.elContainer=el.parentNode;this.welTextArea=jindo.$Element(el);this.welHiddenDiv=jindo.$Element("<div>");this.wfnResize=jindo.$Fn(this._resize,this);this.sOverflow=this.welTextArea.css("overflow");this.welTextArea.css("overflow","hidden");while(i--){oCss[aCopyStyle[i]]=this.welTextArea.css(aCopyStyle[i])}this.welHiddenDiv.css(oCss);this.nLastHeight=this.welTextArea.height()},bind:function(){this.welCloneDiv=jindo.$Element(this.welHiddenDiv.$value().cloneNode(false));this.wfnResize.attach(this.welTextArea,"keyup");this.welCloneDiv.appendTo(this.elContainer);this._resize()},unbind:function(){this.wfnResize.detach(this.welTextArea,"keyup");this.welTextArea.css("overflow",this.sOverflow);if(this.welCloneDiv){this.welCloneDiv.leave()}},_resize:function(){var sContents=this.welTextArea.$value().value,bExpand=false,nHeight;if(sContents===this.sContents){return}this.sContents=sContents.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br>");this.sContents+="<br>";this.welCloneDiv.html(this.sContents);nHeight=this.welCloneDiv.height();if(nHeight<this.nMinHeight){nHeight=this.nMinHeight}this.welTextArea.css("height",nHeight+"px");this.elContainer.style.height=nHeight+"px";if(this.nLastHeight<nHeight){bExpand=true}this.wfnCallback(bExpand)}});if(typeof window.StringBuffer=="undefined"){window.StringBuffer={}}StringBuffer=function(str){this._aString=[];if("undefined"!=typeof str){this.append(str)}};StringBuffer.prototype.append=function(str){this._aString.push(str);return this};StringBuffer.prototype.toString=function(){return this._aString.join("")};StringBuffer.prototype.setLength=function(nLen){if("undefined"==typeof nLen||0>=nLen){this._aString.length=0}else{this._aString.length=nLen}};(function(){var oDummy=null,rx=/,/gi;window.IsInstalledFont=function(sFont){var sDefFont=sFont=="Comic Sans MS"?"Courier New":"Comic Sans MS";if(!oDummy){oDummy=document.createElement("div")}var sStyle="position:absolute !important; font-size:200px !important; left:-9999px !important; top:-9999px !important;";oDummy.innerHTML="mmmmiiiii"+unescape("%uD55C%uAE00");oDummy.style.cssText=sStyle+'font-family:"'+sDefFont+'" !important';var elBody=document.body||document.documentElement;if(elBody.firstChild){elBody.insertBefore(oDummy,elBody.firstChild)}else{document.body.appendChild(oDummy)}var sOrg=oDummy.offsetWidth+"-"+oDummy.offsetHeight;oDummy.style.cssText=sStyle+'font-family:"'+sFont.replace(rx,'","')+'", "'+sDefFont+'" !important';var bInstalled=sOrg!=oDummy.offsetWidth+"-"+oDummy.offsetHeight;document.body.removeChild(oDummy);return bInstalled}})()},"hp_StringConverterManager.js":function(exports,module,require){nhn.husky.StringConverterManager=jindo.$Class({name:"StringConverterManager",oConverters:null,$init:function(){this.oConverters={};this.oConverters_DOM={};this.oAgent=jindo.$Agent().navigator()},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["applyConverter",jindo.$Fn(this.applyConverter,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["addConverter",jindo.$Fn(this.addConverter,this).bind()]);this.oApp.exec("ADD_APP_PROPERTY",["addConverter_DOM",jindo.$Fn(this.addConverter_DOM,this).bind()])},applyConverter:function(sRuleName,sContents,oDocument){var sTmpStr="@"+(new Date).getTime()+"@";var rxTmpStr=new RegExp(sTmpStr,"g");var oRes={sContents:sTmpStr+sContents};oDocument=oDocument||document;this.oApp.exec("MSG_STRING_CONVERTER_STARTED",[sRuleName,oRes]);var aConverters;sContents=oRes.sContents;aConverters=this.oConverters_DOM[sRuleName];if(aConverters){var elContentsHolder=oDocument.createElement("div");elContentsHolder.innerHTML=sContents;for(var i=0;i<aConverters.length;i++){aConverters[i](elContentsHolder)}sContents=elContentsHolder.innerHTML;if(elContentsHolder.parentNode){elContentsHolder.parentNode.removeChild(elContentsHolder)}elContentsHolder=null;if(jindo.$Agent().navigator().ie){sTmpStr=sTmpStr+"(\r\n)?";rxTmpStr=new RegExp(sTmpStr,"g")}}aConverters=this.oConverters[sRuleName];if(aConverters){for(i=0;i<aConverters.length;i++){var sTmpContents=aConverters[i](sContents);if(typeof sTmpContents!="undefined"){sContents=sTmpContents}}}oRes={sContents:sContents};this.oApp.exec("MSG_STRING_CONVERTER_ENDED",[sRuleName,oRes]);oRes.sContents=oRes.sContents.replace(rxTmpStr,"");return oRes.sContents},$ON_ADD_CONVERTER:function(sRuleName,funcConverter){var aCallerStack=this.oApp.aCallerStack;funcConverter.sPluginName=aCallerStack[aCallerStack.length-2].name;this.addConverter(sRuleName,funcConverter)},$ON_ADD_CONVERTER_DOM:function(sRuleName,funcConverter){var aCallerStack=this.oApp.aCallerStack;funcConverter.sPluginName=aCallerStack[aCallerStack.length-2].name;this.addConverter_DOM(sRuleName,funcConverter)},addConverter:function(sRuleName,funcConverter){var aConverters=this.oConverters[sRuleName];if(!aConverters){this.oConverters[sRuleName]=[]}this.oConverters[sRuleName][this.oConverters[sRuleName].length]=funcConverter},addConverter_DOM:function(sRuleName,funcConverter){var aConverters=this.oConverters_DOM[sRuleName];if(!aConverters){this.oConverters_DOM[sRuleName]=[]}this.oConverters_DOM[sRuleName][this.oConverters_DOM[sRuleName].length]=funcConverter}})},"hp_Utils.js":function(exports,module,require){nhn.husky.Utils=jindo.$Class({name:"Utils",$init:function(){var oAgentInfo=jindo.$Agent();var oNavigatorInfo=oAgentInfo.navigator();if(oNavigatorInfo.ie&&oNavigatorInfo.version==6){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}},$BEFORE_MSG_APP_READY:function(){this.oApp.exec("ADD_APP_PROPERTY",["htBrowser",jindo.$Agent().navigator()])},$ON_ATTACH_HOVER_EVENTS:function(aElms,htOptions){htOptions=htOptions||[];var sHoverClass=htOptions.sHoverClass||"hover";var fnElmToSrc=htOptions.fnElmToSrc||function(el){return el};var fnElmToTarget=htOptions.fnElmToTarget||function(el){return el};if(!aElms)return;var wfAddClass=jindo.$Fn(function(wev){jindo.$Element(fnElmToTarget(wev.currentElement)).addClass(sHoverClass)},this);var wfRemoveClass=jindo.$Fn(function(wev){jindo.$Element(fnElmToTarget(wev.currentElement)).removeClass(sHoverClass)},this);for(var i=0,len=aElms.length;i<len;i++){var elSource=fnElmToSrc(aElms[i]);wfAddClass.attach(elSource,"mouseover");wfRemoveClass.attach(elSource,"mouseout");wfAddClass.attach(elSource,"focus");wfRemoveClass.attach(elSource,"blur")}}})}}}}}})("webhwp/workspace/src/bundle/index");